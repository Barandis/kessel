/*!
 * Copyright (c) 2020 Thomas Otterson
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * 
 */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.kessel=n():t.kessel=n()}(this,(function(){return function(t){var n={};function r(e){if(n[e])return n[e].exports;var u=n[e]={i:e,l:!1,exports:{}};return t[e].call(u.exports,u,u.exports,r),u.l=!0,u.exports}return r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var u in t)r.d(e,u,function(n){return t[n]}.bind(null,u));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=0)}([function(t,n,r){"use strict";r.r(n),r.d(n,"alpha",(function(){return vn})),r.d(n,"any",(function(){return fn})),r.d(n,"char",(function(){return on})),r.d(n,"digit",(function(){return bn})),r.d(n,"eof",(function(){return dn})),r.d(n,"hex",(function(){return yn})),r.d(n,"ichar",(function(){return an})),r.d(n,"letter",(function(){return gn})),r.d(n,"lower",(function(){return mn})),r.d(n,"noneof",(function(){return hn})),r.d(n,"octal",(function(){return xn})),r.d(n,"oneof",(function(){return pn})),r.d(n,"range",(function(){return ln})),r.d(n,"satisfy",(function(){return cn})),r.d(n,"upper",(function(){return wn})),r.d(n,"always",(function(){return En})),r.d(n,"fail",(function(){return $n})),r.d(n,"fatal",(function(){return kn})),r.d(n,"newline",(function(){return Hn})),r.d(n,"regex",(function(){return Rn})),r.d(n,"space",(function(){return Vn})),r.d(n,"spaces",(function(){return Zn})),r.d(n,"spaces1",(function(){return Bn})),r.d(n,"ualpha",(function(){return Gn})),r.d(n,"uletter",(function(){return zn})),r.d(n,"ulower",(function(){return Dn})),r.d(n,"unewline",(function(){return Kn})),r.d(n,"uspace",(function(){return Wn})),r.d(n,"uspaces",(function(){return Xn})),r.d(n,"uspaces1",(function(){return Jn})),r.d(n,"uupper",(function(){return qn})),r.d(n,"all",(function(){return rr})),r.d(n,"anystr",(function(){return er})),r.d(n,"istr",(function(){return nr})),r.d(n,"str",(function(){return tr})),r.d(n,"alt",(function(){return ir})),r.d(n,"def",(function(){return cr})),r.d(n,"empty",(function(){return fr})),r.d(n,"not",(function(){return dr})),r.d(n,"opt",(function(){return ar})),r.d(n,"peek",(function(){return lr})),r.d(n,"attempt",(function(){return yr})),r.d(n,"bapply",(function(){return vr})),r.d(n,"bbetween",(function(){return Or})),r.d(n,"bblock",(function(){return Er})),r.d(n,"bchain",(function(){return gr})),r.d(n,"bcount",(function(){return $r})),r.d(n,"bleft",(function(){return wr})),r.d(n,"bpipe",(function(){return Ar})),r.d(n,"bright",(function(){return mr})),r.d(n,"bseq",(function(){return xr})),r.d(n,"buntil",(function(){return kr})),r.d(n,"apply",(function(){return zr})),r.d(n,"chain",(function(){return Gr})),r.d(n,"compact",(function(){return Fr})),r.d(n,"fifth",(function(){return Ir})),r.d(n,"first",(function(){return Nr})),r.d(n,"flat",(function(){return Mr})),r.d(n,"fourth",(function(){return Pr})),r.d(n,"join",(function(){return Lr})),r.d(n,"map",(function(){return Rr})),r.d(n,"nth",(function(){return _r})),r.d(n,"second",(function(){return Tr})),r.d(n,"third",(function(){return Cr})),r.d(n,"value",(function(){return Sr})),r.d(n,"between",(function(){return ue})),r.d(n,"block",(function(){return Jr})),r.d(n,"count",(function(){return ee})),r.d(n,"endby",(function(){return ne})),r.d(n,"endby1",(function(){return re})),r.d(n,"lassoc",(function(){return ae})),r.d(n,"lassoc1",(function(){return ce})),r.d(n,"left",(function(){return Xr})),r.d(n,"many",(function(){return Hr})),r.d(n,"many1",(function(){return Kr})),r.d(n,"pipe",(function(){return oe})),r.d(n,"rassoc",(function(){return le})),r.d(n,"rassoc1",(function(){return fe})),r.d(n,"right",(function(){return Br})),r.d(n,"sepby",(function(){return Yr})),r.d(n,"sepby1",(function(){return te})),r.d(n,"seq",(function(){return Zr})),r.d(n,"skip",(function(){return Qr})),r.d(n,"until",(function(){return se})),r.d(n,"Status",(function(){return D})),r.d(n,"failReply",(function(){return X})),r.d(n,"failure",(function(){return Y})),r.d(n,"fatalReply",(function(){return B})),r.d(n,"okReply",(function(){return Z})),r.d(n,"parse",(function(){return J})),r.d(n,"parser",(function(){return W})),r.d(n,"run",(function(){return tt})),r.d(n,"status",(function(){return H})),r.d(n,"succeeded",(function(){return K})),r.d(n,"success",(function(){return Q})),r.d(n,"ErrorType",(function(){return O})),r.d(n,"compound",(function(){return S})),r.d(n,"expected",(function(){return U})),r.d(n,"formatErrors",(function(){return G})),r.d(n,"generic",(function(){return L})),r.d(n,"getPosition",(function(){return q})),r.d(n,"merge",(function(){return _})),r.d(n,"nested",(function(){return F})),r.d(n,"other",(function(){return M})),r.d(n,"unexpected",(function(){return j}));const e=new TextEncoder,u=new TextDecoder;function*s(t,n,r,e){const u="number"==typeof n?t:0,s="number"==typeof n?n:t,o="number"==typeof r?0===r?1:Math.abs(r):1,i="number"==typeof r?!!e:"number"==typeof n?!!r:!!n,a=u<s;let c=u;for(;!(a?i?c>s:c>=s:i?c<s:c<=s);)yield c,c=a?c+o:c-o}function o(t,n,r){const e=Uint8Array.from({length:n},(n,e)=>r.getUint8(t+e));return u.decode(e)}function i(t){return new DataView(e.encode(t).buffer)}function a(t){return[...t].length}function c(t,n){const r=n.getUint8(t);return(128&r)>>7==0?1:(224&r)>>5==6?2:(240&r)>>4==14?3:(240&r)>>4==15?4:1}function l(t,n){const r=c(t,n);return{width:r,next:o(t,r,n)}}function f(t){return`'${t}'`}function d(t){return[t,t]}function p(t){switch(t.length){case 0:return"";case 1:return t[0];case 2:return t.join(" or ");default:{const n=t.slice(),r=n.pop();return`${n.join(", ")}, or ${r}`}}}const h=["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],b=["zeroth","first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth","eleventh","twelfth","thirteenth","fourteenth","fifteenth","sixteenth","seventeenth","eighteenth","nineteenth"],y=["twent","thirt","fort","fift","sixt","sevent","eight","ninet"],x=["hundred","thousand","million","billion","trillion","quadrillion"];function g(t){if(t<0||t>Number.MAX_SAFE_INTEGER)throw new Error("Argument must be between 0 and "+Number.MAX_SAFE_INTEGER);const n=Math.floor(Math.log10(t));if(t<20)return b[t];if(1===n){const n=Math.floor(t/10)-2;return t%10==0?y[n]+"ieth":`${y[n]}y-${b[t%10]}`}if(2===n){const r=Math.floor(t/10**n),e=t-r*10**n;return`${h[r]} ${x[0]}${0===e?"th":" "+g(e)}`}const r=n%3+1,e=Math.floor(n/3),u=Math.floor(t/10**(n-r+1)),s=function t(n){if(n<20)return h[n];const r=n%10;if(n<100)return`${y[Math.floor(n/10)-2]}y${0===r?"":"-"+h[r]}`;const e=n-100*Math.floor(n/100);return`${h[Math.floor(n/100)]} ${x[0]}${0===e?"th":" "+t(e)}`}(u),o=t-u*10**(n-r+1);return`${s} ${x[e]}${0===o?"th":" "+g(o)}`}function v(t){return void 0===t?"undefined":"function"==typeof t?W.created(t)?"parser":"function":"symbol"==typeof t?`Symbol(${t.description})`:JSON.stringify(t)}function w(t){return t?B:X}function m(t,n){return null==t?n:U(t)}function $(t,n,r){return null==t?F(n,r):S(t,n,r)}function k(t,n,r,e){return t?$(n,r,e):m(n,e)}const E=/\t/gu,A=/(?:\p{Mn}|\p{Cf})/gu,O={Expected:"expected",Unexpected:"unexpected",Generic:"generic",Nested:"nested",Compound:"compound",Other:"other"};function U(t){return[{type:O.Expected,label:t}]}function j(t){return[{type:O.Unexpected,label:t}]}function L(t){return[{type:O.Generic,label:t}]}function M(t){return[{type:O.Other,label:t}]}function F(t,n){return 1===n.length&&n[0].type===O.Nested?n:[{type:O.Nested,ctx:t,errors:n}]}function S(t,n,r){return 1===r.length&&r[0].type===O.Nested?[{type:O.Compound,ctx:r.ctx,errors:r.errors,label:t}]:[{type:O.Compound,ctx:n,errors:r,label:t}]}function _(t=[],n=[]){return[...t,...n]}function N(t,n){const r=n.getUint8(t);if(10===r||11===r||12===r)return{newline:!0,skip:1};if(13===r){if(t<n.byteLength-1){const e=n.getUint8(t+1);if(13===r&&10===e)return{newline:!0,skip:2}}return{newline:!0,skip:1}}if(t<n.byteLength-1){const e=n.getUint8(t+1);if(194===r&&133===e)return{newline:!0,skip:2};if(t<n.byteLength-2){const u=n.getUint8(t+2);if(226===r&&128===e&&(168===u||169===u))return{newline:!0,skip:3}}}return{newline:!1,skip:c(t,n)}}function T(t,n){let r=0,e=1,u=0;for(;u<n.byteLength;){const{newline:s,skip:o}=N(u,n);if(s){if(u+o>t)return{start:r,end:u-1,lineno:e};e++,r=u+o}u+=o}return{start:r,end:n.byteLength-1,lineno:e}}function C(t,n,r){let e=0,u=r;for(;u<t&&u<n.byteLength;)u+=c(u,n),e++;return e}function P(t,n,r){const e=[];let u=E.exec(n);for(;null!==u;)e.push(u.index),u=E.exec(n);let s=0,o=0,i=n;for(const n of e){const e=n+s,u=r-e%r;e<t+o&&(o+=u-1),s+=u-1,i=i.substring(0,e)+" ".repeat(u)+i.substring(e+1)}return{line:i,colIndex:o+t}}function I(t,n){let r=t;const e=[];let u=A.exec(n);for(;null!==u;)e.push(u.index),u.index<r&&r--,u=A.exec(n);return{colno:r+1,length:a(n)-e.length}}function R(t,n,r,e){const u=" ".repeat(e);return t.map(t=>{const{index:s,view:o}=t.ctx;return(t.label?`\n${u}Could not parse ${t.label} because:\n\n`:`\n${u}The parser backtracked after:\n\n`)+z(t.errors,s,o,n,r,e+2)}).join("")}function z(t,n,r,e=8,u=72,s=0){const{start:i,end:a,lineno:c}=T(n,r),l=C(n,r,i),f=" ".repeat(s),d=o(i,a-i+1,r),{colIndex:h,line:b}=P(l,d,e),{colno:y,length:x}=I(h,b),g=`${f}Parse error at (line ${c}, column ${y}):`,v=function(t,n,r,e,u=0){const s=" ".repeat(u);if(r<=e&&n<=e)return`${s}${t}\n${s}${" ".repeat(r-1)}^`;if(r<=e-3)return`${s}${t.substring(0,e-3)}...\n${s}${" ".repeat(r-1)}^`;if(r>=n-e+3){const u=n-e+3,o=r-(n-e);return`${s}...${t.substring(u)}\n${s}${" ".repeat(o-1)}^`}const o=r-1-Math.ceil(e/2)+3,i=r-1+Math.floor(e/2)-3;return`${s}...${t.substring(o,i)}...\n${s}${" ".repeat(Math.ceil(e/2))}^`}(b,x,y,u,s),w=t.find(t=>t.type===O.Generic),m=t.find(t=>t.type===O.Unexpected),$=p(t.filter(t=>t.type===O.Expected).map(t=>t.label)),k=t.filter(t=>t.type===O.Nested),E=t.filter(t=>t.type===O.Compound),A=m?`${f}Unexpected ${m.label}\n`:"",U=$.length?`${f}Expected ${$}\n`:"",j=w?`${f}${w.label}\n`:"",L=R(k,e,u,s),M=R(E,e,u,s);return function(t,n){let r=t;for(;"\n"===r[r.length-1];)r=r.substring(0,r.length-1);return r+"\n".repeat(n)}(`${g}\n\n${v}\n${A}${U}${j}${0===t.length?f+"Unknown error(s)\n":""}${n>=r.byteLength?f+"Note: failure occurred at the end of input\n":""}${M}${L}`,2)}function G(t,n,r,e=z){const[u,s]=t,{index:o,view:i}=u;return e(s.errors,o,i,n,r)}function q(t,n=8){const{index:r,view:e}=t,{start:u,end:s,lineno:i}=T(r,e),a=C(r,e,u),c=o(u,s-u+1,e),{colIndex:l,line:f}=P(a,c,n),{colno:d,_:p}=I(l,f);return{line:i,column:d}}const D={Ok:"ok",Fail:"fail",Fatal:"fatal"};function V(t){const n="Parser input must be a string, a typed array, an array buffer, or a data view; parser input was "+typeof t;return{view:(t=>{if("string"==typeof t)return i(t);if((r=t)instanceof Uint8Array||r instanceof Uint8ClampedArray||r instanceof Uint16Array||r instanceof Uint32Array||r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array||r instanceof Float32Array||r instanceof Float64Array)return new DataView(t.buffer);var r;if(t instanceof ArrayBuffer)return new DataView(t);if(t instanceof DataView)return t;throw new Error(n)})(t),index:0}}const W=function(t,n="created"){const r=new WeakSet;return Object.defineProperty((...n)=>{const e=t(...n);return r.add(e),e},n,{value:r.has.bind(r)})}(t=>t);function Z(t,n=null,r=t.index){return[{...t,index:r},{status:D.Ok,value:n}]}function X(t,n=[],r=t.index){return[{...t,index:r},{status:D.Fail,errors:n}]}function B(t,n=[],r=t.index){return[{...t,index:r},{status:D.Fatal,errors:n}]}function J(t,n){return t(V(n))}function H(t){return t[1].status}function K(t){return t[1].status===D.Ok}function Q(t){return K(t)?t[1].value:null}function Y(t){return K(t)?null:G(t)}function tt(t,n){const[r,[e,u]]=d(t(V(n)));if(u.status===D.Ok)return u.value;throw new Error(G(r))}const nt=t=>n=>`expected ${t}; found ${v(n)}`,rt=nt("a one-character string"),et=nt("a function"),ut=nt("a generator function"),st=nt("a string"),ot=nt("an array"),it=nt("a string or an array of characters"),at=nt("a string or a regular expression"),ct=nt("a number"),lt=nt("a parser"),ft=(t,n=1,r=!1)=>e=>`expected ${r?g(n)+" ":""}argument to be ${t}; found ${v(e)}`,dt=(t=1,n=!1)=>ft("a one-character string",t,n),pt=(t=1,n=!1)=>ft("a function",t,n),ht=(t=1,n=!1)=>ft("a generator function",t,n),bt=(t=1,n=!1)=>ft("a number",t,n),yt=(t=1,n=!1)=>ft("a parser",t,n),xt=(t=1,n=!1)=>ft("a string",t,n),gt=(t=1,n=!1)=>ft("a string or an array of characters",t,n);function vt(t,n,r){throw new Error(`[${t}]: ${r(n)}`)}function wt(t,n,r=rt){"string"==typeof n&&1===a(n)||vt(t,n,r)}function mt(t,n,r=et){("function"!=typeof n||W.created(n))&&vt(t,n,r)}function $t(t,n,r=ut){"[object GeneratorFunction]"!==Object.prototype.toString.call(n)&&vt(t,n,r)}function kt(t,n,r=st){"string"!=typeof n&&vt(t,n,r)}function Et(t,n,r=ot){Array.isArray(n)||vt(t,n,r)}function At(t,n,r=it){Array.isArray(n)&&n.every(t=>"string"==typeof t&&1===a(t))||"string"==typeof n||vt(t,n,r)}function Ot(t,n,r=ct){"number"!=typeof n&&vt(t,n,r)}function Ut(t,n,r=lt){"function"==typeof n&&W.created(n)||vt(t,n,r)}const jt="any character",Lt=t=>`a string of ${t} characters`,Mt=t=>f(t),Ft="a digit",St="end of input",_t="a hexadecimal digit",Nt=t=>f(t),Tt=t=>f(t),Ct="a letter",Pt="a lowercase letter",It="a newline",Rt=t=>"none of "+p(t.map(t=>`'${t}'`)),zt="an octal digit",Gt=t=>"one of "+p(t.map(t=>`'${t}'`)),qt=(t,n)=>`a character between '${t}' and '${n}'`,Dt=t=>"a string matching "+t,Vt="a whitespace character",Wt="zero or more whitespace characters",Zt="one or more whitespace characters",Xt=t=>f(t),Bt="a Unicode alphanumeric character",Jt="a Unicode letter",Ht="a Unicode lowercase letter",Kt="a Unicode newline",Qt="an uppercase letter",Yt="a Unicode whitespace character",tn="zero or more Unicode whitespace characters",nn="one or more Unicode whitespace characters",rn="a Unicode uppercase letter",en={alpha:U("an alphanumeric character"),any:U(jt),anystr:t=>U(Lt(t)),char:t=>U(Mt(t)),digit:U(Ft),eof:U(St),hex:U(_t),ichar:t=>U(Nt(t)),istr:t=>U(Tt(t)),letter:U(Ct),lower:U(Pt),newline:U(It),noneof:t=>U(Rt(t)),octal:U(zt),oneof:t=>U(Gt(t)),range:(t,n)=>U(qt(t,n)),regex:t=>U(Dt(t)),space:U(Vt),spaces:U(Wt),spaces1:U(Zt),str:t=>U(Xt(t)),ualpha:U(Bt),uletter:U(Jt),ulower:U(Ht),unewline:U(Kt),upper:U(Qt),uspace:U(Yt),uspaces:U(tn),uspaces1:U(nn),uupper:U(rn)},{Ok:un}=D,sn=t=>W(n=>{const{index:r,view:e}=n;if(r>=e.byteLength)return X(n);const{width:u,next:s}=l(r,e);return t(s)?Z(n,s,r+u):X(n)}),on=(t,n)=>W(r=>{const e=null!=n;wt("char",t,dt(1,e)),e&&kt("char",n,xt(2,!0));const[u,[s,o]]=d(sn(n=>t===n)(r));return o.status===un?u:X(s,m(n,en.char(t)))}),an=(t,n)=>W(r=>{const e=null!=n;wt("ichar",t,dt(1,e)),e&&kt("ichar",n,xt(2,!0));const[u,[s,o]]=d(sn(n=>t.toLowerCase()===n.toLowerCase())(r));return o.status===un?u:X(s,m(n,en.ichar(t)))}),cn=(t,n)=>W(r=>{const e=null!=n;mt("satisfy",t,pt(1,e)),e&&kt("satisfy",n,xt(2,!0));const[u,[s,o]]=d(sn(t)(r));return o.status===un?u:X(s,m(n,o.errors))}),ln=(t,n,r)=>W(e=>{const u=null!=r;wt("range",t,dt(1,!0)),wt("range",n,dt(2,!0)),u&&kt("range",r,xt(3,!0));const[s,[o,i]]=d(sn(r=>r>=t&&r<=n)(e));return i.status===un?s:X(o,m(r,en.range(t,n)))}),fn=t=>W(n=>{null!=t&&kt("any",t,xt());const{index:r,view:e}=n;if(r>=e.byteLength)return X(n,m(t,en.any));const{width:u,next:s}=l(r,e);return Z(n,s,r+u)}),dn=t=>W(n=>{null!=t&&kt("eof",t,xt());const{index:r,view:e}=n;return r>=e.byteLength?Z(n,null):X(n,m(t,en.eof))}),pn=(t,n)=>W(r=>{const e=null!=n;At("oneof",t,gt(1,e)),e&&kt("oneof",n,xt(2,!0));const{index:u,view:s}=r,{width:o,next:i}=l(u,s),a=[...t];return a.includes(i)?Z(r,i,u+o):X(r,m(n,en.oneof(a)))}),hn=(t,n)=>W(r=>{const e=null!=n;At("noneof",t,gt(1,e)),e&&kt("noneof",n,xt(2,!0));const{index:u,view:s}=r,{width:o,next:i}=l(u,s),a=[...t];return a.includes(i)?X(r,m(n,en.noneof(a))):Z(r,i,u+o)}),bn=t=>W(n=>{null!=t&&kt("digit",t,xt());const[r,[e,u]]=d(sn(t=>t>="0"&&t<="9")(n));return u.status===un?r:X(e,m(t,en.digit))}),yn=t=>W(n=>{null!=t&&kt("hex",t,xt());const[r,[e,u]]=d(sn(t=>t>="0"&&t<="9"||t>="a"&&t<="f"||t>="A"&&t<="F")(n));return u.status===un?r:X(e,m(t,en.hex))}),xn=t=>W(n=>{null!=t&&kt("octal",t,xt());const[r,[e,u]]=d(sn(t=>t>="0"&&t<="7")(n));return u.status===un?r:X(e,m(t,en.octal))}),gn=t=>W(n=>{null!=t&&kt("letter",t,xt());const[r,[e,u]]=d(sn(t=>t>="a"&&t<="z"||t>="A"&&t<="Z")(n));return u.status===un?r:X(e,m(t,en.letter))}),vn=t=>W(n=>{null!=t&&kt("alpha",t,xt());const[r,[e,u]]=d(sn(t=>t>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9")(n));return u.status===un?r:X(e,m(t,en.alpha))}),wn=t=>W(n=>{null!=t&&kt("upper",t,xt());const[r,[e,u]]=d(sn(t=>t>="A"&&t<="Z")(n));return u.status===un?r:X(e,m(t,en.upper))}),mn=t=>W(n=>{null!=t&&kt("lower",t,xt());const[r,[e,u]]=d(sn(t=>t>="a"&&t<="z")(n));return u.status===un?r:X(e,m(t,en.lower))}),$n=t=>W(n=>(kt("fail",t),X(n,L(t)))),kn=t=>W(n=>(kt("fatal",t),B(n,L(t)))),En=t=>W(n=>Z(n,t)),{Ok:An}=D,On=/^\p{Alphabetic}/u,Un=/^(?:\p{Alphabetic}|\p{N})/u,jn=/^(?:\p{Uppercase}|\p{Lt})/u,Ln=/^\p{Lowercase}/u,Mn=/^(?:\r\n|[\r\n\t ])/,Fn=/^(?:\r\n|\p{White_Space})/u,Sn=/^[\r\n\t ]*/,_n=/^\p{White_Space}*/u,Nn=/^[\r\n\t ]+/,Tn=/^\p{White_Space}+/u,Cn=/^(?:\r\n|\r|\n)/,Pn=/^(?:\r\n|[\r\n\u0085\u2028\u2029])/u,In=t=>W(n=>{const{index:r,view:e}=n,u=o(r,e.byteLength-r,e).match(t);return u?Z(n,u[0],r+i(u[0]).byteLength):X(n)}),Rn=(t,n)=>W(r=>{const e=null!=n;!function(t,n,r=at){"string"!=typeof n&&"[object RegExp]"!==Object.prototype.toString.call(n)&&vt(t,n,r)}("regex",t,((t=1,n=!1)=>ft("a string or a regular expression",t,n))(1,e)),e&&kt("regex",n,xt(2,!0));let u="string"==typeof t?new RegExp(t):t;const{source:s,flags:o}=u;if("^"!==s[0]){u=new RegExp("^"+s,o)}const[i,[a,c]]=d(In(u)(r));return c.status===An?i:X(a,m(n,en.regex(u)))}),zn=t=>W(n=>{null!=t&&kt("uletter",t,xt());const[r,[e,u]]=d(In(On)(n));return u.status===An?r:X(e,m(t,en.uletter))}),Gn=t=>W(n=>{null!=t&&kt("ualpha",t,xt());const[r,[e,u]]=d(In(Un)(n));return u.status===An?r:X(e,m(t,en.ualpha))}),qn=t=>W(n=>{null!=t&&kt("uupper",t,xt());const[r,[e,u]]=d(In(jn)(n));return u.status===An?r:X(e,m(t,en.uupper))}),Dn=t=>W(n=>{null!=t&&kt("ulower",t,xt());const[r,[e,u]]=d(In(Ln)(n));return u.status===An?r:X(e,m(t,en.ulower))}),Vn=t=>W(n=>{null!=t&&kt("space",t,xt());const[r,[e,u]]=d(In(Mn)(n));return u.status===An?r:X(e,m(t,en.space))}),Wn=t=>W(n=>{null!=t&&kt("uspace",t,xt());const[r,[e,u]]=d(In(Fn)(n));return u.status===An?r:X(e,m(t,en.uspace))}),Zn=()=>W(t=>{const[n,r]=In(Sn)(t);return Z(n,null)}),Xn=()=>W(t=>{const[n,r]=In(_n)(t);return Z(n,null)}),Bn=t=>W(n=>{null!=t&&kt("spaces1",t,xt());const[r,e]=In(Nn)(n);return e.status===An?Z(r,null):X(r,m(t,en.spaces1))}),Jn=t=>W(n=>{null!=t&&kt("uspaces1",t,xt());const[r,e]=In(Tn)(n);return e.status===An?Z(r,null):X(r,m(t,en.uspaces1))}),Hn=t=>W(n=>{null!=t&&kt("newline",t,xt());const[r,[e,u]]=d(In(Cn)(n));return u.status===An?r:X(e,m(t,en.newline))}),Kn=t=>W(n=>{null!=t&&kt("unewline",t,xt());const[r,[e,u]]=d(In(Pn)(n));return u.status===An?r:X(e,m(t,en.unewline))}),{Ok:Qn}=D,Yn=(t,n)=>W(r=>{if(t<1)return Z(r,"");const{index:e,view:u}=r;if(e>=u.byteLength)return X(r);const{width:i,next:l}=function(t,n,r){const e=n.byteLength;let u=0;for(const o of s(r)){const r=t+u;if(r>=e)break;u+=c(r,n)}return t+u>=e&&(u=e-t),{width:u,next:o(t,u,n)}}(e,u,t);return a(l)===t&&n(l)?Z(r,l,e+i):X(r)}),tr=(t,n)=>W(r=>{const e=null!=n;kt("str",t,xt(1,e)),e&&kt("str",n,xt(2,!0));const[u,[s,o]]=d(Yn(a(t),n=>t===n)(r));return o.status===Qn?u:X(s,m(n,en.str(t)))}),nr=(t,n)=>W(r=>{const e=null!=n;kt("istr",t,xt(1,e)),e&&kt("istr",n,xt(2,!0));const[u,[s,o]]=d(Yn(a(t),n=>t.toLowerCase()===n.toLowerCase())(r));return o.status===Qn?u:X(s,m(n,en.istr(t)))}),rr=()=>W(t=>{const{index:n,view:r}=t,e=r.byteLength-n;return Z(t,o(n,e,r),n+e)}),er=(t,n)=>W(r=>{const e=null!=n;Ot("anystr",t,bt(1,e)),e&&kt("anystr",n,xt(2,!0));const[u,[s,o]]=d(Yn(t,()=>!0)(r));return o.status===Qn?u:X(s,m(n,en.anystr(t)))}),{Ok:ur,Fail:sr,Fatal:or}=D,ir=(...t)=>{const n=t.slice(),r="string"==typeof t[t.length-1]?n.pop():null;return W(t=>{const e=null!=r;n.forEach((t,n)=>Ut("alt",t,yt(n+1,!0)));let u=e?U(r):[];for(const r of n){const[n,[s,o]]=d(r(t));if(o.status===ur)return n;if(e||(u=_(u,o.errors)),o.status===or)return B(s,u)}return X(t,u)})},ar=(t,n)=>W(r=>{const e=null!=n;Ut("opt",t,yt(1,e)),e&&kt("opt",n,xt(2,!0));const[u,[s,o]]=d(t(r));if(o.status===ur)return u;const i=m(n,o.errors);if(o.status===or)return B(s,i);const a=Z(s,null);return a[1].errors=i,a}),cr=(t,n,r)=>W(e=>{const u=null!=r;Ut("def",t,yt(1,!0)),u&&kt("def",r,xt(3,!0));const[s,[o,i]]=d(t(e));return i.status===ur?s:i.status===sr?Z(o,n):B(o,m(r,i.errors))}),lr=(t,n)=>W(r=>{const e=null!=n;Ut("peek",t,yt(1,e)),e&&kt("peek",n,xt(2,!0));const u=r.index,[s,o]=t(r);return o.status===ur?Z(s,o.value,u):o.status===sr?X(s,m(n,o.errors),u):X(s,$(n,s,o.errors),u)}),fr=(t,n)=>W(r=>{const e=null!=n;Ut("empty",t,yt(1,e)),e&&kt("empty",n,xt(2,!0));const u=r.index,[s,o]=t(r);if(o.status===ur&&s.index===u)return Z(s,null);return w(o.status===or)(s,m(n,o.errors))}),dr=(t,n)=>W(r=>{const e=null!=n;Ut("not",t,yt(1,e)),e&&kt("not",n,xt(2,!0));const u=r.index,[s,o]=t(r);return o.status===ur?X(s,m(n,void 0),u):Z(s,null,u)}),{Ok:pr,Fail:hr,Fatal:br}=D,yr=(t,n)=>W(r=>{const e=null!=n;Ut("attempt",t,yt(1,e)),e&&kt("attempt",n,xt(2,!0));const u=r.index,[s,[o,i]]=d(t(r));if(i.status===pr)return s;if(i.status===br||o.index!==u)return X(o,$(n,o,i.errors),u);if(e){if(1===i.errors.length&&i.errors[0].type===O.Nested){const{ctx:t,errors:r}=i.errors[0];return X(o,S(n,t,r),u)}return X(o,U(n),u)}return X(o,i.errors,u)}),xr=(...t)=>{const n=t.slice(),r="string"==typeof n[n.length-1]?n.pop():null;return W(e=>{n.forEach((n,r)=>Ut("bseq",n,yt(r+1,t.length>1)));const u=[],s=e.index;let o=e,i=[];for(const t of n){var a;const[n,e]=t(o);if(o=n,i=(null===(a=e.errors)||void 0===a?void 0:a.length)?_(i,e.errors):[],e.status===br)return B(n,m(r,e.errors));if(e.status===hr){return X(n,k(n.index!==s,r,n,i),s)}u.push(e.value)}return Z(o,u)})},gr=(t,n,r)=>W(e=>{const u=null!=r;Ut("bchain",t,yt(1,!0)),mt("bchain",n,pt(2,!0)),u&&kt("bchain",r,xt(3,!0));const s=e.index,[o,i]=t(e);if(i.status!==pr){return w(i.status===br)(o,m(r,i.errors))}const a=n(i.value);Ut("bchain",a,nt("second argument to return a parser"));const[c,[l,f]]=d(a(o));if(f.status===pr)return c;const p=_(i.errors,f.errors);if(f.status===br)return B(l,m(r,p));return X(l,k(l.index!==s,r,l,p),s)}),vr=(t,n,r)=>W(e=>{const u=null!=r;Ut("bapply",t,yt(1,!0)),Ut("bapply",n,yt(2,!0)),u&&kt("bapply",r,xt(3,!0));const s=e.index,[o,i]=t(e);if(i.status!==pr){return w(i.status===br)(o,m(r,i.errors))}const[a,c]=n(o),l=_(i.errors,c.errors);if(c.status===br)return B(a,m(r,l));if(c.status===hr){return X(a,k(a.index!==s,r,a,l),s)}const f=c.value;return mt("bapply",f,nt("second argument to return a function")),Z(a,f(i.value))}),wr=(t,n,r)=>W(e=>{const u=null!=r;Ut("bleft",t,yt(1,!0)),Ut("bleft",n,yt(2,!0)),u&&kt("bleft",r,xt(3,!0));const s=e.index,[o,i]=t(e);if(i.status!==pr){return w(i.status===br)(o,m(r,i.errors))}const[a,c]=n(o);if(c.status===pr)return Z(a,i.value);const l=_(i.errors,c.errors);if(c.status===br)return B(a,m(r,l));return X(a,k(a.index!==s,r,a,l),s)}),mr=(t,n,r)=>W(e=>{const u=null!=r;Ut("bright",t,yt(1,!0)),Ut("bright",n,yt(2,!0)),u&&kt("bright",r,xt(3,!0));const s=e.index,[o,i]=t(e);if(i.status!==pr){return w(i.status===br)(o,m(r,i.errors))}const[a,[c,l]]=d(n(o));if(l.status===pr)return a;const f=_(i.errors,l.errors);if(l.status===br)return B(c,m(r,f));return X(c,k(c.index!==s,r,c,f),s)}),$r=(t,n,r)=>W(e=>{const u=null!=r;Ut("bcount",t,yt(1,!0)),Ot("bcount",n,bt(2,!0)),u&&kt("bcount",r,xt(3,!0));const o=e.index,i=[];let a=e;for(const e of s(n)){const[n,e]=t(a);if(a=n,e.status===br)return B(n,m(r,e.errors));if(e.status===hr){return X(n,k(n.index!==o,r,n,e.errors),o)}i.push(e.value)}return Z(a,i)}),kr=(t,n,r)=>W(e=>{const u=null!=r;Ut("buntil",t,yt(1,!0)),Ut("buntil",n,yt(2,!0)),u&&kt("buntil",r,xt(3,!0));const s=e.index,o=[];let i=e;for(;;){const[e,u]=n(i);if(i=e,u.status===br)return B(e,m(r,u.errors));if(u.status===pr)break;const[a,c]=t(i);if(i=a,c.status===br)return B(a,m(r,c.errors));if(c.status===hr){return X(a,k(a.index!==s,r,a,_(c.errors,u.errors)),s)}o.push(c.value)}return Z(i,o)}),Er=(t,n)=>W(r=>{const e=null!=n;$t("bblock",t,ht(1,e)),e&&kt("bblock",n,xt(2,!0));const u=t(),s=r.index;let o,i=[],a=r,c=0;for(;;){var l;const{value:t,done:r}=u.next(o);if(r)return Z(a,t);Ut("bblock",t,t=>`expected ${g(c+1)} yield to be to a parser; found ${v(t)}`);const[e,f]=t(a);if(a=e,i=(null===(l=f.errors)||void 0===l?void 0:l.length)?_(i,f.errors):[],f.status===br)return B(e,m(n,i));if(f.status===hr){return X(e,k(e.index!==s,n,e,i),s)}o=f.value,c++}}),Ar=(...t)=>{const n=t.slice(),r="string"==typeof n[n.length-1]?n.pop():null,e=n.pop();return W(t=>{n.forEach((t,n)=>Ut("bpipe",t,yt(n+1,!0))),mt("bpipe",e,pt(n.length+1,!0));const u=t.index,s=[];let o=t,i=[];for(const t of n){var a;const[n,e]=t(o);if(o=n,i=(null===(a=e.errors)||void 0===a?void 0:a.length)?_(i,e.errors):[],e.status===br)return B(n,m(r,i));if(e.status===hr){return X(n,k(n.index!==u,r,n,i),u)}s.push(e.value)}return Z(o,e(...s))})},Or=(t,n,r,e)=>W(u=>{var s;const o=null!=e;Ut("bbetween",t,yt(1,!0)),Ut("bbetween",n,yt(2,!0)),Ut("bbetween",r,yt(3,!0)),o&&kt("bbetween",e,xt(4,!0));const i=u.index,[a,c]=t(u);if(c.status!==pr){return w(c.status===br)(a,m(e,c.errors))}const[l,f]=r(a),d=(null===(s=f.errors)||void 0===s?void 0:s.length)?_(c.errors,f.errors):[];if(f.status===br)return B(l,m(e,d));if(f.status===hr){return X(l,k(l.index!==i,e,l,d),i)}const[p,h]=n(l);if(h.status===br)return B(p,m(e,_(d,h.errors)));if(h.status===hr){return X(p,k(p.index!==i,e,p,_(d,h.errors)),i)}return Z(p,f.value)}),{Ok:Ur,Fatal:jr}=D,Lr=(t,n)=>W(r=>{const e=null!=n;Ut("join",t,yt(1,e)),e&&kt("join",n,xt(2,!0));const[u,s]=t(r);if(s.status!==Ur){return w(s.status===jr)(u,m(n,s.errors))}const o=s.value;return Et("join",o,nt("argument to return an array")),Z(u,o.join(""))}),Mr=(t,n)=>W(r=>{const e=null!=n;Ut("flat",t,yt(1,e)),e&&kt("flat",n,xt(2,!0));const[u,s]=t(r);if(s.status!==Ur){return w(s.status===jr)(u,m(n,s.errors))}const o=s.value;return Et("flat",o,nt("argument to return an array")),Z(u,o.flat(1/0))}),Fr=(t,n)=>W(r=>{const e=null!=n;Ut("compact",t,yt(1,e)),e&&kt("compact",n,xt(2,!0));const[u,s]=t(r);if(s.status!==Ur){return w(s.status===jr)(u,m(n,s.errors))}const o=s.value;return Et("compact",o,nt("argument to return an array")),Z(u,o.filter(t=>null!=t))}),Sr=(t,n,r)=>W(e=>{const u=null!=r;Ut("value",t,yt(1,!0)),u&&kt("value",r,xt(3,!0));const[s,o]=t(e);if(o.status!==Ur){return w(o.status===jr)(s,m(r,o.errors))}return Z(s,n)}),_r=(t,n,r)=>W(e=>{const u=null!=r;Ut("nth",t,yt(1,!0)),Ot("nth",n,bt(2,!0)),u&&kt("nth",r,xt(3,!0));const[s,o]=t(e);if(o.status!==Ur){return w(o.status===jr)(s,m(r,o.errors))}const i=o.value;return Et("nth",i,nt("first argument to return an array")),Z(s,i[n])}),Nr=(t,n)=>W(r=>{const e=null!=n;Ut("first",t,yt(1,e)),e&&kt("first",n,xt(2,!0));const[u,s]=t(r);if(s.status!==Ur){return w(s.status===jr)(u,m(n,s.errors))}const o=s.value;return Et("first",o,nt("argument to return an array")),Z(u,o[0])}),Tr=(t,n)=>W(r=>{const e=null!=n;Ut("second",t,yt(1,e)),e&&kt("second",n,xt(2,!0));const[u,s]=t(r);if(s.status!==Ur){return w(s.status===jr)(u,m(n,s.errors))}const o=s.value;return Et("second",o,nt("argument to return an array")),Z(u,o[1])}),Cr=(t,n)=>W(r=>{const e=null!=n;Ut("third",t,yt(1,e)),e&&kt("third",n,xt(2,!0));const[u,s]=t(r);if(s.status!==Ur){return w(s.status===jr)(u,m(n,s.errors))}const o=s.value;return Et("third",o,nt("argument to return an array")),Z(u,o[2])}),Pr=(t,n)=>W(r=>{const e=null!=n;Ut("fourth",t,yt(1,e)),e&&kt("fourth",n,xt(2,!0));const[u,s]=t(r);if(s.status!==Ur){return w(s.status===jr)(u,m(n,s.errors))}const o=s.value;return Et("fourth",o,nt("argument to return an array")),Z(u,o[3])}),Ir=(t,n)=>W(r=>{const e=null!=n;Ut("fifth",t,yt(1,e)),e&&kt("fifth",n,xt(2,!0));const[u,s]=t(r);if(s.status!==Ur){return w(s.status===jr)(u,m(n,s.errors))}const o=s.value;return Et("fifth",o,nt("argument to return an array")),Z(u,o[4])}),Rr=(t,n,r)=>W(e=>{const u=null!=r;Ut("map",t,yt(1,!0)),mt("map",n,pt(2,!0)),u&&kt("map",r,xt(3,!0));const[s,o]=t(e);if(o.status!==Ur){return w(o.status===jr)(s,m(r,o.errors))}return Z(s,n(o.value))}),zr=(t,n,r)=>W(e=>{const u=null!=r;Ut("apply",t,yt(1,!0)),Ut("apply",n,yt(2,!0)),u&&kt("apply",r,xt(3,!0));const s=e.index,[o,i]=t(e);if(i.status!==Ur){return w(i.status===jr)(o,m(r,i.errors))}const[a,c]=n(o);if(c.status!==Ur){return w(c.status===jr||a.index!==s)(a,m(r,_(i.errors,c.errors)))}const l=c.value;return mt("apply",l,nt("second argument to return a function")),Z(a,l(i.value))}),Gr=(t,n,r)=>W(e=>{const u=null!=r;Ut("chain",t,yt(1,!0)),mt("chain",n,pt(2,!0)),u&&kt("chain",r,xt(3,!0));const s=e.index,[o,i]=t(e);if(i.status!==Ur){return w(i.status===jr)(o,m(r,i.errors))}const a=n(i.value);Ut("chain",a,nt("second argument to return a parser"));const[c,[l,f]]=d(a(o));if(f.status!==Ur){return w(f.status===jr||l.index!==s)(l,m(r,_(i.errors,f.errors)))}return c}),{Ok:qr,Fail:Dr,Fatal:Vr}=D;function Wr(t){return`[${t}]: infinite loop detected; neither content nor separator parser consumed input`}const Zr=(...t)=>{const n=t.slice(),r="string"==typeof t[t.length-1]?n.pop():null;return W(t=>{const e=null!=r;n.forEach((t,n)=>Ut("seq",t,yt(n+1,!0)));const u=[],s=t.index;let o=m(r,[]),i=t;for(const t of n){var a;const[n,r]=t(i);if(i=n,e||(o=(null===(a=r.errors)||void 0===a?void 0:a.length)?_(o,r.errors):[]),r.status!==qr){return w(r.status===Vr||i.index!==s)(i,o)}u.push(r.value)}return Z(i,u)})},Xr=(t,n,r)=>W(e=>{const u=null!=r;Ut("left",t,yt(1,!0)),Ut("left",n,yt(2,!0)),u&&kt("left",r,xt(3,!0));const s=e.index,[o,i]=t(e);if(i.status!==D.Ok){return(i.status===Vr?B:X)(o,m(r,i.errors))}const[a,c]=n(o);if(c.status!==qr){return w(c.status===Vr||a.index!==s)(a,m(r,_(i.errors,c.errors)))}return Z(a,i.value)}),Br=(t,n,r)=>W(e=>{const u=null!=r;Ut("right",t,yt(1,!0)),Ut("right",n,yt(2,!0)),u&&kt("right",r,xt(3,!0));const s=e.index,[o,i]=t(e);if(i.status!==D.Ok){return w(i.status===Vr)(o,m(r,i.errors))}const[a,[c,l]]=d(n(o));if(l.status!==qr){return w(c.status===Vr||c.index!==s)(c,m(r,_(i.errors,l.errors)))}return a}),Jr=(t,n)=>W(r=>{const e=null!=n;$t("block",t,ht(1,e)),e&&kt("block",n,xt(2,!0));const u=t(),s=r.index;let o,i=m(n,[]),a=r,c=0;for(;;){var l;const{value:t,done:n}=u.next(o);if(n)return Z(a,t);Ut("block",t,t=>`expected ${g(c+1)} yield to be to a parser; found ${v(t)}`);const[r,f]=t(a);if(a=r,e||(i=(null===(l=f.errors)||void 0===l?void 0:l.length)?_(i,f.errors):[]),f.status!==qr){return w(f.status===Vr||r.index!==s)(r,i)}o=f.value,c++}}),Hr=(t,n)=>W(r=>{const e=null!=n;Ut("many",t,yt(1,e)),e&&kt("many",n,xt(2,!0));const u=[];let s=r;for(;;){const[r,e]=t(s);if(s=r,e.status===Vr)return B(r,m(n,e.errors));if(e.status===Dr)break;if(u.push(e.value),s.index>=s.view.byteLength)break}return Z(s,u)}),Kr=(t,n)=>W(r=>{const e=null!=n;Ut("many1",t,yt(1,e)),e&&kt("many1",n,xt(2,!0));const[u,s]=t(r);if(s.status!==qr){return w(s.status===Vr)(u,m(n,s.errors))}let o=u;const i=[s.value];for(;;){const[r,e]=t(o);if(o=r,e.status===Vr)return B(r,m(n,e.errors));if(e.status===Dr)break;if(i.push(e.value),o.index>=o.view.byteLength)break}return Z(o,i)}),Qr=(t,n)=>W(r=>{const e=null!=n;Ut("skip",t,yt(1,e)),e&&kt("skip",n,xt(2,!0));const[u,s]=t(r);if(s.status!==qr){return w(s.status===Vr)(u,m(n,s.errors))}return Z(u,null)}),Yr=(t,n,r)=>W(e=>{const u=null!=r;Ut("sepby",t,yt(1,!0)),Ut("sepby",n,yt(2,!0)),u&&kt("sepby",r,xt(3,!0));let s=e.index;const[o,i]=t(e);if(i.status===Vr)return B(o,m(r,i.errors));if(i.status===Dr)return Z(o,[]);const a=[i.value];let c=o;for(;;){s=c.index;const[e,u]=n(c);if(c=e,u.status===Vr)return B(e,m(r,u.errors));if(u.status===Dr)break;const[o,i]=t(c);if(c=o,i.status===Vr)return B(o,m(r,i.errors));if(i.status===Dr)break;if(c.index===s)throw new TypeError(Wr("sepby"));a.push(i.value)}return Z(c,a,s)}),te=(t,n,r)=>W(e=>{const u=null!=r;Ut("sepby1",t,yt(1,!0)),Ut("sepby1",n,yt(2,!0)),u&&kt("sepby1",r,xt(3,!0));let s=e.index;const[o,i]=t(e);if(i.status!==qr){return w(i.status===Vr)(o,m(r,i.errors))}const a=[i.value];let c=o;for(;;){s=c.index;const[e,u]=n(c);if(c=e,u.status===Vr)return B(e,m(r,u.errors));if(u.status===Dr)break;const[o,i]=t(c);if(c=o,i.status===Vr)return B(o,m(r,i.errors));if(i.status===Dr)break;if(c.index===s)throw new TypeError(Wr("sepby1"));a.push(i.value)}return Z(c,a,s)}),ne=(t,n,r)=>W(e=>{const u=null!=r;Ut("endby",t,yt(1,!0)),Ut("endby",n,yt(2,!0)),u&&kt("endby",r,xt(3,!0));let s=e.index;const[o,i]=t(e);if(i.status===Vr)return B(o,m(r,i.errors));if(i.status===Dr)return Z(o,[]);const a=[i.value];let c=o;for(;;){s=c.index;const[e,u]=n(c);if(c=e,u.status===Vr)return B(e,m(r,u.errors));if(u.status===Dr)break;const[o,i]=t(c);if(c=o,i.status===Vr)return B(o,m(r,i.errors));if(i.status===Dr)break;if(c.index===s)throw new TypeError(Wr("endby"));a.push(i.value)}const[l,f]=n({...c,index:s});return f.status===Vr?B(l,m(r,f.errors)):Z(l,a)}),re=(t,n,r)=>W(e=>{const u=null!=r;Ut("endby1",t,yt(1,!0)),Ut("endby1",n,yt(2,!0)),u&&kt("endby1",r,xt(3,!0));let s=e.index;const[o,i]=t(e);if(i.status!==qr){return w(i.status===Vr)(o,m(r,i.errors))}const a=[i.value];let c=o;for(;;){s=c.index;const[e,u]=n(c);if(c=e,u.status===Vr)return B(e,m(r,u.errors));if(u.status===Dr)break;const[o,i]=t(c);if(c=o,i.status===Vr)return B(o,m(r,i.errors));if(i.status===Dr)break;if(c.index===s)throw new TypeError(Wr("endby1"));a.push(i.value)}const[l,f]=n({...c,index:s});return f.status===Vr?B(l,m(r,f.errors)):Z(l,a)}),ee=(t,n,r)=>W(e=>{const u=null!=r;Ut("count",t,yt(1,!0)),Ot("count",n,bt(2,!0)),u&&kt("count",r,xt(3,!0));const o=e.index,i=[];let a=e;for(const e of s(n)){const[n,e]=t(a);if(a=n,e.status!==qr){return w(e.status===Vr||n.index!==o)(n,m(r,e.errors))}i.push(e.value)}return Z(a,i)}),ue=(t,n,r,e)=>W(u=>{var s;const o=null!=e;Ut("between",t,yt(1,!0)),Ut("between",n,yt(2,!0)),Ut("between",r,yt(3,!0)),o&&kt("between",e,xt(4,!0));const i=u.index,[a,c]=t(u);if(c.status!==qr){return w(c.status===Vr)(a,m(e,c.errors))}const[l,f]=r(a),d=m(e,(null===(s=f.errors)||void 0===s?void 0:s.length)?_(c.errors,f.errors):[]);if(f.status!==qr){return w(f.status===Vr||l.index!==i)(l,d)}const[p,h]=n(l);if(h.status!==qr){return w(h.status===Vr||p.index!==i)(p,m(e,_(d,h.errors)))}return Z(p,f.value)}),se=(t,n,r)=>W(e=>{const u=null!=r;Ut("until",t,yt(1,!0)),Ut("until",n,yt(2,!0)),u&&kt("until",r,xt(3,!0));const s=e.index,o=[];let i=e;for(;;){const[e,u]=n(i);if(i=e,u.status===Vr)return B(e,m(r,u.errors));if(u.status===qr)break;const[a,c]=t(i);if(i=a,c.status===Vr)return B(a,m(r,c.errors));if(c.status===Dr){return w(a.index!==s)(a,m(r,_(c.errors,u.errors)))}o.push(c.value)}return Z(i,o)}),oe=(...t)=>{const n=t.slice(),r="string"==typeof t[t.length-1]?n.pop():null,e=n.pop();return W(t=>{const u=null!=r;n.forEach((t,n)=>Ut("pipe",t,yt(n+1,!0))),mt("pipe",e,pt(n.length+1,!0));const s=t.index,o=[];let i=t,a=m(r,[]);for(const t of n){var c;const[n,r]=t(i);if(i=n,u||(a=(null===(c=r.errors)||void 0===c?void 0:c.length)?_(a,r.errors):[]),r.status!==qr){return w(r.status===Vr||n.index!==s)(n,a)}o.push(r.value)}return Z(i,e(...o))})};function ie(t){return n=>`expected ${t} op parser to return a function; found ${v(n)}`}const ae=(t,n,r,e)=>W(u=>{const o=null!=e;Ut("lassoc",t,yt(1,!0)),Ut("lassoc",n,yt(2,!0)),o&&kt("lassoc",e,xt(4,!0));const[i,a]=t(u);if(a.status===Vr)return B(i,m(e,a.errors));if(a.status===Dr)return Z(i,r);const c=[a.value],l=[];let f=i,d=f.index,p=0;for(;;){const[r,u]=n(f);if(f=r,u.status===Vr)return B(r,m(e,u.errors));if(u.status===Dr)break;const[s,o]=t(f);if(f=s,o.status===Vr)return B(s,m(e,o.errors));if(o.status===Dr)break;mt("lassoc",u.value,ie(g(p+1))),l.push(u.value),c.push(o.value),d=f.index,p++}let h=c[0];for(const t of s(l.length))h=l[t](h,c[t+1]);return Z(f,h,d)}),ce=(t,n,r)=>W(e=>{const u=null!=r;Ut("lassoc1",t,yt(1,!0)),Ut("lassoc1",n,yt(2,!0)),u&&kt("lassoc1",r,xt(3,!0));const[o,i]=t(e);if(i.status!==qr){return w(i.status===Vr)(o,m(r,i.errors))}const a=[i.value],c=[];let l=o,f=l.index,d=0;for(;;){const[e,u]=n(l);if(l=e,u.status===Vr)return B(e,m(r,u.errors));if(u.status===Dr)break;const[s,o]=t(l);if(l=s,o.status===Vr)return B(s,m(r,o.errors));if(o.status===Dr)break;mt("lassoc1",u.value,ie(g(d+1))),c.push(u.value),a.push(o.value),f=l.index,d++}let p=a[0];for(const t of s(c.length))p=c[t](p,a[t+1]);return Z(l,p,f)}),le=(t,n,r,e)=>W(u=>{const o=null!=e;Ut("rassoc",t,yt(1,!0)),Ut("rassoc",n,yt(2,!0)),o&&kt("rassoc",e,xt(4,!0));const[i,a]=t(u);if(a.status===Vr)return B(i,m(e,a.errors));if(a.status===Dr)return Z(i,r);const c=[a.value],l=[];let f=i,d=f.index,p=0;for(;;){const[r,u]=n(f);if(f=r,u.status===Vr)return B(r,m(e,u.errors));if(u.status===Dr)break;const[s,o]=t(f);if(f=s,o.status===Vr)return B(s,m(e,o.errors));if(o.status===Dr)break;mt("rassoc",u.value,ie(g(p+1))),l.push(u.value),c.push(o.value),d=f.index,p++}let h=c[c.length-1];for(const t of s(l.length-1,-1))h=l[t](c[t],h);return Z(f,h,d)}),fe=(t,n,r)=>W(e=>{const u=null!=r;Ut("rassoc1",t,yt(1,!0)),Ut("rassoc1",n,yt(2,!0)),u&&kt("rassoc1",r,xt(3,!0));const[o,i]=t(e);if(i.status!==qr){return w(i.status===Vr)(o,m(r,i.errors))}const a=[i.value],c=[];let l=o,f=l.index,d=0;for(;;){const[e,u]=n(l);if(l=e,u.status===Vr)return B(e,m(r,u.errors));if(u.status===Dr)break;const[s,o]=t(l);if(l=s,o.status===Vr)return B(s,m(r,o.errors));if(o.status===Dr)break;mt("rassoc1",u.value,ie(g(d+1))),c.push(u.value),a.push(o.value),f=l.index,d++}let p=a[a.length-1];for(const t of s(c.length-1,-1))p=c[t](a[t],p);return Z(l,p,f)})}])}));