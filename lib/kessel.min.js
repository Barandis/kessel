/*!
 * Copyright (c) 2020 Thomas Otterson
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * 
 */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.kessel=n():t.kessel=n()}(this,(function(){return function(t){var n={};function r(e){if(n[e])return n[e].exports;var s=n[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var s in t)r.d(e,s,function(n){return t[n]}.bind(null,s));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=0)}([function(t,n,r){"use strict";r.r(n),r.d(n,"alpha",(function(){return vn})),r.d(n,"any",(function(){return fn})),r.d(n,"char",(function(){return on})),r.d(n,"charI",(function(){return an})),r.d(n,"digit",(function(){return yn})),r.d(n,"eof",(function(){return dn})),r.d(n,"hex",(function(){return xn})),r.d(n,"letter",(function(){return bn})),r.d(n,"lower",(function(){return mn})),r.d(n,"noneof",(function(){return hn})),r.d(n,"octal",(function(){return gn})),r.d(n,"oneof",(function(){return pn})),r.d(n,"range",(function(){return ln})),r.d(n,"satisfy",(function(){return cn})),r.d(n,"upper",(function(){return wn})),r.d(n,"always",(function(){return Un})),r.d(n,"fail",(function(){return $n})),r.d(n,"fatal",(function(){return kn})),r.d(n,"alphaU",(function(){return zn})),r.d(n,"letterU",(function(){return Pn})),r.d(n,"lowerU",(function(){return qn})),r.d(n,"newline",(function(){return Hn})),r.d(n,"newlineU",(function(){return Kn})),r.d(n,"regex",(function(){return Cn})),r.d(n,"space",(function(){return Dn})),r.d(n,"spaceU",(function(){return Vn})),r.d(n,"spaces",(function(){return Wn})),r.d(n,"spaces1",(function(){return Xn})),r.d(n,"spaces1U",(function(){return Jn})),r.d(n,"spacesU",(function(){return Zn})),r.d(n,"upperU",(function(){return Gn})),r.d(n,"all",(function(){return rr})),r.d(n,"anystr",(function(){return er})),r.d(n,"str",(function(){return tr})),r.d(n,"strI",(function(){return nr})),r.d(n,"alt",(function(){return ar})),r.d(n,"def",(function(){return cr})),r.d(n,"empty",(function(){return fr})),r.d(n,"not",(function(){return dr})),r.d(n,"opt",(function(){return ir})),r.d(n,"peek",(function(){return lr})),r.d(n,"applyB",(function(){return vr})),r.d(n,"attempt",(function(){return xr})),r.d(n,"betweenB",(function(){return Lr})),r.d(n,"blockB",(function(){return Ur})),r.d(n,"chainB",(function(){return br})),r.d(n,"leftB",(function(){return wr})),r.d(n,"pipeB",(function(){return Br})),r.d(n,"repeatB",(function(){return $r})),r.d(n,"rightB",(function(){return mr})),r.d(n,"seqB",(function(){return gr})),r.d(n,"untilB",(function(){return kr})),r.d(n,"apply",(function(){return Cr})),r.d(n,"chain",(function(){return Pr})),r.d(n,"compact",(function(){return jr})),r.d(n,"fifth",(function(){return Nr})),r.d(n,"first",(function(){return Rr})),r.d(n,"fourth",(function(){return _r})),r.d(n,"join",(function(){return Or})),r.d(n,"map",(function(){return Tr})),r.d(n,"nth",(function(){return Ir})),r.d(n,"second",(function(){return Fr})),r.d(n,"third",(function(){return Sr})),r.d(n,"value",(function(){return Mr})),r.d(n,"assoc1L",(function(){return ie})),r.d(n,"assoc1R",(function(){return le})),r.d(n,"assocL",(function(){return ae})),r.d(n,"assocR",(function(){return ce})),r.d(n,"between",(function(){return ee})),r.d(n,"block",(function(){return Xr})),r.d(n,"endby",(function(){return te})),r.d(n,"endby1",(function(){return ne})),r.d(n,"left",(function(){return Wr})),r.d(n,"many",(function(){return Jr})),r.d(n,"many1",(function(){return Hr})),r.d(n,"pipe",(function(){return ue})),r.d(n,"repeat",(function(){return re})),r.d(n,"right",(function(){return Zr})),r.d(n,"sepby",(function(){return Qr})),r.d(n,"sepby1",(function(){return Yr})),r.d(n,"seq",(function(){return Vr})),r.d(n,"skip",(function(){return Kr})),r.d(n,"until",(function(){return se})),r.d(n,"Status",(function(){return q})),r.d(n,"failReply",(function(){return Z})),r.d(n,"failure",(function(){return Y})),r.d(n,"fatalReply",(function(){return X})),r.d(n,"okReply",(function(){return W})),r.d(n,"parse",(function(){return J})),r.d(n,"parser",(function(){return V})),r.d(n,"run",(function(){return tt})),r.d(n,"status",(function(){return H})),r.d(n,"succeeded",(function(){return K})),r.d(n,"success",(function(){return Q})),r.d(n,"ErrorType",(function(){return L})),r.d(n,"compound",(function(){return I})),r.d(n,"expected",(function(){return E})),r.d(n,"formatErrors",(function(){return z})),r.d(n,"generic",(function(){return O})),r.d(n,"getPosition",(function(){return G})),r.d(n,"merge",(function(){return R})),r.d(n,"nested",(function(){return M})),r.d(n,"other",(function(){return j})),r.d(n,"unexpected",(function(){return A}));const e=new TextEncoder,s=new TextDecoder;function*u(t,n,r,e){const s="number"==typeof n?t:0,u="number"==typeof n?n:t,o="number"==typeof r?0===r?1:Math.abs(r):1,a="number"==typeof r?!!e:"number"==typeof n?!!r:!!n,i=s<u;let c=s;for(;!(i?a?c>u:c>=u:a?c<u:c<=u);)yield c,c=i?c+o:c-o}function o(t,n,r){const e=Uint8Array.from({length:n},(n,e)=>r.getUint8(t+e));return s.decode(e)}function a(t){return new DataView(e.encode(t).buffer)}function i(t){return[...t].length}function c(t,n){const r=n.getUint8(t);return(128&r)>>7==0?1:(224&r)>>5==6?2:(240&r)>>4==14?3:(240&r)>>4==15?4:1}function l(t,n){const r=c(t,n);return{width:r,next:o(t,r,n)}}function f(t){return`'${t}'`}function d(t){return[t,t]}function p(t){switch(t.length){case 0:return"";case 1:return t[0];case 2:return t.join(" or ");default:{const n=t.slice(),r=n.pop();return`${n.join(", ")}, or ${r}`}}}const h=["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],y=["zeroth","first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth","eleventh","twelfth","thirteenth","fourteenth","fifteenth","sixteenth","seventeenth","eighteenth","nineteenth"],x=["twent","thirt","fort","fift","sixt","sevent","eight","ninet"],g=["hundred","thousand","million","billion","trillion","quadrillion"];function b(t){if(t<0||t>Number.MAX_SAFE_INTEGER)throw new Error("Argument must be between 0 and "+Number.MAX_SAFE_INTEGER);const n=Math.floor(Math.log10(t));if(t<20)return y[t];if(1===n){const n=Math.floor(t/10)-2;return t%10==0?x[n]+"ieth":`${x[n]}y-${y[t%10]}`}if(2===n){const r=Math.floor(t/10**n),e=t-r*10**n;return`${h[r]} ${g[0]}${0===e?"th":" "+b(e)}`}const r=n%3+1,e=Math.floor(n/3),s=Math.floor(t/10**(n-r+1)),u=function t(n){if(n<20)return h[n];const r=n%10;if(n<100)return`${x[Math.floor(n/10)-2]}y${0===r?"":"-"+h[r]}`;const e=n-100*Math.floor(n/100);return`${h[Math.floor(n/100)]} ${g[0]}${0===e?"th":" "+t(e)}`}(s),o=t-s*10**(n-r+1);return`${u} ${g[e]}${0===o?"th":" "+b(o)}`}function v(t){return void 0===t?"undefined":"function"==typeof t?V.created(t)?"parser":"function":"symbol"==typeof t?`Symbol(${t.description})`:JSON.stringify(t)}function w(t){return t?X:Z}function m(t,n){return null==t?n:E(t)}function $(t,n,r){return null==t?M(n,r):I(t,n,r)}function k(t,n,r,e){return t?$(n,r,e):m(n,e)}const U=/\t/gu,B=/(?:\p{Mn}|\p{Cf})/gu,L={Expected:"expected",Unexpected:"unexpected",Generic:"generic",Nested:"nested",Compound:"compound",Other:"other"};function E(t){return[{type:L.Expected,label:t}]}function A(t){return[{type:L.Unexpected,label:t}]}function O(t){return[{type:L.Generic,label:t}]}function j(t){return[{type:L.Other,label:t}]}function M(t,n){return 1===n.length&&n[0].type===L.Nested?n:[{type:L.Nested,ctx:t,errors:n}]}function I(t,n,r){return 1===r.length&&r[0].type===L.Nested?[{type:L.Compound,ctx:r.ctx,errors:r.errors,label:t}]:[{type:L.Compound,ctx:n,errors:r,label:t}]}function R(t=[],n=[]){return[...t,...n]}function F(t,n){const r=n.getUint8(t);if(10===r||11===r||12===r)return{newline:!0,skip:1};if(13===r){if(t<n.byteLength-1){const e=n.getUint8(t+1);if(13===r&&10===e)return{newline:!0,skip:2}}return{newline:!0,skip:1}}if(t<n.byteLength-1){const e=n.getUint8(t+1);if(194===r&&133===e)return{newline:!0,skip:2};if(t<n.byteLength-2){const s=n.getUint8(t+2);if(226===r&&128===e&&(168===s||169===s))return{newline:!0,skip:3}}}return{newline:!1,skip:c(t,n)}}function S(t,n){let r=0,e=1,s=0;for(;s<n.byteLength;){const{newline:u,skip:o}=F(s,n);if(u){if(s+o>t)return{start:r,end:s-1,lineno:e};e++,r=s+o}s+=o}return{start:r,end:n.byteLength-1,lineno:e}}function _(t,n,r){let e=0,s=r;for(;s<t&&s<n.byteLength;)s+=c(s,n),e++;return e}function N(t,n,r){const e=[];let s=U.exec(n);for(;null!==s;)e.push(s.index),s=U.exec(n);let u=0,o=0,a=n;for(const n of e){const e=n+u,s=r-e%r;e<t+o&&(o+=s-1),u+=s-1,a=a.substring(0,e)+" ".repeat(s)+a.substring(e+1)}return{line:a,colIndex:o+t}}function T(t,n){let r=t;const e=[];let s=B.exec(n);for(;null!==s;)e.push(s.index),s.index<r&&r--,s=B.exec(n);return{colno:r+1,length:i(n)-e.length}}function C(t,n,r,e){const s=" ".repeat(e);return t.map(t=>{const{index:u,view:o}=t.ctx;return(t.label?`\n${s}Could not parse ${t.label} because:\n\n`:`\n${s}The parser backtracked after:\n\n`)+P(t.errors,u,o,n,r,e+2)}).join("")}function P(t,n,r,e=8,s=72,u=0){const{start:a,end:i,lineno:c}=S(n,r),l=_(n,r,a),f=" ".repeat(u),d=o(a,i-a+1,r),{colIndex:h,line:y}=N(l,d,e),{colno:x,length:g}=T(h,y),b=`${f}Parse error at (line ${c}, column ${x}):`,v=function(t,n,r,e,s=0){const u=" ".repeat(s);if(r<=e&&n<=e)return`${u}${t}\n${u}${" ".repeat(r-1)}^`;if(r<=e-3)return`${u}${t.substring(0,e-3)}...\n${u}${" ".repeat(r-1)}^`;if(r>=n-e+3){const s=n-e+3,o=r-(n-e);return`${u}...${t.substring(s)}\n${u}${" ".repeat(o-1)}^`}const o=r-1-Math.ceil(e/2)+3,a=r-1+Math.floor(e/2)-3;return`${u}...${t.substring(o,a)}...\n${u}${" ".repeat(Math.ceil(e/2))}^`}(y,g,x,s,u),w=t.find(t=>t.type===L.Generic),m=t.find(t=>t.type===L.Unexpected),$=p(t.filter(t=>t.type===L.Expected).map(t=>t.label)),k=t.filter(t=>t.type===L.Nested),U=t.filter(t=>t.type===L.Compound),B=m?`${f}Unexpected ${m.label}\n`:"",E=$.length?`${f}Expected ${$}\n`:"",A=w?`${f}${w.label}\n`:"",O=C(k,e,s,u),j=C(U,e,s,u);return function(t,n){let r=t;for(;"\n"===r[r.length-1];)r=r.substring(0,r.length-1);return r+"\n".repeat(n)}(`${b}\n\n${v}\n${B}${E}${A}${0===t.length?f+"Unknown error(s)\n":""}${n>=r.byteLength?f+"Note: failure occurred at the end of input\n":""}${j}${O}`,2)}function z(t,n,r,e=P){const[s,u]=t,{index:o,view:a}=s;return e(u.errors,o,a,n,r)}function G(t,n=8){const{index:r,view:e}=t,{start:s,end:u,lineno:a}=S(r,e),i=_(r,e,s),c=o(s,u-s+1,e),{colIndex:l,line:f}=N(i,c,n),{colno:d,_:p}=T(l,f);return{line:a,column:d}}const q={Ok:"ok",Fail:"fail",Fatal:"fatal"};function D(t){const n="Parser input must be a string, a typed array, an array buffer, or a data view; parser input was "+typeof t;return{view:(t=>{if("string"==typeof t)return a(t);if((r=t)instanceof Uint8Array||r instanceof Uint8ClampedArray||r instanceof Uint16Array||r instanceof Uint32Array||r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array||r instanceof Float32Array||r instanceof Float64Array)return new DataView(t.buffer);var r;if(t instanceof ArrayBuffer)return new DataView(t);if(t instanceof DataView)return t;throw new Error(n)})(t),index:0}}const V=function(t,n="created"){const r=new WeakSet;return Object.defineProperty((...n)=>{const e=t(...n);return r.add(e),e},n,{value:r.has.bind(r)})}(t=>t);function W(t,n=null,r=t.index){return[{...t,index:r},{status:q.Ok,value:n}]}function Z(t,n=[],r=t.index){return[{...t,index:r},{status:q.Fail,errors:n}]}function X(t,n=[],r=t.index){return[{...t,index:r},{status:q.Fatal,errors:n}]}function J(t,n){return t(D(n))}function H(t){return t[1].status}function K(t){return t[1].status===q.Ok}function Q(t){return K(t)?t[1].value:null}function Y(t){return K(t)?null:z(t)}function tt(t,n){const[r,[e,s]]=d(t(D(n)));if(s.status===q.Ok)return s.value;throw new Error(z(r))}const nt=t=>n=>`expected ${t}; found ${v(n)}`,rt=nt("a one-character string"),et=nt("a function"),st=nt("a generator function"),ut=nt("a string"),ot=nt("an array"),at=nt("a string or an array of characters"),it=nt("a string or a regular expression"),ct=nt("a number"),lt=nt("a parser"),ft=(t,n=1,r=!1)=>e=>`expected ${r?b(n)+" ":""}argument to be ${t}; found ${v(e)}`,dt=(t=1,n=!1)=>ft("a one-character string",t,n),pt=(t=1,n=!1)=>ft("a function",t,n),ht=(t=1,n=!1)=>ft("a generator function",t,n),yt=(t=1,n=!1)=>ft("a number",t,n),xt=(t=1,n=!1)=>ft("a parser",t,n),gt=(t=1,n=!1)=>ft("a string",t,n),bt=(t=1,n=!1)=>ft("a string or an array of characters",t,n);function vt(t,n,r){throw new Error(`[${t}]: ${r(n)}`)}function wt(t,n,r=rt){"string"==typeof n&&1===i(n)||vt(t,n,r)}function mt(t,n,r=et){("function"!=typeof n||V.created(n))&&vt(t,n,r)}function $t(t,n,r=st){"[object GeneratorFunction]"!==Object.prototype.toString.call(n)&&vt(t,n,r)}function kt(t,n,r=ut){"string"!=typeof n&&vt(t,n,r)}function Ut(t,n,r=ot){Array.isArray(n)||vt(t,n,r)}function Bt(t,n,r=at){Array.isArray(n)&&n.every(t=>"string"==typeof t&&1===i(t))||"string"==typeof n||vt(t,n,r)}function Lt(t,n,r=ct){"number"!=typeof n&&vt(t,n,r)}function Et(t,n,r=lt){"function"==typeof n&&V.created(n)||vt(t,n,r)}const At="a Unicode alphanumeric character",Ot="any character",jt=t=>`a string of ${t} characters`,Mt=t=>f(t),It=t=>f(t),Rt="a digit",Ft="end of input",St="a hexadecimal digit",_t="a letter",Nt="a Unicode letter",Tt="a lowercase letter",Ct="a Unicode lowercase letter",Pt="a newline",zt="a Unicode newline",Gt=t=>"none of "+p(t.map(t=>`'${t}'`)),qt="an octal digit",Dt=t=>"one of "+p(t.map(t=>`'${t}'`)),Vt=(t,n)=>`a character between '${t}' and '${n}'`,Wt=t=>"a string matching "+t,Zt="a whitespace character",Xt="zero or more whitespace characters",Jt="one or more whitespace characters",Ht="zero or more Unicode whitespace characters",Kt="one or more Unicode whitespace characters",Qt="a Unicode whitespace character",Yt=t=>f(t),tn=t=>f(t),nn="an uppercase letter",rn="a Unicode uppercase letter",en={alpha:E("an alphanumeric character"),alphaU:E(At),any:E(Ot),anystr:t=>E(jt(t)),char:t=>E(Mt(t)),charI:t=>E(It(t)),digit:E(Rt),eof:E(Ft),hex:E(St),letter:E(_t),letterU:E(Nt),lower:E(Tt),lowerU:E(Ct),newline:E(Pt),newlineU:E(zt),noneof:t=>E(Gt(t)),octal:E(qt),oneof:t=>E(Dt(t)),range:(t,n)=>E(Vt(t,n)),regex:t=>E(Wt(t)),space:E(Zt),spaces:E(Xt),spaces1:E(Jt),spacesU:E(Ht),spaces1U:E(Kt),spaceU:E(Qt),str:t=>E(Yt(t)),strI:t=>E(tn(t)),upper:E(nn),upperU:E(rn)},{Ok:sn}=q,un=t=>V(n=>{const{index:r,view:e}=n;if(r>=e.byteLength)return Z(n);const{width:s,next:u}=l(r,e);return t(u)?W(n,u,r+s):Z(n)}),on=(t,n)=>V(r=>{const e=null!=n;wt("char",t,dt(1,e)),e&&kt("char",n,gt(2,!0));const[s,[u,o]]=d(un(n=>t===n)(r));return o.status===sn?s:Z(u,m(n,en.char(t)))}),an=(t,n)=>V(r=>{const e=null!=n;wt("charI",t,dt(1,e)),e&&kt("charI",n,gt(2,!0));const[s,[u,o]]=d(un(n=>t.toLowerCase()===n.toLowerCase())(r));return o.status===sn?s:Z(u,m(n,en.charI(t)))}),cn=(t,n)=>V(r=>{const e=null!=n;mt("satisfy",t,pt(1,e)),e&&kt("satisfy",n,gt(2,!0));const[s,[u,o]]=d(un(t)(r));return o.status===sn?s:Z(u,m(n,o.errors))}),ln=(t,n,r)=>V(e=>{const s=null!=r;wt("range",t,dt(1,!0)),wt("range",n,dt(2,!0)),s&&kt("range",r,gt(3,!0));const[u,[o,a]]=d(un(r=>r>=t&&r<=n)(e));return a.status===sn?u:Z(o,m(r,en.range(t,n)))}),fn=t=>V(n=>{null!=t&&kt("any",t,gt());const{index:r,view:e}=n;if(r>=e.byteLength)return Z(n,m(t,en.any));const{width:s,next:u}=l(r,e);return W(n,u,r+s)}),dn=t=>V(n=>{null!=t&&kt("eof",t,gt());const{index:r,view:e}=n;return r>=e.byteLength?W(n,null):Z(n,m(t,en.eof))}),pn=(t,n)=>V(r=>{const e=null!=n;Bt("oneof",t,bt(1,e)),e&&kt("oneof",n,gt(2,!0));const{index:s,view:u}=r,{width:o,next:a}=l(s,u),i=[...t];return i.includes(a)?W(r,a,s+o):Z(r,m(n,en.oneof(i)))}),hn=(t,n)=>V(r=>{const e=null!=n;Bt("noneof",t,bt(1,e)),e&&kt("noneof",n,gt(2,!0));const{index:s,view:u}=r,{width:o,next:a}=l(s,u),i=[...t];return i.includes(a)?Z(r,m(n,en.noneof(i))):W(r,a,s+o)}),yn=t=>V(n=>{null!=t&&kt("digit",t,gt());const[r,[e,s]]=d(un(t=>t>="0"&&t<="9")(n));return s.status===sn?r:Z(e,m(t,en.digit))}),xn=t=>V(n=>{null!=t&&kt("hex",t,gt());const[r,[e,s]]=d(un(t=>t>="0"&&t<="9"||t>="a"&&t<="f"||t>="A"&&t<="F")(n));return s.status===sn?r:Z(e,m(t,en.hex))}),gn=t=>V(n=>{null!=t&&kt("octal",t,gt());const[r,[e,s]]=d(un(t=>t>="0"&&t<="7")(n));return s.status===sn?r:Z(e,m(t,en.octal))}),bn=t=>V(n=>{null!=t&&kt("letter",t,gt());const[r,[e,s]]=d(un(t=>t>="a"&&t<="z"||t>="A"&&t<="Z")(n));return s.status===sn?r:Z(e,m(t,en.letter))}),vn=t=>V(n=>{null!=t&&kt("alpha",t,gt());const[r,[e,s]]=d(un(t=>t>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9")(n));return s.status===sn?r:Z(e,m(t,en.alpha))}),wn=t=>V(n=>{null!=t&&kt("upper",t,gt());const[r,[e,s]]=d(un(t=>t>="A"&&t<="Z")(n));return s.status===sn?r:Z(e,m(t,en.upper))}),mn=t=>V(n=>{null!=t&&kt("lower",t,gt());const[r,[e,s]]=d(un(t=>t>="a"&&t<="z")(n));return s.status===sn?r:Z(e,m(t,en.lower))}),$n=t=>V(n=>(kt("fail",t),Z(n,O(t)))),kn=t=>V(n=>(kt("fatal",t),X(n,O(t)))),Un=t=>V(n=>W(n,t)),{Ok:Bn}=q,Ln=/^\p{Alphabetic}/u,En=/^(?:\p{Alphabetic}|\p{N})/u,An=/^(?:\p{Uppercase}|\p{Lt})/u,On=/^\p{Lowercase}/u,jn=/^(?:\r\n|[\r\n\t ])/,Mn=/^(?:\r\n|\p{White_Space})/u,In=/^[\r\n\t ]*/,Rn=/^\p{White_Space}*/u,Fn=/^[\r\n\t ]+/,Sn=/^\p{White_Space}+/u,_n=/^(?:\r\n|\r|\n)/,Nn=/^(?:\r\n|[\r\n\u0085\u2028\u2029])/u,Tn=t=>V(n=>{const{index:r,view:e}=n,s=o(r,e.byteLength-r,e).match(t);return s?W(n,s[0],r+a(s[0]).byteLength):Z(n)}),Cn=(t,n)=>V(r=>{const e=null!=n;!function(t,n,r=it){"string"!=typeof n&&"[object RegExp]"!==Object.prototype.toString.call(n)&&vt(t,n,r)}("regex",t,((t=1,n=!1)=>ft("a string or a regular expression",t,n))(1,e)),e&&kt("regex",n,gt(2,!0));let s="string"==typeof t?new RegExp(t):t;const{source:u,flags:o}=s;if("^"!==u[0]){s=new RegExp("^"+u,o)}const[a,[i,c]]=d(Tn(s)(r));return c.status===Bn?a:Z(i,m(n,en.regex(s)))}),Pn=t=>V(n=>{null!=t&&kt("letterU",t,gt());const[r,[e,s]]=d(Tn(Ln)(n));return s.status===Bn?r:Z(e,m(t,en.letterU))}),zn=t=>V(n=>{null!=t&&kt("alphaU",t,gt());const[r,[e,s]]=d(Tn(En)(n));return s.status===Bn?r:Z(e,m(t,en.alphaU))}),Gn=t=>V(n=>{null!=t&&kt("upperU",t,gt());const[r,[e,s]]=d(Tn(An)(n));return s.status===Bn?r:Z(e,m(t,en.upperU))}),qn=t=>V(n=>{null!=t&&kt("lowerU",t,gt());const[r,[e,s]]=d(Tn(On)(n));return s.status===Bn?r:Z(e,m(t,en.lowerU))}),Dn=t=>V(n=>{null!=t&&kt("space",t,gt());const[r,[e,s]]=d(Tn(jn)(n));return s.status===Bn?r:Z(e,m(t,en.space))}),Vn=t=>V(n=>{null!=t&&kt("spaceU",t,gt());const[r,[e,s]]=d(Tn(Mn)(n));return s.status===Bn?r:Z(e,m(t,en.spaceU))}),Wn=()=>V(t=>{const[n,r]=Tn(In)(t);return W(n,null)}),Zn=()=>V(t=>{const[n,r]=Tn(Rn)(t);return W(n,null)}),Xn=t=>V(n=>{null!=t&&kt("spaces1",t,gt());const[r,e]=Tn(Fn)(n);return e.status===Bn?W(r,null):Z(r,m(t,en.spaces1))}),Jn=t=>V(n=>{null!=t&&kt("spaces1U",t,gt());const[r,e]=Tn(Sn)(n);return e.status===Bn?W(r,null):Z(r,m(t,en.spaces1U))}),Hn=t=>V(n=>{null!=t&&kt("newline",t,gt());const[r,[e,s]]=d(Tn(_n)(n));return s.status===Bn?r:Z(e,m(t,en.newline))}),Kn=t=>V(n=>{null!=t&&kt("newlineU",t,gt());const[r,[e,s]]=d(Tn(Nn)(n));return s.status===Bn?r:Z(e,m(t,en.newlineU))}),{Ok:Qn}=q,Yn=(t,n)=>V(r=>{if(t<1)return W(r,"");const{index:e,view:s}=r;if(e>=s.byteLength)return Z(r);const{width:a,next:l}=function(t,n,r){const e=n.byteLength;let s=0;for(const o of u(r)){const r=t+s;if(r>=e)break;s+=c(r,n)}return t+s>=e&&(s=e-t),{width:s,next:o(t,s,n)}}(e,s,t);return i(l)===t&&n(l)?W(r,l,e+a):Z(r)}),tr=(t,n)=>V(r=>{const e=null!=n;kt("str",t,gt(1,e)),e&&kt("str",n,gt(2,!0));const[s,[u,o]]=d(Yn(i(t),n=>t===n)(r));return o.status===Qn?s:Z(u,m(n,en.str(t)))}),nr=(t,n)=>V(r=>{const e=null!=n;kt("strI",t,gt(1,e)),e&&kt("strI",n,gt(2,!0));const[s,[u,o]]=d(Yn(i(t),n=>t.toLowerCase()===n.toLowerCase())(r));return o.status===Qn?s:Z(u,m(n,en.strI(t)))}),rr=()=>V(t=>{const{index:n,view:r}=t,e=r.byteLength-n;return W(t,o(n,e,r),n+e)}),er=(t,n)=>V(r=>{const e=null!=n;Lt("anystr",t,yt(1,e)),e&&kt("anystr",n,gt(2,!0));const[s,[u,o]]=d(Yn(t,()=>!0)(r));return o.status===Qn?s:Z(u,m(n,en.anystr(t)))}),{Ok:sr,Fail:ur,Fatal:or}=q,ar=(...t)=>{const n=t.slice(),r="string"==typeof t[t.length-1]?n.pop():null;return V(t=>{const e=null!=r;n.forEach((t,n)=>Et("alt",t,xt(n+1,!0)));let s=e?E(r):[];for(const r of n){const[n,[u,o]]=d(r(t));if(o.status===sr)return n;if(e||(s=R(s,o.errors)),o.status===or)return X(u,s)}return Z(t,s)})},ir=(t,n)=>V(r=>{const e=null!=n;Et("opt",t,xt(1,e)),e&&kt("opt",n,gt(2,!0));const[s,[u,o]]=d(t(r));if(o.status===sr)return s;const a=e?E(n):o.errors;if(o.status===or)return X(u,a);const i=W(u,null);return i[1].errors=a,i}),cr=(t,n,r)=>V(e=>{const s=null!=r;Et("def",t,xt(1,!0)),s&&kt("def",r,gt(3,!0));const[u,[o,a]]=d(t(e));return a.status===sr?u:a.status===ur?W(o,n):X(o,m(r,a.errors))}),lr=(t,n)=>V(r=>{const e=null!=n;Et("peek",t,xt(1,e)),e&&kt("peek",n,gt(2,!0));const s=r.index,[u,o]=t(r);return o.status===sr?W(u,o.value,s):o.status===ur?Z(u,m(n,o.errors),s):Z(u,$(n,u,o.errors),s)}),fr=(t,n)=>V(r=>{const e=null!=n;Et("empty",t,xt(1,e)),e&&kt("empty",n,gt(2,!0));const s=r.index,[u,o]=t(r);if(o.status===sr&&u.index===s)return W(u,null);return w(o.status===or)(u,m(n,o.errors))}),dr=(t,n)=>V(r=>{const e=null!=n;Et("not",t,xt(1,e)),e&&kt("not",n,gt(2,!0));const s=r.index,[u,o]=t(r);return o.status===sr?Z(u,m(n,void 0),s):W(u,null,s)}),{Ok:pr,Fail:hr,Fatal:yr}=q,xr=(t,n)=>V(r=>{const e=null!=n;Et("attempt",t,xt(1,e)),e&&kt("attempt",n,gt(2,!0));const s=r.index,[u,[o,a]]=d(t(r));if(a.status===pr)return u;if(a.status===yr||o.index!==s)return Z(o,$(n,o,a.errors),s);if(e){if(1===a.errors.length&&a.errors[0].type===L.Nested){const{ctx:t,errors:r}=a.errors[0];return Z(o,I(n,t,r),s)}return Z(o,E(n),s)}return Z(o,a.errors,s)}),gr=(...t)=>{const n=t.slice(),r="string"==typeof n[n.length-1]?n.pop():null;return V(e=>{n.forEach((n,r)=>Et("seqB",n,xt(r+1,t.length>1)));const s=[],u=e.index;let o=e,a=[];for(const t of n){var i;const[n,e]=t(o);if(o=n,a=(null===(i=e.errors)||void 0===i?void 0:i.length)?R(a,e.errors):[],e.status===yr)return X(n,m(r,e.errors));if(e.status===hr){return Z(n,k(n.index!==u,r,n,a),u)}s.push(e.value)}return W(o,s)})},br=(t,n,r)=>V(e=>{const s=null!=r;Et("chainB",t,xt(1,!0)),mt("chainB",n,pt(2,!0)),s&&kt("chainB",r,gt(3,!0));const u=e.index,[o,a]=t(e);if(a.status!==pr){return w(a.status===yr)(o,m(r,a.errors))}const i=n(a.value);Et("chainB",i,nt("second argument to return a parser"));const[c,[l,f]]=d(i(o));if(f.status===pr)return c;const p=R(a.errors,f.errors);if(f.status===yr)return X(l,m(r,p));return Z(l,k(l.index!==u,r,l,p),u)}),vr=(t,n,r)=>V(e=>{const s=null!=r;Et("applyB",t,xt(1,!0)),Et("applyB",n,xt(2,!0)),s&&kt("applyB",r,gt(3,!0));const u=e.index,[o,a]=t(e);if(a.status!==pr){return w(a.status===yr)(o,m(r,a.errors))}const[i,c]=n(o),l=R(a.errors,c.errors);if(c.status===yr)return X(i,m(r,l));if(c.status===hr){return Z(i,k(i.index!==u,r,i,l),u)}const f=c.value;return mt("applyB",f,nt("second argument to return a function")),W(i,f(a.value))}),wr=(t,n,r)=>V(e=>{const s=null!=r;Et("leftB",t,xt(1,!0)),Et("leftB",n,xt(2,!0)),s&&kt("leftB",r,gt(3,!0));const u=e.index,[o,a]=t(e);if(a.status!==pr){return w(a.status===yr)(o,m(r,a.errors))}const[i,c]=n(o);if(c.status===pr)return W(i,a.value);const l=R(a.errors,c.errors);if(c.status===yr)return X(i,m(r,l));return Z(i,k(i.index!==u,r,i,l),u)}),mr=(t,n,r)=>V(e=>{const s=null!=r;Et("rightB",t,xt(1,!0)),Et("rightB",n,xt(2,!0)),s&&kt("rightB",r,gt(3,!0));const u=e.index,[o,a]=t(e);if(a.status!==pr){return w(a.status===yr)(o,m(r,a.errors))}const[i,[c,l]]=d(n(o));if(l.status===pr)return i;const f=R(a.errors,l.errors);if(l.status===yr)return X(c,m(r,f));return Z(c,k(c.index!==u,r,c,f),u)}),$r=(t,n,r)=>V(e=>{const s=null!=r;Et("repeatB",t,xt(1,!0)),Lt("repeatB",n,yt(2,!0)),s&&kt("repeatB",r,gt(3,!0));const o=e.index,a=[];let i=e;for(const e of u(n)){const[n,e]=t(i);if(i=n,e.status===yr)return X(n,m(r,e.errors));if(e.status===hr){return Z(n,k(n.index!==o,r,n,e.errors),o)}a.push(e.value)}return W(i,a)}),kr=(t,n,r)=>V(e=>{const s=null!=r;Et("untilB",t,xt(1,!0)),Et("untilB",n,xt(2,!0)),s&&kt("untilB",r,gt(3,!0));const u=e.index,o=[];let a=e;for(;;){const[e,s]=n(a);if(a=e,s.status===yr)return X(e,m(r,s.errors));if(s.status===pr)break;const[i,c]=t(a);if(a=i,c.status===yr)return X(i,m(r,c.errors));if(c.status===hr){return Z(i,k(i.index!==u,r,i,R(c.errors,s.errors)),u)}o.push(c.value)}return W(a,o)}),Ur=(t,n)=>V(r=>{const e=null!=n;$t("blockB",t,ht(1,e)),e&&kt("blockB",n,gt(2,!0));const s=t(),u=r.index;let o,a=[],i=r,c=0;for(;;){var l;const{value:t,done:r}=s.next(o);if(r)return W(i,t);Et("blockB",t,t=>`expected ${b(c+1)} yield to be to a parser; found ${v(t)}`);const[e,f]=t(i);if(i=e,a=(null===(l=f.errors)||void 0===l?void 0:l.length)?R(a,f.errors):[],f.status===yr)return X(e,m(n,a));if(f.status===hr){return Z(e,k(e.index!==u,n,e,a),u)}o=f.value,c++}}),Br=(...t)=>{const n=t.slice(),r="string"==typeof n[n.length-1]?n.pop():null,e=n.pop();return V(t=>{n.forEach((t,n)=>Et("pipeB",t,xt(n+1,!0))),mt("pipeB",e,pt(n.length+1,!0));const s=t.index,u=[];let o=t,a=[];for(const t of n){var i;const[n,e]=t(o);if(o=n,a=(null===(i=e.errors)||void 0===i?void 0:i.length)?R(a,e.errors):[],e.status===yr)return X(n,m(r,a));if(e.status===hr){return Z(n,k(n.index!==s,r,n,a),s)}u.push(e.value)}return W(o,e(...u))})},Lr=(t,n,r,e)=>V(s=>{var u;const o=null!=e;Et("betweenB",t,xt(1,!0)),Et("betweenB",n,xt(2,!0)),Et("betweenB",r,xt(3,!0)),o&&kt("betweenB",e,gt(4,!0));const a=s.index,[i,c]=t(s);if(c.status!==pr){return w(c.status===yr)(i,m(e,c.errors))}const[l,f]=r(i),d=(null===(u=f.errors)||void 0===u?void 0:u.length)?R(c.errors,f.errors):[];if(f.status===yr)return X(l,m(e,d));if(f.status===hr){return Z(l,k(l.index!==a,e,l,d),a)}const[p,h]=n(l);if(h.status===yr)return X(p,m(e,R(d,h.errors)));if(h.status===hr){return Z(p,k(p.index!==a,e,p,R(d,h.errors)),a)}return W(p,f.value)}),{Ok:Er,Fatal:Ar}=q,Or=(t,n)=>V(r=>{const e=null!=n;Et("join",t,xt(1,e)),e&&kt("join",n,gt(2,!0));const[s,u]=t(r);if(u.status!==Er){return w(u.status===Ar)(s,e?E(n):u.errors)}const o=u.value;return Ut("join",o,nt("argument to return an array")),W(s,o.join(""))}),jr=(t,n)=>V(r=>{const e=null!=n;Et("compact",t,xt(1,e)),e&&kt("compact",n,gt(2,!0));const[s,u]=t(r);if(u.status!==Er){return w(u.status===Ar)(s,e?E(n):u.errors)}const o=u.value;return Ut("compact",o,nt("argument to return an array")),W(s,o.filter(t=>null!=t))}),Mr=(t,n,r)=>V(e=>{const s=null!=r;Et("value",t,xt(1,!0)),s&&kt("value",r,gt(3,!0));const[u,o]=t(e);if(o.status!==Er){return w(o.status===Ar)(u,s?E(r):o.errors)}return W(u,n)}),Ir=(t,n,r)=>V(e=>{const s=null!=r;Et("nth",t,xt(1,!0)),Lt("nth",n,yt(2,!0)),s&&kt("nth",r,gt(3,!0));const[u,o]=t(e);if(o.status!==Er){return w(o.status===Ar)(u,s?E(r):o.errors)}const a=o.value;return Ut("nth",a,nt("first argument to return an array")),W(u,a[n])}),Rr=(t,n)=>V(r=>{const e=null!=n;Et("first",t,xt(1,e)),e&&kt("first",n,gt(2,!0));const[s,u]=t(r);if(u.status!==Er){return w(u.status===Ar)(s,e?E(n):u.errors)}const o=u.value;return Ut("first",o,nt("argument to return an array")),W(s,o[0])}),Fr=(t,n)=>V(r=>{const e=null!=n;Et("second",t,xt(1,e)),e&&kt("second",n,gt(2,!0));const[s,u]=t(r);if(u.status!==Er){return w(u.status===Ar)(s,e?E(n):u.errors)}const o=u.value;return Ut("second",o,nt("argument to return an array")),W(s,o[1])}),Sr=(t,n)=>V(r=>{const e=null!=n;Et("third",t,xt(1,e)),e&&kt("third",n,gt(2,!0));const[s,u]=t(r);if(u.status!==Er){return w(u.status===Ar)(s,e?E(n):u.errors)}const o=u.value;return Ut("third",o,nt("argument to return an array")),W(s,o[2])}),_r=(t,n)=>V(r=>{const e=null!=n;Et("fourth",t,xt(1,e)),e&&kt("fourth",n,gt(2,!0));const[s,u]=t(r);if(u.status!==Er){return w(u.status===Ar)(s,e?E(n):u.errors)}const o=u.value;return Ut("fourth",o,nt("argument to return an array")),W(s,o[3])}),Nr=(t,n)=>V(r=>{const e=null!=n;Et("fifth",t,xt(1,e)),e&&kt("fifth",n,gt(2,!0));const[s,u]=t(r);if(u.status!==Er){return w(u.status===Ar)(s,e?E(n):u.errors)}const o=u.value;return Ut("fifth",o,nt("argument to return an array")),W(s,o[4])}),Tr=(t,n,r)=>V(e=>{const s=null!=r;Et("map",t,xt(1,!0)),mt("map",n,pt(2,!0)),s&&kt("map",r,gt(3,!0));const[u,o]=t(e);if(o.status!==Er){return w(o.status===Ar)(u,s?E(r):o.errors)}return W(u,n(o.value))}),Cr=(t,n,r)=>V(e=>{const s=null!=r;Et("apply",t,xt(1,!0)),Et("apply",n,xt(2,!0)),s&&kt("apply",r,gt(3,!0));const u=e.index,o=E(r),[a,i]=t(e);if(i.status!==Er){return w(i.status===Ar)(a,s?o:i.errors)}const[c,l]=n(a);if(l.status!==Er){return w(l.status===Ar||c.index!==u)(c,s?o:R(i.errors,l.errors))}const f=l.value;return mt("apply",f,nt("second argument to return a function")),W(c,f(i.value))}),Pr=(t,n,r)=>V(e=>{const s=null!=r;Et("chain",t,xt(1,!0)),mt("chain",n,pt(2,!0)),s&&kt("chain",r,gt(3,!0));const u=e.index,o=E(r),[a,i]=t(e);if(i.status!==Er){return w(i.status===Ar)(a,s?o:i.errors)}const c=n(i.value);Et("chain",c,nt("second argument to return a parser"));const[l,[f,p]]=d(c(a));if(p.status!==Er){return w(p.status===Ar||f.index!==u)(f,s?o:R(i.errors,p.errors))}return l}),{Ok:zr,Fail:Gr,Fatal:qr}=q;function Dr(t){return`[${t}]: infinite loop detected; neither content nor separator parser consumed input`}const Vr=(...t)=>{const n=t.slice(),r="string"==typeof t[t.length-1]?n.pop():null;return V(t=>{const e=null!=r;n.forEach((t,n)=>Et("seq",t,xt(n+1,!0)));const s=[],u=t.index;let o=e?E(r):[],a=t;for(const t of n){var i;const[n,r]=t(a);if(a=n,e||(o=(null===(i=r.errors)||void 0===i?void 0:i.length)?R(o,r.errors):[]),r.status!==zr){return w(r.status===qr||a.index!==u)(a,o)}s.push(r.value)}return W(a,s)})},Wr=(t,n,r)=>V(e=>{const s=null!=r;Et("left",t,xt(1,!0)),Et("left",n,xt(2,!0)),s&&kt("left",r,gt(3,!0));const u=e.index,o=E(r),[a,i]=t(e);if(i.status!==q.Ok){return(i.status===qr?X:Z)(a,s?o:i.errors)}const[c,l]=n(a);if(l.status!==zr){return w(l.status===qr||c.index!==u)(c,s?o:R(i.errors,l.errors))}return W(c,i.value)}),Zr=(t,n,r)=>V(e=>{const s=null!=r;Et("right",t,xt(1,!0)),Et("right",n,xt(2,!0)),s&&kt("right",r,gt(3,!0));const u=e.index,o=E(r),[a,i]=t(e);if(i.status!==q.Ok){return w(i.status===qr)(a,s?o:i.errors)}const[c,[l,f]]=d(n(a));if(f.status!==zr){return w(l.status===qr||l.index!==u)(l,s?o:R(i.errors,f.errors))}return c}),Xr=(t,n)=>V(r=>{const e=null!=n;$t("block",t,ht(1,e)),e&&kt("block",n,gt(2,!0));const s=t(),u=r.index;let o,a=e?E(n):[],i=r,c=0;for(;;){var l;const{value:t,done:n}=s.next(o);if(n)return W(i,t);Et("block",t,t=>`expected ${b(c+1)} yield to be to a parser; found ${v(t)}`);const[r,f]=t(i);if(i=r,e||(a=(null===(l=f.errors)||void 0===l?void 0:l.length)?R(a,f.errors):[]),f.status!==zr){return w(f.status===qr||r.index!==u)(r,a)}o=f.value,c++}}),Jr=(t,n)=>V(r=>{const e=null!=n;Et("many",t,xt(1,e)),e&&kt("many",n,gt(2,!0));const s=[];let u=r;for(;;){const[r,o]=t(u);if(u=r,o.status===qr)return X(r,e?E(n):o.errors);if(o.status===Gr)break;if(s.push(o.value),u.index>=u.view.byteLength)break}return W(u,s)}),Hr=(t,n)=>V(r=>{const e=null!=n;Et("many1",t,xt(1,e)),e&&kt("many1",n,gt(2,!0));const s=E(n),[u,o]=t(r);if(o.status!==zr){return w(o.status===qr)(u,e?s:o.errors)}let a=u;const i=[o.value];for(;;){const[n,r]=t(a);if(a=n,r.status===qr)return X(n,e?s:r.errors);if(r.status===Gr)break;if(i.push(r.value),a.index>=a.view.byteLength)break}return W(a,i)}),Kr=(t,n)=>V(r=>{const e=null!=n;Et("skip",t,xt(1,e)),e&&kt("skip",n,gt(2,!0));const[s,u]=t(r);if(u.status!==zr){return w(u.status===qr)(s,e?E(n):u.errors)}return W(s,null)}),Qr=(t,n,r)=>V(e=>{const s=null!=r;Et("sepby",t,xt(1,!0)),Et("sepby",n,xt(2,!0)),s&&kt("sepby",r,gt(3,!0));let u=e.index;const o=E(r),[a,i]=t(e);if(i.status===qr)return X(a,s?o:i.errors);if(i.status===Gr)return W(a,[]);const c=[i.value];let l=a;for(;;){u=l.index;const[r,e]=n(l);if(l=r,e.status===qr)return X(r,s?o:e.errors);if(e.status===Gr)break;const[a,i]=t(l);if(l=a,i.status===qr)return X(a,s?o:i.errors);if(i.status===Gr)break;if(l.index===u)throw new TypeError(Dr("sepby"));c.push(i.value)}return W(l,c,u)}),Yr=(t,n,r)=>V(e=>{const s=null!=r;Et("sepby1",t,xt(1,!0)),Et("sepby1",n,xt(2,!0)),s&&kt("sepby1",r,gt(3,!0));let u=e.index;const o=E(r),[a,i]=t(e);if(i.status!==zr){return w(i.status===qr)(a,s?o:i.errors)}const c=[i.value];let l=a;for(;;){u=l.index;const[r,e]=n(l);if(l=r,e.status===qr)return X(r,s?o:e.errors);if(e.status===Gr)break;const[a,i]=t(l);if(l=a,i.status===qr)return X(a,s?o:i.errors);if(i.status===Gr)break;if(l.index===u)throw new TypeError(Dr("sepby1"));c.push(i.value)}return W(l,c,u)}),te=(t,n,r)=>V(e=>{const s=null!=r;Et("endby",t,xt(1,!0)),Et("endby",n,xt(2,!0)),s&&kt("endby",r,gt(3,!0));let u=e.index;const o=E(r),[a,i]=t(e);if(i.status===qr)return X(a,s?o:i.errors);if(i.status===Gr)return W(a,[]);const c=[i.value];let l=a;for(;;){u=l.index;const[r,e]=n(l);if(l=r,e.status===qr)return X(r,s?o:e.errors);if(e.status===Gr)break;const[a,i]=t(l);if(l=a,i.status===qr)return X(a,s?o:i.errors);if(i.status===Gr)break;if(l.index===u)throw new TypeError(Dr("endby"));c.push(i.value)}const[f,d]=n({...l,index:u});return d.status===qr?X(f,s?o:d.errors):W(f,c)}),ne=(t,n,r)=>V(e=>{const s=null!=r;Et("endby1",t,xt(1,!0)),Et("endby1",n,xt(2,!0)),s&&kt("endby1",r,gt(3,!0));let u=e.index;const o=E(r),[a,i]=t(e);if(i.status!==zr){return w(i.status===qr)(a,s?o:i.errors)}const c=[i.value];let l=a;for(;;){u=l.index;const[r,e]=n(l);if(l=r,e.status===qr)return X(r,s?o:e.errors);if(e.status===Gr)break;const[a,i]=t(l);if(l=a,i.status===qr)return X(a,s?o:i.errors);if(i.status===Gr)break;if(l.index===u)throw new TypeError(Dr("endby1"));c.push(i.value)}const[f,d]=n({...l,index:u});return d.status===qr?X(f,s?o:d.errors):W(f,c)}),re=(t,n,r)=>V(e=>{const s=null!=r;Et("repeat",t,xt(1,!0)),Lt("repeat",n,yt(2,!0)),s&&kt("repeat",r,gt(3,!0));const o=e.index,a=[];let i=e;for(const e of u(n)){const[n,e]=t(i);if(i=n,e.status!==zr){return w(e.status===qr||n.index!==o)(n,s?E(r):e.errors)}a.push(e.value)}return W(i,a)}),ee=(t,n,r,e)=>V(s=>{var u;const o=null!=e;Et("between",t,xt(1,!0)),Et("between",n,xt(2,!0)),Et("between",r,xt(3,!0)),o&&kt("between",e,gt(4,!0));const a=s.index,[i,c]=t(s);if(c.status!==zr){return w(c.status===qr)(i,o?E(e):c.errors)}const[l,f]=r(i),d=o?E(e):(null===(u=f.errors)||void 0===u?void 0:u.length)?R(c.errors,f.errors):[];if(f.status!==zr){return w(f.status===qr||l.index!==a)(l,d)}const[p,h]=n(l);if(h.status!==zr){return w(h.status===qr||p.index!==a)(p,o?d:R(d,h.errors))}return W(p,f.value)}),se=(t,n,r)=>V(e=>{const s=null!=r;Et("until",t,xt(1,!0)),Et("until",n,xt(2,!0)),s&&kt("until",r,gt(3,!0));const u=e.index,o=[];let a=e;const i=E(r);for(;;){const[r,e]=n(a);if(a=r,e.status===qr)return X(r,s?i:e.errors);if(e.status===zr)break;const[c,l]=t(a);if(a=c,l.status===qr)return X(c,s?i:l.errors);if(l.status===Gr){return w(c.index!==u)(c,s?i:R(l.errors,e.errors))}o.push(l.value)}return W(a,o)}),ue=(...t)=>{const n=t.slice(),r="string"==typeof t[t.length-1]?n.pop():null,e=n.pop();return V(t=>{const s=null!=r;n.forEach((t,n)=>Et("pipe",t,xt(n+1,!0))),mt("pipe",e,pt(n.length+1,!0));const u=t.index,o=[];let a=t,i=s?E(r):[];for(const t of n){var c;const[n,r]=t(a);if(a=n,s||(i=(null===(c=r.errors)||void 0===c?void 0:c.length)?R(i,r.errors):[]),r.status!==zr){return w(r.status===qr||n.index!==u)(n,i)}o.push(r.value)}return W(a,e(...o))})};function oe(t){return n=>`expected ${t} op parser to return a function; found ${v(n)}`}const ae=(t,n,r,e)=>V(s=>{const o=null!=e;Et("assocL",t,xt(1,!0)),Et("assocL",n,xt(2,!0)),o&&kt("assocL",e,gt(4,!0));const a=E(e),[i,c]=t(s);if(c.status===qr)return X(i,o?a:c.errors);if(c.status===Gr)return W(i,r);const l=[c.value],f=[];let d=i,p=d.index,h=0;for(;;){const[r,e]=n(d);if(d=r,e.status===qr)return X(r,o?a:e.errors);if(e.status===Gr)break;const[s,u]=t(d);if(d=s,u.status===qr)return X(s,o?a:u.errors);if(u.status===Gr)break;mt("assocL",e.value,oe(b(h+1))),f.push(e.value),l.push(u.value),p=d.index,h++}let y=l[0];for(const t of u(f.length))y=f[t](y,l[t+1]);return W(d,y,p)}),ie=(t,n,r)=>V(e=>{const s=null!=r;Et("assoc1L",t,xt(1,!0)),Et("assoc1L",n,xt(2,!0)),s&&kt("assoc1L",r,gt(3,!0));const o=E(r),[a,i]=t(e);if(i.status!==zr){return w(i.status===qr)(a,s?o:i.errors)}const c=[i.value],l=[];let f=a,d=f.index,p=0;for(;;){const[r,e]=n(f);if(f=r,e.status===qr)return X(r,s?o:e.errors);if(e.status===Gr)break;const[u,a]=t(f);if(f=u,a.status===qr)return X(u,s?o:a.errors);if(a.status===Gr)break;mt("assoc1L",e.value,oe(b(p+1))),l.push(e.value),c.push(a.value),d=f.index,p++}let h=c[0];for(const t of u(l.length))h=l[t](h,c[t+1]);return W(f,h,d)}),ce=(t,n,r,e)=>V(s=>{const o=null!=e;Et("assocR",t,xt(1,!0)),Et("assocR",n,xt(2,!0)),o&&kt("assocR",e,gt(4,!0));const a=E(e),[i,c]=t(s);if(c.status===qr)return X(i,o?a:c.errors);if(c.status===Gr)return W(i,r);const l=[c.value],f=[];let d=i,p=d.index,h=0;for(;;){const[r,e]=n(d);if(d=r,e.status===qr)return X(r,o?a:e.errors);if(e.status===Gr)break;const[s,u]=t(d);if(d=s,u.status===qr)return X(s,o?a:u.errors);if(u.status===Gr)break;mt("assocR",e.value,oe(b(h+1))),f.push(e.value),l.push(u.value),p=d.index,h++}let y=l[l.length-1];for(const t of u(f.length-1,-1))y=f[t](l[t],y);return W(d,y,p)}),le=(t,n,r)=>V(e=>{const s=null!=r;Et("assoc1R",t,xt(1,!0)),Et("assoc1R",n,xt(2,!0)),s&&kt("assoc1R",r,gt(3,!0));const o=E(r),[a,i]=t(e);if(i.status!==zr){return w(i.status===qr)(a,s?o:i.errors)}const c=[i.value],l=[];let f=a,d=f.index,p=0;for(;;){const[r,e]=n(f);if(f=r,e.status===qr)return X(r,s?o:e.errors);if(e.status===Gr)break;const[u,a]=t(f);if(f=u,a.status===qr)return X(u,s?o:a.errors);if(a.status===Gr)break;mt("assoc1R",e.value,oe(b(p+1))),l.push(e.value),c.push(a.value),d=f.index,p++}let h=c[c.length-1];for(const t of u(l.length-1,-1))h=l[t](c[t],h);return W(f,h,d)})}])}));