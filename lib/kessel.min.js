/*!
 * Copyright (c) 2020 Thomas Otterson
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * 
 */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.kessel=n():t.kessel=n()}(this,(function(){return function(t){var n={};function r(e){if(n[e])return n[e].exports;var s=n[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var s in t)r.d(e,s,function(n){return t[n]}.bind(null,s));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=0)}([function(t,n,r){"use strict";r.r(n),r.d(n,"alpha",(function(){return kn})),r.d(n,"any",(function(){return yn})),r.d(n,"anyOf",(function(){return xn})),r.d(n,"char",(function(){return fn})),r.d(n,"charI",(function(){return ln})),r.d(n,"digit",(function(){return bn})),r.d(n,"eof",(function(){return gn})),r.d(n,"hex",(function(){return wn})),r.d(n,"letter",(function(){return $n})),r.d(n,"lower",(function(){return Bn})),r.d(n,"noneOf",(function(){return vn})),r.d(n,"octal",(function(){return mn})),r.d(n,"range",(function(){return hn})),r.d(n,"satisfy",(function(){return dn})),r.d(n,"satisfyM",(function(){return pn})),r.d(n,"upper",(function(){return Un})),r.d(n,"always",(function(){return En})),r.d(n,"failNormally",(function(){return Ln})),r.d(n,"failFatally",(function(){return On})),r.d(n,"alphaU",(function(){return Vn})),r.d(n,"letterU",(function(){return Dn})),r.d(n,"lowerU",(function(){return Zn})),r.d(n,"newline",(function(){return tr})),r.d(n,"newlineU",(function(){return nr})),r.d(n,"regex",(function(){return qn})),r.d(n,"space",(function(){return Xn})),r.d(n,"spaceU",(function(){return Jn})),r.d(n,"spaces",(function(){return Hn})),r.d(n,"spaces1",(function(){return Qn})),r.d(n,"spaces1U",(function(){return Yn})),r.d(n,"spacesU",(function(){return Kn})),r.d(n,"upperU",(function(){return Wn})),r.d(n,"all",(function(){return or})),r.d(n,"anyString",(function(){return ir})),r.d(n,"string",(function(){return sr})),r.d(n,"stringI",(function(){return ur})),r.d(n,"alt",(function(){return lr})),r.d(n,"def",(function(){return pr})),r.d(n,"empty",(function(){return yr})),r.d(n,"not",(function(){return gr})),r.d(n,"opt",(function(){return dr})),r.d(n,"peek",(function(){return hr})),r.d(n,"applyB",(function(){return kr})),r.d(n,"attempt",(function(){return wr})),r.d(n,"betweenB",(function(){return Ar})),r.d(n,"blockB",(function(){return Er})),r.d(n,"chainB",(function(){return $r})),r.d(n,"leftB",(function(){return Ur})),r.d(n,"manyTillB",(function(){return Or})),r.d(n,"pipeB",(function(){return Mr})),r.d(n,"repeatB",(function(){return Lr})),r.d(n,"rightB",(function(){return Br})),r.d(n,"seqB",(function(){return mr})),r.d(n,"apply",(function(){return qr})),r.d(n,"chain",(function(){return Dr})),r.d(n,"compact",(function(){return Rr})),r.d(n,"fifth",(function(){return zr})),r.d(n,"first",(function(){return Tr})),r.d(n,"fourth",(function(){return Pr})),r.d(n,"join",(function(){return Fr})),r.d(n,"map",(function(){return Gr})),r.d(n,"nth",(function(){return Nr})),r.d(n,"second",(function(){return _r})),r.d(n,"third",(function(){return Cr})),r.d(n,"value",(function(){return Ir})),r.d(n,"assoc1L",(function(){return he})),r.d(n,"assoc1R",(function(){return ge})),r.d(n,"assocL",(function(){return pe})),r.d(n,"assocR",(function(){return ye})),r.d(n,"between",(function(){return ce})),r.d(n,"block",(function(){return Qr})),r.d(n,"end",(function(){return oe})),r.d(n,"left",(function(){return Hr})),r.d(n,"many",(function(){return Yr})),r.d(n,"many1",(function(){return te})),r.d(n,"pipe",(function(){return le})),r.d(n,"repeat",(function(){return ae})),r.d(n,"right",(function(){return Kr})),r.d(n,"sep",(function(){return se})),r.d(n,"sep1",(function(){return ue})),r.d(n,"sepEndBy1",(function(){return ie})),r.d(n,"seq",(function(){return Jr})),r.d(n,"skip",(function(){return ne})),r.d(n,"skipMany",(function(){return re})),r.d(n,"skipMany1",(function(){return ee})),r.d(n,"until",(function(){return fe})),r.d(n,"Status",(function(){return D})),r.d(n,"failReply",(function(){return X})),r.d(n,"failure",(function(){return tt})),r.d(n,"fatalReply",(function(){return J})),r.d(n,"okReply",(function(){return Z})),r.d(n,"parse",(function(){return H})),r.d(n,"parser",(function(){return W})),r.d(n,"run",(function(){return nt})),r.d(n,"status",(function(){return K})),r.d(n,"succeeded",(function(){return Q})),r.d(n,"success",(function(){return Y})),r.d(n,"ErrorType",(function(){return O})),r.d(n,"compound",(function(){return F})),r.d(n,"expected",(function(){return E})),r.d(n,"formatErrors",(function(){return G})),r.d(n,"generic",(function(){return A})),r.d(n,"getPosition",(function(){return q})),r.d(n,"merge",(function(){return R})),r.d(n,"nested",(function(){return S})),r.d(n,"other",(function(){return j})),r.d(n,"unexpected",(function(){return M}));const e=new TextEncoder,s=new TextDecoder;function*u(t,n,r,e){const s="number"==typeof n?t:0,u="number"==typeof n?n:t,o="number"==typeof r?0===r?1:Math.abs(r):1,i="number"==typeof r?!!e:"number"==typeof n?!!r:!!n,a=s<u;let c=s;for(;!(a?i?c>u:c>=u:i?c<u:c<=u);)yield c,c=a?c+o:c-o}function o(t,n,r){const e=Uint8Array.from({length:n},(n,e)=>r.getUint8(t+e));return s.decode(e)}function i(t){return new DataView(e.encode(t).buffer)}function a(t){return[...t].length}function c(t,n){const r=n.getUint8(t);return(128&r)>>7==0?1:(224&r)>>5==6?2:(240&r)>>4==14?3:(240&r)>>4==15?4:1}function f(t,n){const r=c(t,n);return{width:r,next:o(t,r,n)}}function l(t){return`'${t}'`}function d(t){return[t,t]}function p(t){switch(t.length){case 0:return"";case 1:return t[0];case 2:return t.join(" or ");default:{const n=t.slice(),r=n.pop();return`${n.join(", ")}, or ${r}`}}}function h(t){var n,r;const e=["th","st","nd","rd"],s=t%100;return t+(null!==(n=null!==(r=e[(s-20)%10])&&void 0!==r?r:e[s])&&void 0!==n?n:e[0])}const y=["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],g=["zeroth","first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth","eleventh","twelfth","thirteenth","fourteenth","fifteenth","sixteenth","seventeenth","eighteenth","nineteenth"],x=["twent","thirt","fort","fift","sixt","sevent","eight","ninet"],v=["hundred","thousand","million","billion","trillion","quadrillion"];function b(t){if(t<0||t>Number.MAX_SAFE_INTEGER)throw new Error("Argument must be between 0 and "+Number.MAX_SAFE_INTEGER);const n=Math.floor(Math.log10(t));if(t<20)return g[t];if(1===n){const n=Math.floor(t/10)-2;return t%10==0?x[n]+"ieth":`${x[n]}y-${g[t%10]}`}if(2===n){const r=Math.floor(t/10**n),e=t-r*10**n;return`${y[r]} ${v[0]}${0===e?"th":" "+b(e)}`}const r=n%3+1,e=Math.floor(n/3),s=Math.floor(t/10**(n-r+1)),u=function t(n){if(n<20)return y[n];const r=n%10;if(n<100)return`${x[Math.floor(n/10)-2]}y${0===r?"":"-"+y[r]}`;const e=n-100*Math.floor(n/100);return`${y[Math.floor(n/100)]} ${v[0]}${0===e?"th":" "+t(e)}`}(s),o=t-s*10**(n-r+1);return`${u} ${v[e]}${0===o?"th":" "+b(o)}`}function w(t){return void 0===t?"undefined":"function"==typeof t?W.created(t)?"parser":"function":"symbol"==typeof t?`Symbol(${t.description})`:JSON.stringify(t)}function m(t){return t?J:X}function $(t,n){return null==t?n:E(t)}function k(t,n,r){return null==t?S(n,r):F(t,n,r)}function U(t,n,r,e){return t?k(n,r,e):$(n,e)}const B=/\t/gu,L=/(?:\p{Mn}|\p{Cf})/gu,O={Expected:"expected",Unexpected:"unexpected",Generic:"generic",Nested:"nested",Compound:"compound",Other:"other"};function E(t){return[{type:O.Expected,label:t}]}function M(t){return[{type:O.Unexpected,label:t}]}function A(t){return[{type:O.Generic,label:t}]}function j(t){return[{type:O.Other,label:t}]}function S(t,n){return 1===n.length&&n[0].type===O.Nested?n:[{type:O.Nested,ctx:t,errors:n}]}function F(t,n,r){return 1===r.length&&r[0].type===O.Nested?[{type:O.Compound,ctx:r.ctx,errors:r.errors,label:t}]:[{type:O.Compound,ctx:n,errors:r,label:t}]}function R(t=[],n=[]){return[...t,...n]}function I(t,n){const r=n.getUint8(t);if(10===r||11===r||12===r)return{newline:!0,skip:1};if(13===r){if(t<n.byteLength-1){const e=n.getUint8(t+1);if(13===r&&10===e)return{newline:!0,skip:2}}return{newline:!0,skip:1}}if(t<n.byteLength-1){const e=n.getUint8(t+1);if(194===r&&133===e)return{newline:!0,skip:2};if(t<n.byteLength-2){const s=n.getUint8(t+2);if(226===r&&128===e&&(168===s||169===s))return{newline:!0,skip:3}}}return{newline:!1,skip:c(t,n)}}function N(t,n){let r=0,e=1,s=0;for(;s<n.byteLength;){const{newline:u,skip:o}=I(s,n);if(u){if(s+o>t)return{start:r,end:s-1,lineno:e};e++,r=s+o}s+=o}return{start:r,end:n.byteLength-1,lineno:e}}function T(t,n,r){let e=0,s=r;for(;s<t&&s<n.byteLength;)s+=c(s,n),e++;return e}function _(t,n,r){const e=[];let s=B.exec(n);for(;null!==s;)e.push(s.index),s=B.exec(n);let u=0,o=0,i=n;for(const n of e){const e=n+u,s=r-e%r;e<t+o&&(o+=s-1),u+=s-1,i=i.substring(0,e)+" ".repeat(s)+i.substring(e+1)}return{line:i,colIndex:o+t}}function C(t,n){let r=t;const e=[];let s=L.exec(n);for(;null!==s;)e.push(s.index),s.index<r&&r--,s=L.exec(n);return{colno:r+1,length:a(n)-e.length}}function P(t,n,r,e){const s=" ".repeat(e);return t.map(t=>{const{index:u,view:o}=t.ctx;return(t.label?`\n${s}Could not parse ${t.label} because:\n\n`:`\n${s}The parser backtracked after:\n\n`)+z(t.errors,u,o,n,r,e+2)}).join("")}function z(t,n,r,e=8,s=72,u=0){const{start:i,end:a,lineno:c}=N(n,r),f=T(n,r,i),l=" ".repeat(u),d=o(i,a-i+1,r),{colIndex:h,line:y}=_(f,d,e),{colno:g,length:x}=C(h,y),v=`${l}Parse error at (line ${c}, column ${g}):`,b=function(t,n,r,e,s=0){const u=" ".repeat(s);if(r<=e&&n<=e)return`${u}${t}\n${u}${" ".repeat(r-1)}^`;if(r<=e-3)return`${u}${t.substring(0,e-3)}...\n${u}${" ".repeat(r-1)}^`;if(r>=n-e+3){const s=n-e+3,o=r-(n-e);return`${u}...${t.substring(s)}\n${u}${" ".repeat(o-1)}^`}const o=r-1-Math.ceil(e/2)+3,i=r-1+Math.floor(e/2)-3;return`${u}...${t.substring(o,i)}...\n${u}${" ".repeat(Math.ceil(e/2))}^`}(y,x,g,s,u),w=t.find(t=>t.type===O.Generic),m=t.find(t=>t.type===O.Unexpected),$=p(t.filter(t=>t.type===O.Expected).map(t=>t.label)),k=t.filter(t=>t.type===O.Nested),U=t.filter(t=>t.type===O.Compound),B=m?`${l}Unexpected ${m.label}\n`:"",L=$.length?`${l}Expected ${$}\n`:"",E=w?`${l}${w.label}\n`:"",M=P(k,e,s,u),A=P(U,e,s,u);return function(t,n){let r=t;for(;"\n"===r[r.length-1];)r=r.substring(0,r.length-1);return r+"\n".repeat(n)}(`${v}\n\n${b}\n${B}${L}${E}${0===t.length?l+"Unknown error(s)\n":""}${n>=r.byteLength?l+"Note: failure occurred at the end of input\n":""}${A}${M}`,2)}function G(t,n,r,e=z){const[s,u]=t,{index:o,view:i}=s;return e(u.errors,o,i,n,r)}function q(t,n=8){const{index:r,view:e}=t,{start:s,end:u,lineno:i}=N(r,e),a=T(r,e,s),c=o(s,u-s+1,e),{colIndex:f,line:l}=_(a,c,n),{colno:d,_:p}=C(f,l);return{line:i,column:d}}const D={Ok:"ok",Fail:"fail",Fatal:"fatal"};function V(t){const n="Parser input must be a string, a typed array, an array buffer, or a data view; parser input was "+typeof t;return{view:(t=>{if("string"==typeof t)return i(t);if((r=t)instanceof Uint8Array||r instanceof Uint8ClampedArray||r instanceof Uint16Array||r instanceof Uint32Array||r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array||r instanceof Float32Array||r instanceof Float64Array)return new DataView(t.buffer);var r;if(t instanceof ArrayBuffer)return new DataView(t);if(t instanceof DataView)return t;throw new Error(n)})(t),index:0}}const W=function(t,n="created"){const r=new WeakSet;return Object.defineProperty((...n)=>{const e=t(...n);return r.add(e),e},n,{value:r.has.bind(r)})}(t=>t);function Z(t,n=null,r=t.index){return[{...t,index:r},{status:D.Ok,value:n}]}function X(t,n=[],r=t.index){return[{...t,index:r},{status:D.Fail,errors:n}]}function J(t,n=[],r=t.index){return[{...t,index:r},{status:D.Fatal,errors:n}]}function H(t,n){return t(V(n))}function K(t){return t[1].status}function Q(t){return t[1].status===D.Ok}function Y(t){return Q(t)?t[1].value:null}function tt(t){return Q(t)?null:G(t)}function nt(t,n){const[r,[e,s]]=d(t(V(n)));if(s.status===D.Ok)return s.value;throw new Error(G(r))}const rt=t=>n=>`expected ${t}; found ${w(n)}`,et=rt("a one-character string"),st=rt("a function"),ut=rt("a generator function"),ot=rt("a string"),it=rt("an array"),at=rt("a string or an array of characters"),ct=rt("a string or a regular expression"),ft=rt("a number"),lt=rt("a parser"),dt=(t,n=1,r=!1)=>e=>`expected ${r?b(n)+" ":""}argument to be ${t}; found ${w(e)}`,pt=(t=1,n=!1)=>dt("a function",t,n),ht=(t=1,n=!1)=>dt("a number",t,n),yt=(t=1,n=!1)=>dt("a parser",t,n),gt=(t=1,n=!1)=>dt("a string",t,n),xt=(t,n)=>r=>`expected ${n} argument to be ${t}; found ${w(r)}`,vt=t=>xt("a one-character string",t),bt=t=>xt("a function",t),wt=t=>xt("a parser",t);function mt(t,n,r){throw new Error(`[${t}]: ${r(n)}`)}function $t(t,n,r=et){"string"==typeof n&&1===a(n)||mt(t,n,r)}function kt(t,n,r=st){("function"!=typeof n||W.created(n))&&mt(t,n,r)}function Ut(t,n,r=ut){"[object GeneratorFunction]"!==Object.prototype.toString.call(n)&&mt(t,n,r)}function Bt(t,n,r=ot){"string"!=typeof n&&mt(t,n,r)}function Lt(t,n,r=it){Array.isArray(n)||mt(t,n,r)}function Ot(t,n,r=at){Array.isArray(n)&&n.every(t=>"string"==typeof t&&1===a(t))||"string"==typeof n||mt(t,n,r)}function Et(t,n,r=ft){"number"!=typeof n&&mt(t,n,r)}function Mt(t,n,r=lt){"function"==typeof n&&W.created(n)||mt(t,n,r)}function At(t,n){for(const[r,e]of function*(t){const n=t[Symbol.iterator]();let r=n.next(),e=0;for(;!r.done;)yield[e++,r.value],r=n.next()}(n))Mt(t,e,wt(h(r+1)))}const jt="a Unicode alphanumeric character",St="any character",Ft=t=>"any of "+p(t.map(t=>`'${t}'`)),Rt=t=>`a string of ${t} characters`,It=t=>l(t),Nt=t=>l(t),Tt="a digit",_t="end of input",Ct="a hexadecimal digit",Pt="a letter",zt="a Unicode letter",Gt="a lowercase letter",qt="a Unicode lowercase letter",Dt="a newline",Vt="a Unicode newline",Wt=t=>"none of "+p(t.map(t=>`'${t}'`)),Zt="an octal digit",Xt=(t,n)=>`a character between '${t}' and '${n}'`,Jt=t=>"a string matching "+t,Ht="a whitespace character",Kt="zero or more whitespace characters",Qt="one or more whitespace characters",Yt="zero or more Unicode whitespace characters",tn="one or more Unicode whitespace characters",nn="a Unicode whitespace character",rn=t=>l(t),en=t=>l(t),sn="an uppercase letter",un="a Unicode uppercase letter",on={alpha:E("an alphanumeric character"),alphaU:E(jt),any:E(St),anyOf:t=>E(Ft(t)),anyString:t=>E(Rt(t)),char:t=>E(It(t)),charI:t=>E(Nt(t)),digit:E(Tt),eof:E(_t),hex:E(Ct),letter:E(Pt),letterU:E(zt),lower:E(Gt),lowerU:E(qt),newline:E(Dt),newlineU:E(Vt),noneOf:t=>E(Wt(t)),octal:E(Zt),range:(t,n)=>E(Xt(t,n)),regex:t=>E(Jt(t)),space:E(Ht),spaces:E(Kt),spaces1:E(Qt),spacesU:E(Yt),spaces1U:E(tn),spaceU:E(nn),string:t=>E(rn(t)),stringI:t=>E(en(t)),upper:E(sn),upperU:E(un)},{Ok:an}=D,cn=t=>W(n=>{const{index:r,view:e}=n;if(r>=e.byteLength)return X(n);const{width:s,next:u}=f(r,e);return t(u)?Z(n,u,r+s):X(n)}),fn=t=>W(n=>{$t("char",t);const[r,[e,s]]=d(cn(n=>t===n)(n));return s.status===an?r:X(e,on.char(t))}),ln=t=>W(n=>{$t("charI",t);const[r,[e,s]]=d(cn(n=>t.toLowerCase()===n.toLowerCase())(n));return s.status===an?r:X(e,on.charI(t))}),dn=t=>W(n=>(kt("satisfy",t),cn(t)(n))),pn=(t,n)=>W(r=>{kt("satisfyM",t,bt("1st")),Bt("satisfyM",n,xt("a string","2nd"));const[e,[s,u]]=d(cn(t)(r));return u.status===an?e:X(s,E(n))}),hn=(t,n)=>W(r=>{$t("range",t,vt("1st")),$t("range",n,vt("2nd"));const[e,[s,u]]=d(cn(r=>r>=t&&r<=n)(r));return u.status===an?e:X(s,on.range(t,n))}),yn=W(t=>{const{index:n,view:r}=t;if(n>=r.byteLength)return X(t,on.any);const{width:e,next:s}=f(n,r);return Z(t,s,n+e)}),gn=W(t=>{const{index:n,view:r}=t;return n>=r.byteLength?Z(t,null):X(t,on.eof)}),xn=t=>W(n=>{Ot("anyOf",t);const{index:r,view:e}=n,{width:s,next:u}=f(r,e),o=[...t];return o.includes(u)?Z(n,u,r+s):X(n,on.anyOf(o))}),vn=t=>W(n=>{Ot("noneOf",t);const{index:r,view:e}=n,{width:s,next:u}=f(r,e),o=[...t];return o.includes(u)?X(n,on.noneOf(o)):Z(n,u,r+s)}),bn=W(t=>{const[n,[r,e]]=d(cn(t=>t>="0"&&t<="9")(t));return e.status===an?n:X(r,on.digit)}),wn=W(t=>{const[n,[r,e]]=d(cn(t=>t>="0"&&t<="9"||t>="a"&&t<="f"||t>="A"&&t<="F")(t));return e.status===an?n:X(r,on.hex)}),mn=W(t=>{const[n,[r,e]]=d(cn(t=>t>="0"&&t<="7")(t));return e.status===an?n:X(r,on.octal)}),$n=W(t=>{const[n,[r,e]]=d(cn(t=>t>="a"&&t<="z"||t>="A"&&t<="Z")(t));return e.status===an?n:X(r,on.letter)}),kn=W(t=>{const[n,[r,e]]=d(cn(t=>t>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9")(t));return e.status===an?n:X(r,on.alpha)}),Un=W(t=>{const[n,[r,e]]=d(cn(t=>t>="A"&&t<="Z")(t));return e.status===an?n:X(r,on.upper)}),Bn=W(t=>{const[n,[r,e]]=d(cn(t=>t>="a"&&t<="z")(t));return e.status===an?n:X(r,on.lower)}),Ln=t=>W(n=>(Bt("failNormally",t),X(n,A(t)))),On=t=>W(n=>(Bt("failFatally",t),J(n,A(t)))),En=t=>W(n=>Z(n,t)),{Ok:Mn}=D,An=/^\p{Alphabetic}/u,jn=/^(?:\p{Alphabetic}|\p{N})/u,Sn=/^(?:\p{Uppercase}|\p{Lt})/u,Fn=/^\p{Lowercase}/u,Rn=/^(?:\r\n|[\r\n\t ])/,In=/^(?:\r\n|\p{White_Space})/u,Nn=/^[\r\n\t ]*/,Tn=/^\p{White_Space}*/u,_n=/^[\r\n\t ]+/,Cn=/^\p{White_Space}+/u,Pn=/^(?:\r\n|\r|\n)/,zn=/^(?:\r\n|[\r\n\u0085\u2028\u2029])/u,Gn=t=>W(n=>{const{index:r,view:e}=n,s=o(r,e.byteLength-r,e).match(t);return s?Z(n,s[0],r+i(s[0]).byteLength):X(n)}),qn=t=>W(n=>{!function(t,n,r=ct){"string"!=typeof n&&"[object RegExp]"!==Object.prototype.toString.call(n)&&mt(t,n,r)}("regex",t);let r="string"==typeof t?new RegExp(t):t;const{source:e,flags:s}=r;if("^"!==e[0]){r=new RegExp("^"+e,s)}const[u,[o,i]]=d(Gn(r)(n));return i.status===Mn?u:X(o,on.regex(r))}),Dn=W(t=>{const[n,[r,e]]=d(Gn(An)(t));return e.status===Mn?n:X(r,on.letterU)}),Vn=W(t=>{const[n,[r,e]]=d(Gn(jn)(t));return e.status===Mn?n:X(r,on.alphaU)}),Wn=W(t=>{const[n,[r,e]]=d(Gn(Sn)(t));return e.status===Mn?n:X(r,on.upperU)}),Zn=W(t=>{const[n,[r,e]]=d(Gn(Fn)(t));return e.status===Mn?n:X(r,on.lowerU)}),Xn=W(t=>{const[n,[r,e]]=d(Gn(Rn)(t));return e.status===Mn?n:X(r,on.space)}),Jn=W(t=>{const[n,[r,e]]=d(Gn(In)(t));return e.status===Mn?n:X(r,on.spaceU)}),Hn=W(t=>{const[n,r]=Gn(Nn)(t);return Z(n,null)}),Kn=W(t=>{const[n,r]=Gn(Tn)(t);return Z(n,null)}),Qn=W(t=>{const[n,r]=Gn(_n)(t);return r.status===Mn?Z(n,null):X(n,on.spaces1)}),Yn=W(t=>{const[n,r]=Gn(Cn)(t);return r.status===Mn?Z(n,null):X(n,on.spaces1U)}),tr=W(t=>{const[n,[r,e]]=d(Gn(Pn)(t));return e.status===Mn?n:X(r,on.newline)}),nr=W(t=>{const[n,[r,e]]=d(Gn(zn)(t));return e.status===Mn?n:X(r,on.newlineU)}),{Ok:rr}=D,er=(t,n)=>W(r=>{if(t<1)return Z(r,"");const{index:e,view:s}=r;if(e>=s.byteLength)return X(r);const{width:i,next:f}=function(t,n,r){const e=n.byteLength;let s=0;for(const o of u(r)){const r=t+s;if(r>=e)break;s+=c(r,n)}return t+s>=e&&(s=e-t),{width:s,next:o(t,s,n)}}(e,s,t);return a(f)===t&&n(f)?Z(r,f,e+i):X(r)}),sr=t=>W(n=>{Bt("string",t);const[r,[e,s]]=d(er(a(t),n=>t===n)(n));return s.status===rr?r:X(e,on.string(t))}),ur=t=>W(n=>{Bt("stringI",t);const[r,[e,s]]=d(er(a(t),n=>t.toLowerCase()===n.toLowerCase())(n));return s.status===rr?r:X(e,on.stringI(t))}),or=W(t=>{const{index:n,view:r}=t,e=r.byteLength-n;return Z(t,o(n,e,r),n+e)}),ir=t=>W(n=>{Et("anyString",t);const[r,[e,s]]=d(er(t,()=>!0)(n));return s.status===rr?r:X(e,on.anyString(t))}),{Ok:ar,Fail:cr,Fatal:fr}=D,lr=(...t)=>{const n=t.slice(),r="string"==typeof t[t.length-1]?n.pop():null;return W(t=>{const e=null!=r;n.forEach((t,n)=>Mt("alt",t,yt(n+1,!0)));let s=e?E(r):[];for(const r of n){const[n,[u,o]]=d(r(t));if(o.status===ar)return n;if(e||(s=R(s,o.errors)),o.status===fr)return J(u,s)}return X(t,s)})},dr=(t,n)=>W(r=>{const e=null!=n;Mt("opt",t,yt(1,e)),e&&Bt("opt",n,gt(2,!0));const[s,[u,o]]=d(t(r));if(o.status===ar)return s;const i=e?E(n):o.errors;if(o.status===fr)return J(u,i);const a=Z(u,null);return a[1].errors=i,a}),pr=(t,n,r)=>W(e=>{const s=null!=r;Mt("def",t,yt(1,!0)),s&&Bt("def",r,gt(3,!0));const[u,[o,i]]=d(t(e));return i.status===ar?u:i.status===cr?Z(o,n):J(o,$(r,i.errors))}),hr=(t,n)=>W(r=>{const e=null!=n;Mt("peek",t,yt(1,e)),e&&Bt("peek",n,gt(2,!0));const s=r.index,[u,o]=t(r);return o.status===ar?Z(u,o.value,s):o.status===cr?X(u,$(n,o.errors),s):X(u,k(n,u,o.errors),s)}),yr=(t,n)=>W(r=>{const e=null!=n;Mt("empty",t,yt(1,e)),e&&Bt("empty",n,gt(2,!0));const s=r.index,[u,o]=t(r);if(o.status===ar&&u.index===s)return Z(u,null);return m(o.status===fr)(u,$(n,o.errors))}),gr=(t,n)=>W(r=>{const e=null!=n;Mt("not",t,yt(1,e)),e&&Bt("not",n,gt(2,!0));const s=r.index,[u,o]=t(r);return o.status===ar?X(u,$(n,void 0),s):Z(u,null,s)}),{Ok:xr,Fail:vr,Fatal:br}=D,wr=(t,n)=>W(r=>{const e=null!=n;Mt("attempt",t,yt(1,e)),e&&Bt("attempt",n,gt(2,!0));const s=r.index,[u,[o,i]]=d(t(r));if(i.status===xr)return u;if(i.status===br||o.index!==s)return X(o,k(n,o,i.errors),s);if(e){if(1===i.errors.length&&i.errors[0].type===O.Nested){const{ctx:t,errors:r}=i.errors[0];return X(o,F(n,t,r),s)}return X(o,E(n),s)}return X(o,i.errors,s)}),mr=(...t)=>{const n=t.slice(),r="string"==typeof n[n.length-1]?n.pop():null;return W(e=>{n.forEach((n,r)=>Mt("seqB",n,yt(r+1,t.length>1)));const s=[],u=e.index;let o=e,i=[];for(const t of n){var a;const[n,e]=t(o);if(o=n,i=(null===(a=e.errors)||void 0===a?void 0:a.length)?R(i,e.errors):[],e.status===br)return J(n,$(r,e.errors));if(e.status===vr){return X(n,U(n.index!==u,r,n,i),u)}s.push(e.value)}return Z(o,s)})},$r=(t,n,r)=>W(e=>{const s=null!=r;Mt("chainB",t,yt(1,!0)),kt("chainB",n,pt(2,!0)),s&&Bt("chainB",r,gt(3,!0));const u=e.index,[o,i]=t(e);if(i.status!==xr){return m(i.status===br)(o,$(r,i.errors))}const a=n(i.value);Mt("chainB",a,rt("second argument to return a parser"));const[c,[f,l]]=d(a(o));if(l.status===xr)return c;const p=R(i.errors,l.errors);if(l.status===br)return J(f,$(r,p));return X(f,U(f.index!==u,r,f,p),u)}),kr=(t,n,r)=>W(e=>{const s=null!=r;Mt("applyB",t,yt(1,!0)),Mt("applyB",n,yt(2,!0)),s&&Bt("applyB",r,gt(3,!0));const u=e.index,[o,i]=t(e);if(i.status!==xr){return m(i.status===br)(o,$(r,i.errors))}const[a,c]=n(o),f=R(i.errors,c.errors);if(c.status===br)return J(a,$(r,f));if(c.status===vr){return X(a,U(a.index!==u,r,a,f),u)}const l=c.value;return kt("applyB",l,rt("second argument to return a function")),Z(a,l(i.value))}),Ur=(t,n,r)=>W(e=>{const s=null!=r;Mt("leftB",t,yt(1,!0)),Mt("leftB",n,yt(2,!0)),s&&Bt("leftB",r,gt(3,!0));const u=e.index,[o,i]=t(e);if(i.status!==xr){return m(i.status===br)(o,$(r,i.errors))}const[a,c]=n(o);if(c.status===xr)return Z(a,i.value);const f=R(i.errors,c.errors);if(c.status===br)return J(a,$(r,f));return X(a,U(a.index!==u,r,a,f),u)}),Br=(t,n,r)=>W(e=>{const s=null!=r;Mt("rightB",t,yt(1,!0)),Mt("rightB",n,yt(2,!0)),s&&Bt("rightB",r,gt(3,!0));const u=e.index,[o,i]=t(e);if(i.status!==xr){return m(i.status===br)(o,$(r,i.errors))}const[a,[c,f]]=d(n(o));if(f.status===xr)return a;const l=R(i.errors,f.errors);if(f.status===br)return J(c,$(r,l));return X(c,U(c.index!==u,r,c,l),u)}),Lr=(t,n,r)=>W(e=>{const s=null!=r;Mt("repeatB",t,yt(1,!0)),Et("repeatB",n,ht(2,!0)),s&&Bt("repeatB",r,gt(3,!0));const o=e.index,i=[];let a=e;for(const e of u(n)){const[n,e]=t(a);if(a=n,e.status===br)return J(n,$(r,e.errors));if(e.status===vr){return X(n,U(n.index!==o,r,n,e.errors),o)}i.push(e.value)}return Z(a,i)}),Or=(t,n)=>W(r=>{Mt("manyTillB",t,wt("1st")),Mt("manyTillB",n,wt("2nd"));const e=r.index,s=[];let u=r;for(;;){const[r,[o,i]]=d(n(u));if(u=o,i.status===br)return r;if(i.status===xr)break;const[a,[c,f]]=d(t(u));if(u=c,f.status===br)return a;if(f.status===vr){return X(c,e===c.index?R(f.errors,i.errors):S(c,R(f.errors,i.errors)),e)}s.push(f.value)}return Z(u,s)}),Er=t=>W(n=>{Ut("blockB",t);const r=t(),e=n.index;let s,u=[],o=n,i=0;for(;;){var a;const{value:t,done:n}=r.next(s);if(n)return Z(o,t);Mt("blockB",t,t=>`expected ${h(i+1)} yield to be to a parser; found ${w(t)}`);const[c,f]=t(o);if(o=c,u=(null===(a=f.errors)||void 0===a?void 0:a.length)?R(u,f.errors):[],f.status===br)return J(o,u);if(f.status===vr){return X(o,e===o.index?u:S(o,u),e)}s=f.value,i++}}),Mr=(...t)=>{const n=t.slice(),r=n.pop();return W(t=>{At("pipeB",n),kt("pipeB",r,bt(h(n.length+1)));const e=t.index,s=[];let u=t,o=[];for(const t of n){var i;const[n,r]=t(u);if(u=n,o=(null===(i=r.errors)||void 0===i?void 0:i.length)?R(o,r.errors):[],r.status===br)return J(u,o);if(r.status===vr){return X(u,e===u.index?o:S(u,o),e)}s.push(r.value)}return Z(u,r(...s))})},Ar=(t,n,r)=>W(e=>{var s;Mt("betweenB",t,wt("1st")),Mt("betweenB",n,wt("2nd")),Mt("betweenB",r,wt("3rd"));const u=e.index,[o,[i,a]]=d(t(e));if(a.status!==xr)return o;const[c,f]=r(i);let l=(null===(s=f.errors)||void 0===s?void 0:s.length)?R(a.errors,f.errors):[];if(f.status===br)return J(c,l);if(f.status===vr){return X(c,u===c.index?l:S(c,l),u)}const[p,h]=n(c);if(h.status===br)return J(p,R(l,h.errors));if(h.status===vr){l=R(l,h.errors);return X(p,u===p.index?l:S(p,l),u)}return Z(p,f.value)}),{Ok:jr,Fatal:Sr}=D,Fr=(t,n)=>W(r=>{const e=null!=n;Mt("join",t,yt(1,e)),e&&Bt("join",n,gt(2,!0));const[s,u]=t(r);if(u.status!==jr){return m(u.status===Sr)(s,e?E(n):u.errors)}const o=u.value;return Lt("join",o,rt("argument to return an array")),Z(s,o.join(""))}),Rr=(t,n)=>W(r=>{const e=null!=n;Mt("compact",t,yt(1,e)),e&&Bt("compact",n,gt(2,!0));const[s,u]=t(r);if(u.status!==jr){return m(u.status===Sr)(s,e?E(n):u.errors)}const o=u.value;return Lt("compact",o,rt("argument to return an array")),Z(s,o.filter(t=>null!=t))}),Ir=(t,n,r)=>W(e=>{const s=null!=r;Mt("value",t,yt(1,!0)),s&&Bt("value",r,gt(3,!0));const[u,o]=t(e);if(o.status!==jr){return m(o.status===Sr)(u,s?E(r):o.errors)}return Z(u,n)}),Nr=(t,n,r)=>W(e=>{const s=null!=r;Mt("nth",t,yt(1,!0)),Et("nth",n,ht(2,!0)),s&&Bt("nth",r,gt(3,!0));const[u,o]=t(e);if(o.status!==jr){return m(o.status===Sr)(u,s?E(r):o.errors)}const i=o.value;return Lt("nth",i,rt("first argument to return an array")),Z(u,i[n])}),Tr=(t,n)=>W(r=>{const e=null!=n;Mt("first",t,yt(1,e)),e&&Bt("first",n,gt(2,!0));const[s,u]=t(r);if(u.status!==jr){return m(u.status===Sr)(s,e?E(n):u.errors)}const o=u.value;return Lt("first",o,rt("argument to return an array")),Z(s,o[0])}),_r=(t,n)=>W(r=>{const e=null!=n;Mt("second",t,yt(1,e)),e&&Bt("second",n,gt(2,!0));const[s,u]=t(r);if(u.status!==jr){return m(u.status===Sr)(s,e?E(n):u.errors)}const o=u.value;return Lt("second",o,rt("argument to return an array")),Z(s,o[1])}),Cr=(t,n)=>W(r=>{const e=null!=n;Mt("third",t,yt(1,e)),e&&Bt("third",n,gt(2,!0));const[s,u]=t(r);if(u.status!==jr){return m(u.status===Sr)(s,e?E(n):u.errors)}const o=u.value;return Lt("third",o,rt("argument to return an array")),Z(s,o[2])}),Pr=(t,n)=>W(r=>{const e=null!=n;Mt("fourth",t,yt(1,e)),e&&Bt("fourth",n,gt(2,!0));const[s,u]=t(r);if(u.status!==jr){return m(u.status===Sr)(s,e?E(n):u.errors)}const o=u.value;return Lt("fourth",o,rt("argument to return an array")),Z(s,o[3])}),zr=(t,n)=>W(r=>{const e=null!=n;Mt("fifth",t,yt(1,e)),e&&Bt("fifth",n,gt(2,!0));const[s,u]=t(r);if(u.status!==jr){return m(u.status===Sr)(s,e?E(n):u.errors)}const o=u.value;return Lt("fifth",o,rt("argument to return an array")),Z(s,o[4])}),Gr=(t,n,r)=>W(e=>{const s=null!=r;Mt("map",t,yt(1,!0)),kt("map",n,pt(2,!0)),s&&Bt("map",r,gt(3,!0));const[u,o]=t(e);if(o.status!==jr){return m(o.status===Sr)(u,s?E(r):o.errors)}return Z(u,n(o.value))}),qr=(t,n,r)=>W(e=>{const s=null!=r;Mt("apply",t,yt(1,!0)),Mt("apply",n,yt(2,!0)),s&&Bt("apply",r,gt(3,!0));const u=e.index,o=E(r),[i,a]=t(e);if(a.status!==jr){return m(a.status===Sr)(i,s?o:a.errors)}const[c,f]=n(i);if(f.status!==jr){return m(f.status===Sr||c.index!==u)(c,s?o:R(a.errors,f.errors))}const l=f.value;return kt("apply",l,rt("second argument to return a function")),Z(c,l(a.value))}),Dr=(t,n,r)=>W(e=>{const s=null!=r;Mt("chain",t,yt(1,!0)),kt("chain",n,pt(2,!0)),s&&Bt("chain",r,gt(3,!0));const u=e.index,o=E(r),[i,a]=t(e);if(a.status!==jr){return m(a.status===Sr)(i,s?o:a.errors)}const c=n(a.value);Mt("chain",c,rt("second argument to return a parser"));const[f,[l,p]]=d(c(i));if(p.status!==jr){return m(p.status===Sr||l.index!==u)(l,s?o:R(a.errors,p.errors))}return f}),{Ok:Vr,Fail:Wr,Fatal:Zr}=D;function Xr(t){return`[${t}]: infinite loop detected; neither content nor separator parser consumed input`}const Jr=(...t)=>{const n=t.slice(),r="string"==typeof t[t.length-1]?n.pop():null;return W(t=>{const e=null!=r;n.forEach((t,n)=>Mt("seq",t,yt(n+1,!0)));const s=[],u=t.index;let o=e?E(r):[],i=t;for(const t of n){var a;const[n,r]=t(i);if(i=n,e||(o=(null===(a=r.errors)||void 0===a?void 0:a.length)?R(o,r.errors):[]),r.status!==Vr){return m(r.status===Zr||i.index!==u)(i,o)}s.push(r.value)}return Z(i,s)})},Hr=(t,n,r)=>W(e=>{const s=null!=r;Mt("left",t,yt(1,!0)),Mt("left",n,yt(2,!0)),s&&Bt("left",r,gt(3,!0));const u=e.index,o=E(r),[i,a]=t(e);if(a.status!==D.Ok){return(a.status===Zr?J:X)(i,s?o:a.errors)}const[c,f]=n(i);if(f.status!==Vr){return m(f.status===Zr||c.index!==u)(c,s?o:R(a.errors,f.errors))}return Z(c,a.value)}),Kr=(t,n,r)=>W(e=>{const s=null!=r;Mt("right",t,yt(1,!0)),Mt("right",n,yt(2,!0)),s&&Bt("right",r,gt(3,!0));const u=e.index,o=E(r),[i,a]=t(e);if(a.status!==D.Ok){return m(a.status===Zr)(i,s?o:a.errors)}const[c,[f,l]]=d(n(i));if(l.status!==Vr){return m(f.status===Zr||f.index!==u)(f,s?o:R(a.errors,l.errors))}return c}),Qr=(t,n)=>W(r=>{const e=null!=n;Ut("block",t,((t=1,n=!1)=>dt("a generator function",t,n))(1,e)),e&&Bt("block",n,gt(2,!0));const s=t(),u=r.index;let o,i=e?E(n):[],a=r,c=0;for(;;){var f;const{value:t,done:n}=s.next(o);if(n)return Z(a,t);Mt("block",t,t=>`expected ${b(c+1)} yield to be to a parser; found ${w(t)}`);const[r,l]=t(a);if(a=r,e||(i=(null===(f=l.errors)||void 0===f?void 0:f.length)?R(i,l.errors):[]),l.status!==Vr){return m(l.status===Zr||r.index!==u)(r,i)}o=l.value,c++}}),Yr=(t,n)=>W(r=>{const e=null!=n;Mt("many",t,yt(1,e)),e&&Bt("many",n,gt(2,!0));const s=[];let u=r;for(;;){const[r,o]=t(u);if(u=r,o.status===Zr)return J(r,e?E(n):o.errors);if(o.status===Wr)break;if(s.push(o.value),u.index>=u.view.byteLength)break}return Z(u,s)}),te=(t,n)=>W(r=>{const e=null!=n;Mt("many1",t,yt(1,e)),e&&Bt("many1",n,gt(2,!0));const s=E(n),[u,o]=t(r);if(o.status!==Vr){return m(o.status===Zr)(u,e?s:o.errors)}let i=u;const a=[o.value];for(;;){const[n,r]=t(i);if(i=n,r.status===Zr)return J(n,e?s:r.errors);if(r.status===Wr)break;if(a.push(r.value),i.index>=i.view.byteLength)break}return Z(i,a)}),ne=(t,n)=>W(r=>{const e=null!=n;Mt("skip",t,yt(1,e)),e&&Bt("skip",n,gt(2,!0));const[s,u]=t(r);if(u.status!==Vr){return m(u.status===Zr)(s,e?E(n):u.errors)}return Z(s,null)}),re=(t,n)=>W(r=>{const e=null!=n;Mt("skipMany",t,yt(1,e)),e&&Bt("skipMany",n,gt(2,!0));let s=r;for(;;){const[r,u]=t(s);if(s=r,u.status===Zr)return J(r,e?E(n):u.errors);if(u.status===Wr)break;if(s.index>=s.view.byteLength)break}return Z(s,null)}),ee=(t,n)=>W(r=>{const e=null!=n;Mt("skipMany1",t,yt(1,e)),e&&Bt("skipMany1",n,gt(2,!0));const s=E(n),[u,o]=t(r);if(o.status!==Vr){return m(o.status===Zr)(u,e?s:o.errors)}let i=u;for(;;){const[n,r]=t(i);if(i=n,r.status===Zr)return J(n,e?s:r.errors);if(r.status===Wr)break;if(i.index>=i.view.byteLength)break}return Z(i,null)}),se=(t,n,r)=>W(e=>{const s=null!=r;Mt("sep",t,yt(1,!0)),Mt("sep",n,yt(2,!0)),s&&Bt("sep",r,gt(3,!0));let u=e.index;const o=E(r),[i,a]=t(e);if(a.status===Zr)return J(i,s?o:a.errors);if(a.status===Wr)return Z(i,[]);const c=[a.value];let f=i;for(;;){u=f.index;const[r,e]=n(f);if(f=r,e.status===Zr)return J(r,s?o:e.errors);if(e.status===Wr)break;const[i,a]=t(f);if(f=i,a.status===Zr)return J(i,s?o:a.errors);if(a.status===Wr)break;if(f.index===u)throw new TypeError(Xr("sep"));c.push(a.value)}return Z(f,c,u)}),ue=(t,n,r)=>W(e=>{const s=null!=r;Mt("sep1",t,yt(1,!0)),Mt("sep1",n,yt(2,!0)),s&&Bt("sep1",r,gt(3,!0));let u=e.index;const o=E(r),[i,a]=t(e);if(a.status!==Vr){return m(a.status===Zr)(i,s?o:a.errors)}const c=[a.value];let f=i;for(;;){u=f.index;const[r,e]=n(f);if(f=r,e.status===Zr)return J(r,s?o:e.errors);if(e.status===Wr)break;const[i,a]=t(f);if(f=i,a.status===Zr)return J(i,s?o:a.errors);if(a.status===Wr)break;if(f.index===u)throw new TypeError(Xr("sep1"));c.push(a.value)}return Z(f,c,u)}),oe=(t,n,r)=>W(e=>{const s=null!=r;Mt("end",t,yt(1,!0)),Mt("end",n,yt(2,!0)),s&&Bt("end",r,gt(3,!0));let u=e.index;const o=E(r),[i,a]=t(e);if(a.status===Zr)return J(i,s?o:a.errors);if(a.status===Wr)return Z(i,[]);const c=[a.value];let f=i;for(;;){u=f.index;const[r,e]=n(f);if(f=r,e.status===Zr)return J(r,s?o:e.errors);if(e.status===Wr)break;const[i,a]=t(f);if(f=i,a.status===Zr)return J(i,s?o:a.errors);if(a.status===Wr)break;if(f.index===u)throw new TypeError(Xr("end"));c.push(a.value)}const[l,d]=n({...f,index:u});return d.status===Zr?J(l,s?o:d.errors):Z(l,c)}),ie=(t,n,r)=>W(e=>{const s=null!=r;Mt("sepEndBy1",t,yt(1,!0)),Mt("sepEndBy1",n,yt(2,!0)),s&&Bt("sepEndBy1",r,gt(3,!0));let u=e.index;const o=E(r),[i,a]=t(e);if(a.status!==Vr){return m(a.status===Zr)(i,s?o:a.errors)}const c=[a.value];let f=i;for(;;){u=f.index;const[r,e]=n(f);if(f=r,e.status===Zr)return J(r,s?o:e.errors);if(e.status===Wr)break;const[i,a]=t(f);if(f=i,a.status===Zr)return J(i,s?o:a.errors);if(a.status===Wr)break;if(f.index===u)throw new TypeError(Xr("sepEndBy1"));c.push(a.value)}const[l,d]=n({...f,index:u});return d.status===Zr?J(l,s?o:d.errors):Z(l,c)}),ae=(t,n,r)=>W(e=>{const s=null!=r;Mt("repeat",t,yt(1,!0)),Et("repeat",n,ht(2,!0)),s&&Bt("repeat",r,gt(3,!0));const o=e.index,i=[];let a=e;for(const e of u(n)){const[n,e]=t(a);if(a=n,e.status!==Vr){return m(e.status===Zr||n.index!==o)(n,s?E(r):e.errors)}i.push(e.value)}return Z(a,i)}),ce=(t,n,r,e)=>W(s=>{var u;const o=null!=e;Mt("between",t,yt(1,!0)),Mt("between",n,yt(2,!0)),Mt("between",r,yt(3,!0)),o&&Bt("between",e,gt(4,!0));const i=s.index,[a,c]=t(s);if(c.status!==Vr){return m(c.status===Zr)(a,o?E(e):c.errors)}const[f,l]=r(a),d=o?E(e):(null===(u=l.errors)||void 0===u?void 0:u.length)?R(c.errors,l.errors):[];if(l.status!==Vr){return m(l.status===Zr||f.index!==i)(f,d)}const[p,h]=n(f);if(h.status!==Vr){return m(h.status===Zr||p.index!==i)(p,o?d:R(d,h.errors))}return Z(p,l.value)}),fe=(t,n,r)=>W(e=>{const s=null!=r;Mt("until",t,yt(1,!0)),Mt("until",n,yt(2,!0)),s&&Bt("until",r,gt(3,!0));const u=e.index,o=[];let i=e;const a=E(r);for(;;){const[r,e]=n(i);if(i=r,e.status===Zr)return J(r,s?a:e.errors);if(e.status===Vr)break;const[c,f]=t(i);if(i=c,f.status===Zr)return J(c,s?a:f.errors);if(f.status===Wr){return m(c.index!==u)(c,s?a:R(f.errors,e.errors))}o.push(f.value)}return Z(i,o)}),le=(...t)=>{const n=t.slice(),r="string"==typeof t[t.length-1]?n.pop():null,e=n.pop();return W(t=>{const s=null!=r;n.forEach((t,n)=>Mt("pipe",t,yt(n+1,!0))),kt("pipe",e,pt(n.length+1,!0));const u=t.index,o=[];let i=t,a=s?E(r):[];for(const t of n){var c;const[n,r]=t(i);if(i=n,s||(a=(null===(c=r.errors)||void 0===c?void 0:c.length)?R(a,r.errors):[]),r.status!==Vr){return m(r.status===Zr||n.index!==u)(n,a)}o.push(r.value)}return Z(i,e(...o))})};function de(t){return n=>`expected ${t} op parser to return a function; found ${w(n)}`}const pe=(t,n,r,e)=>W(s=>{const o=null!=e;Mt("assocL",t,yt(1,!0)),Mt("assocL",n,yt(2,!0)),o&&Bt("assocL",e,gt(4,!0));const i=E(e),[a,c]=t(s);if(c.status===Zr)return J(a,o?i:c.errors);if(c.status===Wr)return Z(a,r);const f=[c.value],l=[];let d=a,p=d.index,h=0;for(;;){const[r,e]=n(d);if(d=r,e.status===Zr)return J(r,o?i:e.errors);if(e.status===Wr)break;const[s,u]=t(d);if(d=s,u.status===Zr)return J(s,o?i:u.errors);if(u.status===Wr)break;kt("assocL",e.value,de(b(h+1))),l.push(e.value),f.push(u.value),p=d.index,h++}let y=f[0];for(const t of u(l.length))y=l[t](y,f[t+1]);return Z(d,y,p)}),he=(t,n,r)=>W(e=>{const s=null!=r;Mt("assoc1L",t,yt(1,!0)),Mt("assoc1L",n,yt(2,!0)),s&&Bt("assoc1L",r,gt(3,!0));const o=E(r),[i,a]=t(e);if(a.status!==Vr){return m(a.status===Zr)(i,s?o:a.errors)}const c=[a.value],f=[];let l=i,d=l.index,p=0;for(;;){const[r,e]=n(l);if(l=r,e.status===Zr)return J(r,s?o:e.errors);if(e.status===Wr)break;const[u,i]=t(l);if(l=u,i.status===Zr)return J(u,s?o:i.errors);if(i.status===Wr)break;kt("assoc1L",e.value,de(b(p+1))),f.push(e.value),c.push(i.value),d=l.index,p++}let h=c[0];for(const t of u(f.length))h=f[t](h,c[t+1]);return Z(l,h,d)}),ye=(t,n,r,e)=>W(s=>{const o=null!=e;Mt("assocR",t,yt(1,!0)),Mt("assocR",n,yt(2,!0)),o&&Bt("assocR",e,gt(4,!0));const i=E(e),[a,c]=t(s);if(c.status===Zr)return J(a,o?i:c.errors);if(c.status===Wr)return Z(a,r);const f=[c.value],l=[];let d=a,p=d.index,h=0;for(;;){const[r,e]=n(d);if(d=r,e.status===Zr)return J(r,o?i:e.errors);if(e.status===Wr)break;const[s,u]=t(d);if(d=s,u.status===Zr)return J(s,o?i:u.errors);if(u.status===Wr)break;kt("assocR",e.value,de(b(h+1))),l.push(e.value),f.push(u.value),p=d.index,h++}let y=f[f.length-1];for(const t of u(l.length-1,-1))y=l[t](f[t],y);return Z(d,y,p)}),ge=(t,n,r)=>W(e=>{const s=null!=r;Mt("assoc1R",t,yt(1,!0)),Mt("assoc1R",n,yt(2,!0)),s&&Bt("assoc1R",r,gt(3,!0));const o=E(r),[i,a]=t(e);if(a.status!==Vr){return m(a.status===Zr)(i,s?o:a.errors)}const c=[a.value],f=[];let l=i,d=l.index,p=0;for(;;){const[r,e]=n(l);if(l=r,e.status===Zr)return J(r,s?o:e.errors);if(e.status===Wr)break;const[u,i]=t(l);if(l=u,i.status===Zr)return J(u,s?o:i.errors);if(i.status===Wr)break;kt("assoc1R",e.value,de(b(p+1))),f.push(e.value),c.push(i.value),d=l.index,p++}let h=c[c.length-1];for(const t of u(f.length-1,-1))h=f[t](c[t],h);return Z(l,h,d)})}])}));