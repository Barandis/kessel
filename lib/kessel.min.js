/*!
 * Copyright (c) 2020 Thomas Otterson
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * 
 */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.kessel=n():t.kessel=n()}(this,(function(){return function(t){var n={};function r(e){if(n[e])return n[e].exports;var u=n[e]={i:e,l:!1,exports:{}};return t[e].call(u.exports,u,u.exports,r),u.l=!0,u.exports}return r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var u in t)r.d(e,u,function(n){return t[n]}.bind(null,u));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=0)}([function(t,n,r){"use strict";r.r(n),r.d(n,"alpha",(function(){return wn})),r.d(n,"any",(function(){return dn})),r.d(n,"char",(function(){return cn})),r.d(n,"digit",(function(){return yn})),r.d(n,"eof",(function(){return pn})),r.d(n,"hex",(function(){return gn})),r.d(n,"ichar",(function(){return an})),r.d(n,"letter",(function(){return vn})),r.d(n,"lower",(function(){return $n})),r.d(n,"noneof",(function(){return bn})),r.d(n,"octal",(function(){return xn})),r.d(n,"oneof",(function(){return hn})),r.d(n,"range",(function(){return ln})),r.d(n,"satisfy",(function(){return fn})),r.d(n,"upper",(function(){return mn})),r.d(n,"always",(function(){return On})),r.d(n,"fail",(function(){return kn})),r.d(n,"fatal",(function(){return En})),r.d(n,"newline",(function(){return Kn})),r.d(n,"regex",(function(){return Rn})),r.d(n,"space",(function(){return Wn})),r.d(n,"spaces",(function(){return Xn})),r.d(n,"spaces1",(function(){return Jn})),r.d(n,"ualpha",(function(){return qn})),r.d(n,"uletter",(function(){return Gn})),r.d(n,"ulower",(function(){return Vn})),r.d(n,"unewline",(function(){return Qn})),r.d(n,"uspace",(function(){return Zn})),r.d(n,"uspaces",(function(){return Bn})),r.d(n,"uspaces1",(function(){return Hn})),r.d(n,"uupper",(function(){return Dn})),r.d(n,"all",(function(){return er})),r.d(n,"anystr",(function(){return ur})),r.d(n,"istr",(function(){return rr})),r.d(n,"str",(function(){return nr})),r.d(n,"alt",(function(){return cr})),r.d(n,"def",(function(){return fr})),r.d(n,"empty",(function(){return dr})),r.d(n,"not",(function(){return pr})),r.d(n,"opt",(function(){return ar})),r.d(n,"peek",(function(){return lr})),r.d(n,"attempt",(function(){return gr})),r.d(n,"bapply",(function(){return wr})),r.d(n,"bbetween",(function(){return Lr})),r.d(n,"bblock",(function(){return Or})),r.d(n,"bchain",(function(){return vr})),r.d(n,"bcount",(function(){return kr})),r.d(n,"bleft",(function(){return mr})),r.d(n,"bpipe",(function(){return Ar})),r.d(n,"bright",(function(){return $r})),r.d(n,"bseq",(function(){return xr})),r.d(n,"buntil",(function(){return Er})),r.d(n,"apply",(function(){return Gr})),r.d(n,"chain",(function(){return qr})),r.d(n,"clean",(function(){return Sr})),r.d(n,"fifth",(function(){return Ir})),r.d(n,"first",(function(){return Tr})),r.d(n,"flat",(function(){return Fr})),r.d(n,"fourth",(function(){return Pr})),r.d(n,"join",(function(){return Mr})),r.d(n,"map",(function(){return Rr})),r.d(n,"nth",(function(){return Nr})),r.d(n,"second",(function(){return zr})),r.d(n,"third",(function(){return Cr})),r.d(n,"value",(function(){return _r})),r.d(n,"block",(function(){return Br})),r.d(n,"label",(function(){return Zr})),r.d(n,"lazy",(function(){return Xr})),r.d(n,"skip",(function(){return Jr})),r.d(n,"between",(function(){return fe})),r.d(n,"count",(function(){return ae})),r.d(n,"endby",(function(){return ie})),r.d(n,"endby1",(function(){return ce})),r.d(n,"lassoc",(function(){return he})),r.d(n,"lassoc1",(function(){return be})),r.d(n,"left",(function(){return ne})),r.d(n,"many",(function(){return ee})),r.d(n,"many1",(function(){return ue})),r.d(n,"pipe",(function(){return de})),r.d(n,"rassoc",(function(){return ye})),r.d(n,"rassoc1",(function(){return ge})),r.d(n,"right",(function(){return re})),r.d(n,"sepby",(function(){return oe})),r.d(n,"sepby1",(function(){return se})),r.d(n,"seq",(function(){return te})),r.d(n,"until",(function(){return le})),r.d(n,"Status",(function(){return V})),r.d(n,"failReply",(function(){return B})),r.d(n,"failure",(function(){return tt})),r.d(n,"fatalReply",(function(){return J})),r.d(n,"okReply",(function(){return X})),r.d(n,"parse",(function(){return H})),r.d(n,"parser",(function(){return Z})),r.d(n,"run",(function(){return nt})),r.d(n,"status",(function(){return K})),r.d(n,"succeeded",(function(){return Q})),r.d(n,"success",(function(){return Y})),r.d(n,"ErrorType",(function(){return A})),r.d(n,"compound",(function(){return S})),r.d(n,"expected",(function(){return L})),r.d(n,"formatErrors",(function(){return q})),r.d(n,"generic",(function(){return j})),r.d(n,"getPosition",(function(){return D})),r.d(n,"merge",(function(){return _})),r.d(n,"nested",(function(){return F})),r.d(n,"other",(function(){return M})),r.d(n,"unexpected",(function(){return U}));const e=new TextEncoder,u=new TextDecoder;function*o(t,n,r,e){const u="number"==typeof n?t:0,o="number"==typeof n?n:t,s="number"==typeof r?0===r?1:Math.abs(r):1,i="number"==typeof r?!!e:"number"==typeof n?!!r:!!n,c=u<o;let a=u;for(;!(c?i?a>o:a>=o:i?a<o:a<=o);)yield a,a=c?a+s:a-s}function s(t,n,r){const e=Uint8Array.from({length:n},(n,e)=>r.getUint8(t+e));return u.decode(e)}function i(t){return new DataView(e.encode(t).buffer)}function c(t){return[...t].length}function a(t,n){const r=n.getUint8(t);return(128&r)>>7==0?1:(224&r)>>5==6?2:(240&r)>>4==14?3:(240&r)>>4==15?4:1}function f(t,n){const r=a(t,n);return{width:r,next:s(t,r,n)}}function l(t){return`'${t}'`}function d(t){return[t,t]}function p(t){switch(t.length){case 0:return"";case 1:return t[0];case 2:return t.join(" or ");default:{const n=t.slice(),r=n.pop();return`${n.join(", ")}, or ${r}`}}}const h=["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],b=["zeroth","first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth","eleventh","twelfth","thirteenth","fourteenth","fifteenth","sixteenth","seventeenth","eighteenth","nineteenth"],y=["twent","thirt","fort","fift","sixt","sevent","eight","ninet"],g=["hundred","thousand","million","billion","trillion","quadrillion"];function x(t){if(t<0||t>Number.MAX_SAFE_INTEGER)throw new Error("Argument must be between 0 and "+Number.MAX_SAFE_INTEGER);const n=Math.floor(Math.log10(t));if(t<20)return b[t];if(1===n){const n=Math.floor(t/10)-2;return t%10==0?y[n]+"ieth":`${y[n]}y-${b[t%10]}`}if(2===n){const r=Math.floor(t/10**n),e=t-r*10**n;return`${h[r]} ${g[0]}${0===e?"th":" "+x(e)}`}const r=n%3+1,e=Math.floor(n/3),u=Math.floor(t/10**(n-r+1)),o=function t(n){if(n<20)return h[n];const r=n%10;if(n<100)return`${y[Math.floor(n/10)-2]}y${0===r?"":"-"+h[r]}`;const e=n-100*Math.floor(n/100);return`${h[Math.floor(n/100)]} ${g[0]}${0===e?"th":" "+t(e)}`}(u),s=t-u*10**(n-r+1);return`${o} ${g[e]}${0===s?"th":" "+x(s)}`}function v(t){return void 0===t?"undefined":"function"==typeof t?Z.created(t)?"parser":"function":"symbol"==typeof t?`Symbol(${t.description})`:JSON.stringify(t)}function w(t){return t?J:B}function m(t,n){return null==t?n:L(t)}function $(t,n,r){return null==t?F(n,r):S(t,n,r)}function k(t,n,r,e){return t?$(n,r,e):m(n,e)}const E=/\t/gu,O=/(?:\p{Mn}|\p{Cf})/gu,A={Expected:"expected",Unexpected:"unexpected",Generic:"generic",Nested:"nested",Compound:"compound",Other:"other"};function L(t){return[{type:A.Expected,label:t}]}function U(t){return[{type:A.Unexpected,label:t}]}function j(t){return[{type:A.Generic,label:t}]}function M(t){return[{type:A.Other,label:t}]}function F(t,n){return 1===n.length&&n[0].type===A.Nested?n:[{type:A.Nested,ctx:t,errors:n}]}function S(t,n,r){return 1===r.length&&r[0].type===A.Nested?[{type:A.Compound,ctx:r.ctx,errors:r.errors,label:t}]:[{type:A.Compound,ctx:n,errors:r,label:t}]}function _(t=[],n=[]){return[...t,...n]}function N(t,n){const r=n.getUint8(t);if(10===r||11===r||12===r)return{newline:!0,skip:1};if(13===r){if(t<n.byteLength-1){const e=n.getUint8(t+1);if(13===r&&10===e)return{newline:!0,skip:2}}return{newline:!0,skip:1}}if(t<n.byteLength-1){const e=n.getUint8(t+1);if(194===r&&133===e)return{newline:!0,skip:2};if(t<n.byteLength-2){const u=n.getUint8(t+2);if(226===r&&128===e&&(168===u||169===u))return{newline:!0,skip:3}}}return{newline:!1,skip:a(t,n)}}function T(t,n){let r=0,e=1,u=0;for(;u<n.byteLength;){const{newline:o,skip:s}=N(u,n);if(o){if(u+s>t)return{start:r,end:u-1,lineno:e};e++,r=u+s}u+=s}return{start:r,end:n.byteLength-1,lineno:e}}function z(t,n,r){let e=0,u=r;for(;u<t&&u<n.byteLength;)u+=a(u,n),e++;return e}function C(t,n,r){const e=[];let u=E.exec(n);for(;null!==u;)e.push(u.index),u=E.exec(n);let o=0,s=0,i=n;for(const n of e){const e=n+o,u=r-e%r;e<t+s&&(s+=u-1),o+=u-1,i=i.substring(0,e)+" ".repeat(u)+i.substring(e+1)}return{line:i,colIndex:s+t}}function P(t,n){let r=t;const e=[];let u=O.exec(n);for(;null!==u;)e.push(u.index),u.index<r&&r--,u=O.exec(n);return{colno:r+1,length:c(n)-e.length}}function I(t){return[...new Set(t)]}function R(t,n,r,e){const u=" ".repeat(e);return I(t.map(t=>{const{index:o,view:s}=t.ctx;return(t.label?`\n${u}Could not parse ${t.label} because:\n\n`:`\n${u}The parser backtracked after:\n\n`)+G(t.errors,o,s,n,r,e+2)})).join("")}function G(t,n,r,e=8,u=72,o=0){const{start:i,end:c,lineno:a}=T(n,r),f=z(n,r,i),l=" ".repeat(o),d=s(i,c-i+1,r),{colIndex:h,line:b}=C(f,d,e),{colno:y,length:g}=P(h,b),x=`${l}Parse error at (line ${a}, column ${y}):`,v=function(t,n,r,e,u=0){const o=" ".repeat(u);if(r<=e&&n<=e)return`${o}${t}\n${o}${" ".repeat(r-1)}^`;if(r<=e-3)return`${o}${t.substring(0,e-3)}...\n${o}${" ".repeat(r-1)}^`;if(r>=n-e+3){const u=n-e+3,s=r-(n-e);return`${o}...${t.substring(u)}\n${o}${" ".repeat(s-1)}^`}const s=r-1-Math.ceil(e/2)+3,i=r-1+Math.floor(e/2)-3;return`${o}...${t.substring(s,i)}...\n${o}${" ".repeat(Math.ceil(e/2))}^`}(b,g,y,u,o),w=t.find(t=>t.type===A.Generic),m=t.find(t=>t.type===A.Unexpected),$=p(I(t.filter(t=>t.type===A.Expected).map(t=>t.label))),k=t.filter(t=>t.type===A.Nested),E=t.filter(t=>t.type===A.Compound),O=m?`${l}Unexpected ${m.label}\n`:"",L=$.length?`${l}Expected ${$}\n`:"",U=w?`${l}${w.label}\n`:"",j=R(k,e,u,o),M=R(E,e,u,o);return function(t,n){let r=t;for(;"\n"===r[r.length-1];)r=r.substring(0,r.length-1);return r+"\n".repeat(n)}(`${x}\n\n${v}\n${O}${L}${U}${0===t.length?l+"Unknown error(s)\n":""}${n>=r.byteLength?l+"Note: failure occurred at the end of input\n":""}${M}${j}`,2)}function q(t,n,r,e=G){const[u,o]=t,{index:s,view:i}=u;return e(o.errors,s,i,n,r)}function D(t,n=8){const{index:r,view:e}=t,{start:u,end:o,lineno:i}=T(r,e),c=z(r,e,u),a=s(u,o-u+1,e),{colIndex:f,line:l}=C(c,a,n),{colno:d,_:p}=P(f,l);return{line:i,column:d}}const V={Ok:"ok",Fail:"fail",Fatal:"fatal"};function W(t){const n="Parser input must be a string, a typed array, an array buffer, or a data view; parser input was "+typeof t;return{view:(t=>{if("string"==typeof t)return i(t);if((r=t)instanceof Uint8Array||r instanceof Uint8ClampedArray||r instanceof Uint16Array||r instanceof Uint32Array||r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array||r instanceof Float32Array||r instanceof Float64Array)return new DataView(t.buffer);var r;if(t instanceof ArrayBuffer)return new DataView(t);if(t instanceof DataView)return t;throw new Error(n)})(t),index:0}}const Z=function(t,n="created"){const r=new WeakSet;return Object.defineProperty((...n)=>{const e=t(...n);return r.add(e),e},n,{value:r.has.bind(r)})}(t=>t);function X(t,n=null,r=t.index){return[{...t,index:r},{status:V.Ok,value:n}]}function B(t,n=[],r=t.index){return[{...t,index:r},{status:V.Fail,errors:n}]}function J(t,n=[],r=t.index){return[{...t,index:r},{status:V.Fatal,errors:n}]}function H(t,n){return t(W(n))}function K(t){return t[1].status}function Q(t){return t[1].status===V.Ok}function Y(t){return Q(t)?t[1].value:null}function tt(t){return Q(t)?null:q(t)}function nt(t,n){const[r,[e,u]]=d(t(W(n)));if(u.status===V.Ok)return u.value;throw new Error(q(r))}const rt=t=>n=>`expected ${t}; found ${v(n)}`,et=rt("a one-character string"),ut=rt("a function"),ot=rt("a generator function"),st=rt("a string"),it=rt("an array"),ct=rt("a string or an array of characters"),at=rt("a string or a regular expression"),ft=rt("a number"),lt=rt("a parser"),dt=(t,n=1,r=!1)=>e=>`expected ${r?x(n)+" ":""}argument to be ${t}; found ${v(e)}`,pt=(t=1,n=!1)=>dt("a one-character string",t,n),ht=(t=1,n=!1)=>dt("a function",t,n),bt=(t=1,n=!1)=>dt("a generator function",t,n),yt=(t=1,n=!1)=>dt("a number",t,n),gt=(t=1,n=!1)=>dt("a parser",t,n),xt=(t=1,n=!1)=>dt("a string",t,n),vt=(t=1,n=!1)=>dt("a string or an array of characters",t,n);function wt(t,n,r){throw new Error(`[${t}]: ${r(n)}`)}function mt(t,n,r=et){"string"==typeof n&&1===c(n)||wt(t,n,r)}function $t(t,n,r=ut){("function"!=typeof n||Z.created(n))&&wt(t,n,r)}function kt(t,n,r=ot){"[object GeneratorFunction]"!==Object.prototype.toString.call(n)&&wt(t,n,r)}function Et(t,n,r=st){"string"!=typeof n&&wt(t,n,r)}function Ot(t,n,r=it){Array.isArray(n)||wt(t,n,r)}function At(t,n,r=ct){Array.isArray(n)&&n.every(t=>"string"==typeof t&&1===c(t))||"string"==typeof n||wt(t,n,r)}function Lt(t,n,r=ft){"number"!=typeof n&&wt(t,n,r)}function Ut(t,n,r=lt){"function"==typeof n&&Z.created(n)||wt(t,n,r)}const jt="any character",Mt=t=>`a string of ${t} characters`,Ft=t=>l(t),St="a digit",_t="end of input",Nt="a hexadecimal digit",Tt=t=>l(t),zt=t=>l(t),Ct="a letter",Pt="a lowercase letter",It="a newline",Rt=t=>"none of "+p(t.map(t=>`'${t}'`)),Gt="an octal digit",qt=t=>"one of "+p(t.map(t=>`'${t}'`)),Dt=(t,n)=>`a character between '${t}' and '${n}'`,Vt=t=>"a string matching "+t,Wt="a whitespace character",Zt="zero or more whitespace characters",Xt="one or more whitespace characters",Bt=t=>l(t),Jt="a Unicode alphanumeric character",Ht="a Unicode letter",Kt="a Unicode lowercase letter",Qt="a Unicode newline",Yt="an uppercase letter",tn="a Unicode whitespace character",nn="zero or more Unicode whitespace characters",rn="one or more Unicode whitespace characters",en="a Unicode uppercase letter",un={alpha:L("an alphanumeric character"),any:L(jt),anystr:t=>L(Mt(t)),char:t=>L(Ft(t)),digit:L(St),eof:L(_t),hex:L(Nt),ichar:t=>L(Tt(t)),istr:t=>L(zt(t)),letter:L(Ct),lower:L(Pt),newline:L(It),noneof:t=>L(Rt(t)),octal:L(Gt),oneof:t=>L(qt(t)),range:(t,n)=>L(Dt(t,n)),regex:t=>L(Vt(t)),space:L(Wt),spaces:L(Zt),spaces1:L(Xt),str:t=>L(Bt(t)),ualpha:L(Jt),uletter:L(Ht),ulower:L(Kt),unewline:L(Qt),upper:L(Yt),uspace:L(tn),uspaces:L(nn),uspaces1:L(rn),uupper:L(en)},{Ok:on}=V;function sn(t){return n=>{const{index:r,view:e}=n;if(r>=e.byteLength)return B(n);const{width:u,next:o}=f(r,e);return t(o)?X(n,o,r+u):B(n)}}function cn(t,n){const r=null!=n;return mt("char",t,pt(1,r)),r&&Et("char",n,xt(2,!0)),Z(r=>{const[e,[u,o]]=d(sn(n=>t===n)(r));return o.status===on?e:B(u,m(n,un.char(t)))})}function an(t,n){const r=null!=n;return mt("ichar",t,pt(1,r)),r&&Et("ichar",n,xt(2,!0)),Z(r=>{const[e,[u,o]]=d(sn(n=>t.toLowerCase()===n.toLowerCase())(r));return o.status===on?e:B(u,m(n,un.ichar(t)))})}function fn(t,n){const r=null!=n;return $t("satisfy",t,ht(1,r)),r&&Et("satisfy",n,xt(2,!0)),Z(r=>{const[e,[u,o]]=d(sn(t)(r));return o.status===on?e:B(u,m(n,o.errors))})}function ln(t,n,r){return mt("range",t,pt(1,!0)),mt("range",n,pt(2,!0)),null!=r&&Et("range",r,xt(3,!0)),Z(e=>{const[u,[o,s]]=d(sn(r=>r>=t&&r<=n)(e));return s.status===on?u:B(o,m(r,un.range(t,n)))})}function dn(t){return null!=t&&Et("any",t,xt()),Z(n=>{const{index:r,view:e}=n;if(r>=e.byteLength)return B(n,m(t,un.any));const{width:u,next:o}=f(r,e);return X(n,o,r+u)})}function pn(t){return null!=t&&Et("eof",t,xt()),Z(n=>{const{index:r,view:e}=n;return r>=e.byteLength?X(n,null):B(n,m(t,un.eof))})}function hn(t,n){const r=null!=n;return At("oneof",t,vt(1,r)),r&&Et("oneof",n,xt(2,!0)),Z(r=>{const e=[...t],{index:u,view:o}=r;if(u>=o.byteLength)return B(r,m(n,un.oneof(e)));const{width:s,next:i}=f(u,o);return e.includes(i)?X(r,i,u+s):B(r,m(n,un.oneof(e)))})}function bn(t,n){const r=null!=n;return At("noneof",t,vt(1,r)),r&&Et("noneof",n,xt(2,!0)),Z(r=>{const e=[...t],{index:u,view:o}=r;if(u>=o.byteLength)return B(r,m(n,un.noneof(e)));const{width:s,next:i}=f(u,o);return e.includes(i)?B(r,m(n,un.noneof(e))):X(r,i,u+s)})}function yn(t){return null!=t&&Et("digit",t,xt()),Z(n=>{const[r,[e,u]]=d(sn(t=>t>="0"&&t<="9")(n));return u.status===on?r:B(e,m(t,un.digit))})}function gn(t){return null!=t&&Et("hex",t,xt()),Z(n=>{const[r,[e,u]]=d(sn(t=>t>="0"&&t<="9"||t>="a"&&t<="f"||t>="A"&&t<="F")(n));return u.status===on?r:B(e,m(t,un.hex))})}function xn(t){return null!=t&&Et("octal",t,xt()),Z(n=>{const[r,[e,u]]=d(sn(t=>t>="0"&&t<="7")(n));return u.status===on?r:B(e,m(t,un.octal))})}function vn(t){return null!=t&&Et("letter",t,xt()),Z(n=>{const[r,[e,u]]=d(sn(t=>t>="a"&&t<="z"||t>="A"&&t<="Z")(n));return u.status===on?r:B(e,m(t,un.letter))})}function wn(t){return null!=t&&Et("alpha",t,xt()),Z(n=>{const[r,[e,u]]=d(sn(t=>t>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9")(n));return u.status===on?r:B(e,m(t,un.alpha))})}function mn(t){return null!=t&&Et("upper",t,xt()),Z(n=>{const[r,[e,u]]=d(sn(t=>t>="A"&&t<="Z")(n));return u.status===on?r:B(e,m(t,un.upper))})}function $n(t){return null!=t&&Et("lower",t,xt()),Z(n=>{const[r,[e,u]]=d(sn(t=>t>="a"&&t<="z")(n));return u.status===on?r:B(e,m(t,un.lower))})}function kn(t){return Z(n=>B(n,j(t)))}function En(t){return Z(n=>J(n,j(t)))}function On(t){return Z(n=>X(n,t))}const{Ok:An}=V,Ln=/^\p{Alphabetic}/u,Un=/^(?:\p{Alphabetic}|\p{N})/u,jn=/^(?:\p{Uppercase}|\p{Lt})/u,Mn=/^\p{Lowercase}/u,Fn=/^(?:\r\n|[\r\n\t ])/,Sn=/^(?:\r\n|\p{White_Space})/u,_n=/^[\r\n\t ]*/,Nn=/^\p{White_Space}*/u,Tn=/^[\r\n\t ]+/,zn=/^\p{White_Space}+/u,Cn=/^(?:\r\n|\r|\n)/,Pn=/^(?:\r\n|[\r\n\u0085\u2028\u2029])/u;function In(t){return Z(n=>{const{index:r,view:e}=n,u=s(r,e.byteLength-r,e).match(t);return u?X(n,u[0],r+i(u[0]).byteLength):B(n)})}function Rn(t,n){const r=null!=n;return function(t,n,r=at){"string"!=typeof n&&"[object RegExp]"!==Object.prototype.toString.call(n)&&wt(t,n,r)}("regex",t,((t=1,n=!1)=>dt("a string or a regular expression",t,n))(1,r)),r&&Et("regex",n,xt(2,!0)),r=>{let e="string"==typeof t?new RegExp(t):t;const{source:u,flags:o}=e;if("^"!==u[0]){e=new RegExp("^"+u,o)}const[s,[i,c]]=d(In(e)(r));return c.status===An?s:B(i,m(n,un.regex(e)))}}function Gn(t){return null!=t&&Et("uletter",t,xt()),Z(n=>{const[r,[e,u]]=d(In(Ln)(n));return u.status===An?r:B(e,m(t,un.uletter))})}function qn(t){return null!=t&&Et("ualpha",t,xt()),Z(n=>{const[r,[e,u]]=d(In(Un)(n));return u.status===An?r:B(e,m(t,un.ualpha))})}function Dn(t){return null!=t&&Et("uupper",t,xt()),Z(n=>{const[r,[e,u]]=d(In(jn)(n));return u.status===An?r:B(e,m(t,un.uupper))})}function Vn(t){return null!=t&&Et("ulower",t,xt()),Z(n=>{const[r,[e,u]]=d(In(Mn)(n));return u.status===An?r:B(e,m(t,un.ulower))})}function Wn(t){return null!=t&&Et("space",t,xt()),Z(n=>{const[r,[e,u]]=d(In(Fn)(n));return u.status===An?r:B(e,m(t,un.space))})}function Zn(t){return null!=t&&Et("uspace",t,xt()),Z(n=>{const[r,[e,u]]=d(In(Sn)(n));return u.status===An?r:B(e,m(t,un.uspace))})}function Xn(){return Z(t=>{const[n,r]=In(_n)(t);return X(n,null)})}function Bn(){return Z(t=>{const[n,r]=In(Nn)(t);return X(n,null)})}function Jn(t){return null!=t&&Et("spaces1",t,xt()),Z(n=>{const[r,e]=In(Tn)(n);return e.status===An?X(r,null):B(r,m(t,un.spaces1))})}function Hn(t){return null!=t&&Et("uspaces1",t,xt()),Z(n=>{const[r,e]=In(zn)(n);return e.status===An?X(r,null):B(r,m(t,un.uspaces1))})}function Kn(t){return null!=t&&Et("newline",t,xt()),Z(n=>{const[r,[e,u]]=d(In(Cn)(n));return u.status===An?r:B(e,m(t,un.newline))})}function Qn(t){return null!=t&&Et("unewline",t,xt()),Z(n=>{const[r,[e,u]]=d(In(Pn)(n));return u.status===An?r:B(e,m(t,un.unewline))})}const{Ok:Yn}=V;function tr(t,n){return r=>{if(t<1)return X(r,"");const{index:e,view:u}=r;if(e>=u.byteLength)return B(r);const{width:i,next:f}=function(t,n,r){const e=n.byteLength;let u=0;for(const s of o(r)){const r=t+u;if(r>=e)break;u+=a(r,n)}return t+u>=e&&(u=e-t),{width:u,next:s(t,u,n)}}(e,u,t);return c(f)===t&&n(f)?X(r,f,e+i):B(r)}}function nr(t,n){const r=null!=n;return Et("str",t,xt(1,r)),r&&Et("str",n,xt(2,!0)),Z(r=>{const[e,[u,o]]=d(tr(c(t),n=>t===n)(r));return o.status===Yn?e:B(u,m(n,un.str(t)))})}function rr(t,n){const r=null!=n;return Et("istr",t,xt(1,r)),r&&Et("istr",n,xt(2,!0)),Z(r=>{const[e,[u,o]]=d(tr(c(t),n=>t.toLowerCase()===n.toLowerCase())(r));return o.status===Yn?e:B(u,m(n,un.istr(t)))})}function er(){return Z(t=>{const{index:n,view:r}=t,e=r.byteLength-n;return X(t,s(n,e,r),n+e)})}function ur(t,n){const r=null!=n;return Lt("anystr",t,yt(1,r)),r&&Et("anystr",n,xt(2,!0)),Z(r=>{const[e,[u,o]]=d(tr(t,()=>!0)(r));return o.status===Yn?e:B(u,m(n,un.anystr(t)))})}const{Ok:or,Fail:sr,Fatal:ir}=V;function cr(...t){const n=t.slice(),r="string"==typeof t[t.length-1]?n.pop():null;return n.forEach((t,n)=>Ut("alt",t,gt(n+1,!0))),Z(t=>{const e=null!=r;let u=e?L(r):[];for(const r of n){const[n,[o,s]]=d(r(t));if(s.status===or)return n;if(e||(u=_(u,s.errors)),s.status===ir)return J(o,u)}return B(t,u)})}function ar(t,n){const r=null!=n;return Ut("opt",t,gt(1,r)),r&&Et("opt",n,xt(2,!0)),Z(r=>{const[e,[u,o]]=d(t(r));if(o.status===or)return e;const s=m(n,o.errors);if(o.status===ir)return J(u,s);const i=X(u,null);return i[1].errors=s,i})}function fr(t,n,r){return Ut("def",t,gt(1,!0)),null!=r&&Et("def",r,xt(3,!0)),Z(e=>{const[u,[o,s]]=d(t(e));return s.status===or?u:s.status===sr?X(o,n):J(o,m(r,s.errors))})}function lr(t,n){const r=null!=n;return Ut("peek",t,gt(1,r)),r&&Et("peek",n,xt(2,!0)),Z(r=>{const e=r.index,[u,o]=t(r);return o.status===or?X(u,o.value,e):o.status===sr?B(u,m(n,o.errors),e):B(u,$(n,u,o.errors),e)})}function dr(t,n){const r=null!=n;return Ut("empty",t,gt(1,r)),r&&Et("empty",n,xt(2,!0)),Z(r=>{const e=r.index,[u,o]=t(r);if(o.status===or&&u.index===e)return X(u,null);return w(o.status===ir)(u,m(n,o.errors))})}function pr(t,n){const r=null!=n;return Ut("not",t,gt(1,r)),r&&Et("not",n,xt(2,!0)),Z(r=>{const e=r.index,[u,o]=t(r);return o.status===or?B(u,m(n,void 0),e):X(u,null,e)})}const{Ok:hr,Fail:br,Fatal:yr}=V;function gr(t,n){const r=null!=n;return Ut("attempt",t,gt(1,r)),r&&Et("attempt",n,xt(2,!0)),Z(e=>{const u=e.index,[o,[s,i]]=d(t(e));if(i.status===hr)return o;if(i.status===yr||s.index!==u)return B(s,$(n,s,i.errors),u);if(r){if(1===i.errors.length&&i.errors[0].type===A.Nested){const{ctx:t,errors:r}=i.errors[0];return B(s,S(n,t,r),u)}return B(s,L(n),u)}return B(s,i.errors,u)})}function xr(...t){const n=t.slice(),r="string"==typeof n[n.length-1]?n.pop():null;return n.forEach((n,r)=>Ut("bseq",n,gt(r+1,t.length>1))),Z(t=>{const e=[],u=t.index;let o=t,s=[];for(const t of n){var i;const[n,c]=t(o);if(o=n,s=(null===(i=c.errors)||void 0===i?void 0:i.length)?_(s,c.errors):[],c.status===yr)return J(n,m(r,c.errors));if(c.status===br){return B(n,k(n.index!==u,r,n,s),u)}e.push(c.value)}return X(o,e)})}function vr(t,n,r){return Ut("bchain",t,gt(1,!0)),$t("bchain",n,ht(2,!0)),null!=r&&Et("bchain",r,xt(3,!0)),Z(e=>{const u=e.index,[o,s]=t(e);if(s.status!==hr){return w(s.status===yr)(o,m(r,s.errors))}const i=n(s.value);Ut("bchain",i,rt("second argument to return a parser"));const[c,[a,f]]=d(i(o));if(f.status===hr)return c;const l=_(s.errors,f.errors);if(f.status===yr)return J(a,m(r,l));return B(a,k(a.index!==u,r,a,l),u)})}function wr(t,n,r){return Ut("bapply",t,gt(1,!0)),Ut("bapply",n,gt(2,!0)),null!=r&&Et("bapply",r,xt(3,!0)),Z(e=>{const u=e.index,[o,s]=t(e);if(s.status!==hr){return w(s.status===yr)(o,m(r,s.errors))}const[i,c]=n(o),a=_(s.errors,c.errors);if(c.status===yr)return J(i,m(r,a));if(c.status===br){return B(i,k(i.index!==u,r,i,a),u)}const f=c.value;return $t("bapply",f,rt("second argument to return a function")),X(i,f(s.value))})}function mr(t,n,r){return Ut("bleft",t,gt(1,!0)),Ut("bleft",n,gt(2,!0)),null!=r&&Et("bleft",r,xt(3,!0)),Z(e=>{const u=e.index,[o,s]=t(e);if(s.status!==hr){return w(s.status===yr)(o,m(r,s.errors))}const[i,c]=n(o);if(c.status===hr)return X(i,s.value);const a=_(s.errors,c.errors);if(c.status===yr)return J(i,m(r,a));return B(i,k(i.index!==u,r,i,a),u)})}function $r(t,n,r){return Ut("bright",t,gt(1,!0)),Ut("bright",n,gt(2,!0)),null!=r&&Et("bright",r,xt(3,!0)),Z(e=>{const u=e.index,[o,s]=t(e);if(s.status!==hr){return w(s.status===yr)(o,m(r,s.errors))}const[i,[c,a]]=d(n(o));if(a.status===hr)return i;const f=_(s.errors,a.errors);if(a.status===yr)return J(c,m(r,f));return B(c,k(c.index!==u,r,c,f),u)})}function kr(t,n,r){return Ut("bcount",t,gt(1,!0)),Lt("bcount",n,yt(2,!0)),null!=r&&Et("bcount",r,xt(3,!0)),Z(e=>{const u=e.index,s=[];let i=e;for(const e of o(n)){const[n,e]=t(i);if(i=n,e.status===yr)return J(n,m(r,e.errors));if(e.status===br){return B(n,k(n.index!==u,r,n,e.errors),u)}s.push(e.value)}return X(i,s)})}function Er(t,n,r){return Ut("buntil",t,gt(1,!0)),Ut("buntil",n,gt(2,!0)),null!=r&&Et("buntil",r,xt(3,!0)),Z(e=>{const u=e.index,o=[];let s=e;for(;;){const[e,i]=n(s);if(s=e,i.status===yr)return J(e,m(r,i.errors));if(i.status===hr)break;const[c,a]=t(s);if(s=c,a.status===yr)return J(c,m(r,a.errors));if(a.status===br){return B(c,k(c.index!==u,r,c,_(a.errors,i.errors)),u)}o.push(a.value)}return X(s,o)})}function Or(t,n){const r=null!=n;return kt("bblock",t,bt(1,r)),r&&Et("bblock",n,xt(2,!0)),Z(r=>{const e=t(),u=r.index;let o,s=[],i=r,c=0;for(;;){var a;const{value:t,done:r}=e.next(o);if(r)return X(i,t);Ut("bblock",t,t=>`expected ${x(c+1)} yield to be to a parser; found ${v(t)}`);const[f,l]=t(i);if(i=f,s=(null===(a=l.errors)||void 0===a?void 0:a.length)?_(s,l.errors):[],l.status===yr)return J(f,m(n,s));if(l.status===br){return B(f,k(f.index!==u,n,f,s),u)}o=l.value,c++}})}function Ar(...t){const n=t.slice(),r="string"==typeof n[n.length-1]?n.pop():null,e=n.pop();return n.forEach((t,n)=>Ut("bpipe",t,gt(n+1,!0))),$t("bpipe",e,ht(n.length+1,!0)),Z(t=>{const u=t.index,o=[];let s=t,i=[];for(const t of n){var c;const[n,e]=t(s);if(s=n,i=(null===(c=e.errors)||void 0===c?void 0:c.length)?_(i,e.errors):[],e.status===yr)return J(n,m(r,i));if(e.status===br){return B(n,k(n.index!==u,r,n,i),u)}o.push(e.value)}return X(s,e(...o))})}function Lr(t,n,r,e){return Ut("bbetween",t,gt(1,!0)),Ut("bbetween",n,gt(2,!0)),Ut("bbetween",r,gt(3,!0)),null!=e&&Et("bbetween",e,xt(4,!0)),Z(u=>{var o;const s=u.index,[i,c]=t(u);if(c.status!==hr){return w(c.status===yr)(i,m(e,c.errors))}const[a,f]=r(i),l=(null===(o=f.errors)||void 0===o?void 0:o.length)?_(c.errors,f.errors):[];if(f.status===yr)return J(a,m(e,l));if(f.status===br){return B(a,k(a.index!==s,e,a,l),s)}const[d,p]=n(a);if(p.status===yr)return J(d,m(e,_(l,p.errors)));if(p.status===br){return B(d,k(d.index!==s,e,d,_(l,p.errors)),s)}return X(d,f.value)})}const{Ok:Ur,Fatal:jr}=V;function Mr(t,n){const r=null!=n;return Ut("join",t,gt(1,r)),r&&Et("join",n,xt(2,!0)),Z(r=>{const[e,u]=t(r);if(u.status!==Ur){return w(u.status===jr)(e,m(n,u.errors))}const o=u.value;return Ot("join",o,rt("argument to return an array")),X(e,o.join(""))})}function Fr(t,n){const r=null!=n;return Ut("flat",t,gt(1,r)),r&&Et("flat",n,xt(2,!0)),Z(r=>{const[e,u]=t(r);if(u.status!==Ur){return w(u.status===jr)(e,m(n,u.errors))}const o=u.value;return Ot("flat",o,rt("argument to return an array")),X(e,o.flat(1/0))})}function Sr(t,n){const r=null!=n;return Ut("clean",t,gt(1,r)),r&&Et("clean",n,xt(2,!0)),Z(r=>{const[e,u]=t(r);if(u.status!==Ur){return w(u.status===jr)(e,m(n,u.errors))}const o=u.value;return Ot("clean",o,rt("argument to return an array")),X(e,o.filter(t=>null!=t))})}function _r(t,n,r){return Ut("value",t,gt(1,!0)),null!=r&&Et("value",r,xt(3,!0)),Z(e=>{const[u,o]=t(e);if(o.status!==Ur){return w(o.status===jr)(u,m(r,o.errors))}return X(u,n)})}function Nr(t,n,r){return Ut("nth",t,gt(1,!0)),Lt("nth",n,yt(2,!0)),null!=r&&Et("nth",r,xt(3,!0)),Z(e=>{const[u,o]=t(e);if(o.status!==Ur){return w(o.status===jr)(u,m(r,o.errors))}const s=o.value;return Ot("nth",s,rt("first argument to return an array")),X(u,s[n])})}function Tr(t,n){const r=null!=n;return Ut("first",t,gt(1,r)),r&&Et("first",n,xt(2,!0)),Z(r=>{const[e,u]=t(r);if(u.status!==Ur){return w(u.status===jr)(e,m(n,u.errors))}const o=u.value;return Ot("first",o,rt("argument to return an array")),X(e,o[0])})}function zr(t,n){const r=null!=n;return Ut("second",t,gt(1,r)),r&&Et("second",n,xt(2,!0)),Z(r=>{const[e,u]=t(r);if(u.status!==Ur){return w(u.status===jr)(e,m(n,u.errors))}const o=u.value;return Ot("second",o,rt("argument to return an array")),X(e,o[1])})}function Cr(t,n){const r=null!=n;return Ut("third",t,gt(1,r)),r&&Et("third",n,xt(2,!0)),Z(r=>{const[e,u]=t(r);if(u.status!==Ur){return w(u.status===jr)(e,m(n,u.errors))}const o=u.value;return Ot("third",o,rt("argument to return an array")),X(e,o[2])})}function Pr(t,n){const r=null!=n;return Ut("fourth",t,gt(1,r)),r&&Et("fourth",n,xt(2,!0)),Z(r=>{const[e,u]=t(r);if(u.status!==Ur){return w(u.status===jr)(e,m(n,u.errors))}const o=u.value;return Ot("fourth",o,rt("argument to return an array")),X(e,o[3])})}function Ir(t,n){const r=null!=n;return Ut("fifth",t,gt(1,r)),r&&Et("fifth",n,xt(2,!0)),Z(r=>{const[e,u]=t(r);if(u.status!==Ur){return w(u.status===jr)(e,m(n,u.errors))}const o=u.value;return Ot("fifth",o,rt("argument to return an array")),X(e,o[4])})}function Rr(t,n,r){return Ut("map",t,gt(1,!0)),$t("map",n,ht(2,!0)),null!=r&&Et("map",r,xt(3,!0)),Z(e=>{const[u,o]=t(e);if(o.status!==Ur){return w(o.status===jr)(u,m(r,o.errors))}return X(u,n(o.value))})}function Gr(t,n,r){return Ut("apply",t,gt(1,!0)),Ut("apply",n,gt(2,!0)),null!=r&&Et("apply",r,xt(3,!0)),Z(e=>{const u=e.index,[o,s]=t(e);if(s.status!==Ur){return w(s.status===jr)(o,m(r,s.errors))}const[i,c]=n(o);if(c.status!==Ur){return w(c.status===jr||i.index!==u)(i,m(r,_(s.errors,c.errors)))}const a=c.value;return $t("apply",a,rt("second argument to return a function")),X(i,a(s.value))})}function qr(t,n,r){return Ut("chain",t,gt(1,!0)),$t("chain",n,ht(2,!0)),null!=r&&Et("chain",r,xt(3,!0)),Z(e=>{const u=e.index,[o,s]=t(e);if(s.status!==Ur){return w(s.status===jr)(o,m(r,s.errors))}const i=n(s.value);Ut("chain",i,rt("second argument to return a parser"));const[c,[a,f]]=d(i(o));if(f.status!==Ur){return w(f.status===jr||a.index!==u)(a,m(r,_(s.errors,f.errors)))}return c})}const{Ok:Dr,Fail:Vr,Fatal:Wr}=V;function Zr(t,n){return Ut("label",t,gt(1,!0)),Et("label",n,xt(2,!0)),Z(r=>{const[e,[u,o]]=d(t(r));return o.status!==Vr?e:B(u,L(n))})}function Xr(t,n){const r=null!=n;return $t("lazy",t,ht(1,r)),r&&Et("lazy",n,xt(2,!0)),Z(n=>{const r=t();return Ut("lazy",r,rt("function argument to return a parser")),r(n)})}function Br(t,n){const r=null!=n;return kt("block",t,bt(1,r)),r&&Et("block",n,xt(2,!0)),Z(e=>{const u=t(),o=e.index;let s,i=m(n,[]),c=e,a=0;for(;;){var f;const{value:t,done:n}=u.next(s);if(n)return X(c,t);Ut("block",t,t=>`expected ${x(a+1)} yield to be to a parser; found ${v(t)}`);const[e,l]=t(c);if(c=e,r||(i=(null===(f=l.errors)||void 0===f?void 0:f.length)?_(i,l.errors):[]),l.status!==Dr){return w(l.status===Wr||e.index!==o)(e,i)}s=l.value,a++}})}function Jr(t,n){const r=null!=n;return Ut("skip",t,gt(1,r)),r&&Et("skip",n,xt(2,!0)),Z(r=>{const[e,u]=t(r);if(u.status!==Dr){return w(u.status===Wr)(e,m(n,u.errors))}return X(e,null)})}const{Ok:Hr,Fail:Kr,Fatal:Qr}=V;function Yr(t){return`[${t}]: infinite loop detected; neither content nor separator parser consumed input`}function te(...t){const n=t.slice(),r="string"==typeof t[t.length-1]?n.pop():null;return n.forEach((t,n)=>Ut("seq",t,gt(n+1,!0))),Z(t=>{const e=[],u=t.index;let o=m(r,[]),s=t;for(const t of n){const[n,c]=t(s);var i;if(s=n,null==r)o=(null===(i=c.errors)||void 0===i?void 0:i.length)?_(o,c.errors):[];if(c.status!==Hr){return w(c.status===Qr||s.index!==u)(s,o)}e.push(c.value)}return X(s,e)})}function ne(t,n,r){return Ut("left",t,gt(1,!0)),Ut("left",n,gt(2,!0)),null!=r&&Et("left",r,xt(3,!0)),Z(e=>{const u=e.index,[o,s]=t(e);if(s.status!==V.Ok){return(s.status===Qr?J:B)(o,m(r,s.errors))}const[i,c]=n(o);if(c.status!==Hr){return w(c.status===Qr||i.index!==u)(i,m(r,_(s.errors,c.errors)))}return X(i,s.value)})}function re(t,n,r){return Ut("right",t,gt(1,!0)),Ut("right",n,gt(2,!0)),null!=r&&Et("right",r,xt(3,!0)),Z(e=>{const u=e.index,[o,s]=t(e);if(s.status!==V.Ok){return w(s.status===Qr)(o,m(r,s.errors))}const[i,[c,a]]=d(n(o));if(a.status!==Hr){return w(c.status===Qr||c.index!==u)(c,m(r,_(s.errors,a.errors)))}return i})}function ee(t,n){const r=null!=n;return Ut("many",t,gt(1,r)),r&&Et("many",n,xt(2,!0)),Z(r=>{const e=[];let u=r;for(;;){const[r,o]=t(u);if(u=r,o.status===Qr)return J(r,m(n,o.errors));if(o.status===Kr)break;if(e.push(o.value),u.index>=u.view.byteLength)break}return X(u,e)})}function ue(t,n){const r=null!=n;return Ut("many1",t,gt(1,r)),r&&Et("many1",n,xt(2,!0)),Z(r=>{const[e,u]=t(r);if(u.status!==Hr){return w(u.status===Qr)(e,m(n,u.errors))}let o=e;const s=[u.value];for(;;){const[r,e]=t(o);if(o=r,e.status===Qr)return J(r,m(n,e.errors));if(e.status===Kr)break;if(s.push(e.value),o.index>=o.view.byteLength)break}return X(o,s)})}function oe(t,n,r){return Ut("sepby",t,gt(1,!0)),Ut("sepby",n,gt(2,!0)),null!=r&&Et("sepby",r,xt(3,!0)),Z(e=>{let u=e.index;const[o,s]=t(e);if(s.status===Qr)return J(o,m(r,s.errors));if(s.status===Kr)return X(o,[]);const i=[s.value];let c=o;for(;;){u=c.index;const[e,o]=n(c);if(c=e,o.status===Qr)return J(e,m(r,o.errors));if(o.status===Kr)break;const[s,a]=t(c);if(c=s,a.status===Qr)return J(s,m(r,a.errors));if(a.status===Kr)break;if(c.index===u)throw new TypeError(Yr("sepby"));i.push(a.value)}return X(c,i,u)})}function se(t,n,r){return Ut("sepby1",t,gt(1,!0)),Ut("sepby1",n,gt(2,!0)),null!=r&&Et("sepby1",r,xt(3,!0)),Z(e=>{let u=e.index;const[o,s]=t(e);if(s.status!==Hr){return w(s.status===Qr)(o,m(r,s.errors))}const i=[s.value];let c=o;for(;;){u=c.index;const[e,o]=n(c);if(c=e,o.status===Qr)return J(e,m(r,o.errors));if(o.status===Kr)break;const[s,a]=t(c);if(c=s,a.status===Qr)return J(s,m(r,a.errors));if(a.status===Kr)break;if(c.index===u)throw new TypeError(Yr("sepby1"));i.push(a.value)}return X(c,i,u)})}function ie(t,n,r){return Ut("endby",t,gt(1,!0)),Ut("endby",n,gt(2,!0)),null!=r&&Et("endby",r,xt(3,!0)),Z(e=>{let u=e.index;const[o,s]=t(e);if(s.status===Qr)return J(o,m(r,s.errors));if(s.status===Kr)return X(o,[]);const i=[s.value];let c=o;for(;;){u=c.index;const[e,o]=n(c);if(c=e,o.status===Qr)return J(e,m(r,o.errors));if(o.status===Kr)break;const[s,a]=t(c);if(c=s,a.status===Qr)return J(s,m(r,a.errors));if(a.status===Kr)break;if(c.index===u)throw new TypeError(Yr("endby"));i.push(a.value)}return X(c,i)})}function ce(t,n,r){return Ut("endby1",t,gt(1,!0)),Ut("endby1",n,gt(2,!0)),null!=r&&Et("endby1",r,xt(3,!0)),Z(e=>{let u=e.index;const[o,s]=t(e);if(s.status!==Hr){return w(s.status===Qr)(o,m(r,s.errors))}const i=[s.value];let c=o;for(;;){u=c.index;const[e,o]=n(c);if(c=e,o.status===Qr)return J(e,m(r,o.errors));if(o.status===Kr)break;const[s,a]=t(c);if(c=s,a.status===Qr)return J(s,m(r,a.errors));if(a.status===Kr)break;if(c.index===u)throw new TypeError(Yr("endby1"));i.push(a.value)}return X(c,i)})}function ae(t,n,r){return Ut("count",t,gt(1,!0)),Lt("count",n,yt(2,!0)),null!=r&&Et("count",r,xt(3,!0)),Z(e=>{const u=e.index,s=[];let i=e;for(const e of o(n)){const[n,e]=t(i);if(i=n,e.status!==Hr){return w(e.status===Qr||n.index!==u)(n,m(r,e.errors))}s.push(e.value)}return X(i,s)})}function fe(t,n,r,e){return Ut("between",t,gt(1,!0)),Ut("between",n,gt(2,!0)),Ut("between",r,gt(3,!0)),null!=e&&Et("between",e,xt(4,!0)),Z(u=>{var o;const s=u.index,[i,c]=t(u);if(c.status!==Hr){return w(c.status===Qr)(i,m(e,c.errors))}const[a,f]=r(i),l=m(e,(null===(o=f.errors)||void 0===o?void 0:o.length)?_(c.errors,f.errors):[]);if(f.status!==Hr){return w(f.status===Qr||a.index!==s)(a,l)}const[d,p]=n(a);if(p.status!==Hr){return w(p.status===Qr||d.index!==s)(d,m(e,_(l,p.errors)))}return X(d,f.value)})}function le(t,n,r){return Ut("until",t,gt(1,!0)),Ut("until",n,gt(2,!0)),null!=r&&Et("until",r,xt(3,!0)),Z(e=>{const u=e.index,o=[];let s=e;for(;;){const[e,i]=n(s);if(s=e,i.status===Qr)return J(e,m(r,i.errors));if(i.status===Hr)break;const[c,a]=t(s);if(s=c,a.status===Qr)return J(c,m(r,a.errors));if(a.status===Kr){return w(c.index!==u)(c,m(r,_(a.errors,i.errors)))}o.push(a.value)}return X(s,o)})}function de(...t){const n=t.slice(),r="string"==typeof t[t.length-1]?n.pop():null,e=n.pop();return n.forEach((t,n)=>Ut("pipe",t,gt(n+1,!0))),$t("pipe",e,ht(n.length+1,!0)),Z(t=>{const u=t.index,o=[];let s=t,i=m(r,[]);for(const t of n){const[n,e]=t(s);var c;if(s=n,null==r)i=(null===(c=e.errors)||void 0===c?void 0:c.length)?_(i,e.errors):[];if(e.status!==Hr){return w(e.status===Qr||n.index!==u)(n,i)}o.push(e.value)}return X(s,e(...o))})}function pe(t){return n=>`expected ${t} op parser to return a function; found ${v(n)}`}function he(t,n,r,e){return Ut("lassoc",t,gt(1,!0)),Ut("lassoc",n,gt(2,!0)),null!=e&&Et("lassoc",e,xt(4,!0)),Z(u=>{const[s,i]=t(u);if(i.status===Qr)return J(s,m(e,i.errors));if(i.status===Kr)return X(s,r);const c=[i.value],a=[];let f=s,l=f.index,d=0;for(;;){const[r,u]=n(f);if(f=r,u.status===Qr)return J(r,m(e,u.errors));if(u.status===Kr)break;const[o,s]=t(f);if(f=o,s.status===Qr)return J(o,m(e,s.errors));if(s.status===Kr)break;$t("lassoc",u.value,pe(x(d+1))),a.push(u.value),c.push(s.value),l=f.index,d++}let p=c[0];for(const t of o(a.length))p=a[t](p,c[t+1]);return X(f,p,l)})}function be(t,n,r){return Ut("lassoc1",t,gt(1,!0)),Ut("lassoc1",n,gt(2,!0)),null!=r&&Et("lassoc1",r,xt(3,!0)),Z(e=>{const[u,s]=t(e);if(s.status!==Hr){return w(s.status===Qr)(u,m(r,s.errors))}const i=[s.value],c=[];let a=u,f=a.index,l=0;for(;;){const[e,u]=n(a);if(a=e,u.status===Qr)return J(e,m(r,u.errors));if(u.status===Kr)break;const[o,s]=t(a);if(a=o,s.status===Qr)return J(o,m(r,s.errors));if(s.status===Kr)break;$t("lassoc1",u.value,pe(x(l+1))),c.push(u.value),i.push(s.value),f=a.index,l++}let d=i[0];for(const t of o(c.length))d=c[t](d,i[t+1]);return X(a,d,f)})}function ye(t,n,r,e){return Ut("rassoc",t,gt(1,!0)),Ut("rassoc",n,gt(2,!0)),null!=e&&Et("rassoc",e,xt(4,!0)),Z(u=>{const[s,i]=t(u);if(i.status===Qr)return J(s,m(e,i.errors));if(i.status===Kr)return X(s,r);const c=[i.value],a=[];let f=s,l=f.index,d=0;for(;;){const[r,u]=n(f);if(f=r,u.status===Qr)return J(r,m(e,u.errors));if(u.status===Kr)break;const[o,s]=t(f);if(f=o,s.status===Qr)return J(o,m(e,s.errors));if(s.status===Kr)break;$t("rassoc",u.value,pe(x(d+1))),a.push(u.value),c.push(s.value),l=f.index,d++}let p=c[c.length-1];for(const t of o(a.length-1,-1))p=a[t](c[t],p);return X(f,p,l)})}function ge(t,n,r){return Ut("rassoc1",t,gt(1,!0)),Ut("rassoc1",n,gt(2,!0)),null!=r&&Et("rassoc1",r,xt(3,!0)),Z(e=>{const[u,s]=t(e);if(s.status!==Hr){return w(s.status===Qr)(u,m(r,s.errors))}const i=[s.value],c=[];let a=u,f=a.index,l=0;for(;;){const[e,u]=n(a);if(a=e,u.status===Qr)return J(e,m(r,u.errors));if(u.status===Kr)break;const[o,s]=t(a);if(a=o,s.status===Qr)return J(o,m(r,s.errors));if(s.status===Kr)break;$t("rassoc1",u.value,pe(x(l+1))),c.push(u.value),i.push(s.value),f=a.index,l++}let d=i[i.length-1];for(const t of o(c.length-1,-1))d=c[t](i[t],d);return X(a,d,f)})}}])}));